<html>
<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>MZDDE Function Reference</title>
</head>
<body>
<P>
<A name = "MZDDE"><H2>MZDDE</H2></A>
<PRE>
  ZEMAX DDE Server Toolbox
 
  ZEMAX DDE Server Toolbox Version 2
  Provides access to ZEMAX functionality from <A href = "http://www.mathworks.com">Matlab</A>.
  NOTE : The ZEMAX DDE server maintains an independent copy of the lens from the Lens Data Editor (LDE).
         See <a href = "#zPushLens">zPushLens</a> and <a href = "#zGetRefresh">zGetRefresh</a> for moving lens data between the DDE server and the LDE.
  For further details, see the chapter on "ZEMAX Extensions" in the ZEMAX manual.
 
  Before calling any functions that access the ZEMAX DDE server, it is necessary to initialise the DDE link
  using the <a href = "#zDDEInit">zDDEInit</a> function. Failure to do so will cause <A href = "http://www.mathworks.com">Matlab</A> to issue a verbose yet completely
  uninformative error message.
 
 
    This toolbox is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.
 
    This toolbox is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License (in the file <A href = "../COPYING.html">COPYING</A>) for more details.
 
  Report bugs and updates to <A href = "mailto:dgriffith@csir.co.za">Derek Griffith</A>
 
  List of Functions - Function names are case insensitive.
    <a href = "#ACCOSin">ACCOSin</a>                 - ACCOS LENO format importer for ZEMAX.
    <a href = "#BIMwrite">BIMwrite</a>                - Write ZEMAX format binary greyscale image.
    <a href = "#Census">Census</a>                  - Provides a listing of all functions in this toolbox, along with current revisions.
    <a href = "#deg2rad">deg2rad</a>                 - Converts degrees to radians.
    <a href = "#digitize">digitize</a>                - A script to <a href = "#digitize">digitize</a> data from an image of a graph. Author J. Cogdell. Not MZDDE. 
    <a href = "#LSF">LSF</a>                     - Diffraction-limited Monochromatic Line Spread Function.
    PLSF                    - Diffraction-limited Polychromatic Line Spread Function.
    <a href = "#MTF">MTF</a>                     - Diffraction-limited Monochromatic Modulation Transfer Function.
    <a href = "#PMTF">PMTF</a>                    - Diffraction-limited Polychromatic Modulation Transfer Function.
    <a href = "#Planck">Planck</a>                  - <a href = "#Planck">Planck</a> black body function.
    <a href = "#PlotZemaxOTF">PlotZemaxOTF</a>            - Plot a thru-frequency MTF/OTF as returned by <a href = "#ReadZemaxOTF">ReadZemaxOTF</a> or <a href = "#zGetMTF">zGetMTF</a>.
    <a href = "#PSF">PSF</a>                     - Diffraction-limited Monochromatic Point Spread Function.
    <a href = "#PPSF">PPSF</a>                    - Diffraction-limited Polychromatic Point Spread Function.
    <a href = "#PSF2D">PSF2D</a>                   - 2D Image of the Diffraction-limited Polychromatic Point Spread Function.
    <a href = "#rad2deg">rad2deg</a>                 - Converts radians to degrees.
    <a href = "#RayDevParPlate">RayDevParPlate</a>          - Computes lateral deviation of a ray passing through a plane parallel plate.
    <a href = "#ReadCIE">ReadCIE</a>                 - Read CIE data into workspace variables (colour observers, daylight etc.)
    <a href = "#ReadZemaxGImAnal">ReadZemaxGImAnal</a>        - Reads data from a ZEMAX Geometric Image Analysis text data file.
    <a href = "#ReadZemaxIllum">ReadZemaxIllum</a>          - Reads data from a ZEMAX Uniformity of Illumination Analysis test file.
    <a href = "#ReadZemaxOTF">ReadZemaxOTF</a>            - Reads data from a OTF/MTF text file from ZEMAX (thru-frequency, thru-focus or thru-field).
    <a href = "#ReadZemaxRMS">ReadZemaxRMS</a>            - Reads data from a ZEMAX RMS Analysis - Spot Size, Wavefront or Strehl Ratio.
    <a href = "#ReadZemaxVignet">ReadZemaxVignet</a>         - Reads data from a ZEMAX Vignetting Analysis text file.
    <a href = "#ReadZemaxWaveMap">ReadZemaxWaveMap</a>        - Reads data from a Wave Map text data file generated by ZEMAX.
    <a href = "#SpiralSpot">SpiralSpot</a>              - Compute image plane trajectory of a ray scanned in a spiral over the pupil.
    <a href = "#NarcWiz">NarcWiz</a>                 - A wizard for performing narcissus analysis on staring infrared cameras.
    <a href = "#n_air">n_air</a>                   - Refractive index of air over wavelength, temperature and pressure.
    <a href = "#DoublePass">DoublePass</a>              - Put a lens system into double pass.
    <a href = "#genRayDataMode0">genRayDataMode0</a>         - Generate grid of ray data ready for <a href = "#zArrayTrace">zArrayTrace</a> mode 0.
    <a href = "#gridXYRayData">gridXYRayData</a>           - Generate basic grid of ray data for <a href = "#zArrayTrace">zArrayTrace</a>.
    <a href = "#IntSphere">IntSphere</a>               - Compute the spectral radiance of an integrating sphere given input spectral flux.
    <a href = "#Onion">Onion</a>                   - Split lens into layers for analysis of axial temperature gradients.
    <a href = "#SagEvenAsphere">SagEvenAsphere</a>          - Computes the sag of a standard ZEMAX even aspheric surface.
    <a href = "#WriteZemaxWaveFile">WriteZemaxWaveFile</a>      - Write a list of wavelengths and weights in ZEMAX .wav file format.
    <a href = "#zArrayTrace">zArrayTrace</a>             - Performs tracing of large numbers of rays in ZEMAX.
    <a href = "#zDDEBusy">zDDEBusy</a>                - Checks to see if the ZEMAX DDE server is busy.
    <a href = "#zDDEClose">zDDEClose</a>               - Close DDE communications channel to ZEMAX.
    <a href = "#zDDEInit">zDDEInit</a>                - Open communications channel to ZEMAX DDE server.
    <a href = "#zDDEStart">zDDEStart</a>               - Attempt <a href = "#zDDEInit">zDDEInit</a>. If no ZEMAX running, attempt to start ZEMAX.
    <a href = "#zDeleteSurface">zDeleteSurface</a>          - Delete a lens surface.
    <a href = "#zExportCAD">zExportCAD</a>              - Export lens CAD data (IGES, STEP, SAT) to a file.  
    <a href = "#zExportCheck">zExportCheck</a>            - Check if lens CAD export has completed.
    <a href = "#zFindLabel">zFindLabel</a>              - Find integer label attached to a lens surface using <a href = "#zSetLabel">zSetLabel</a>.
    <a href = "#zFixSurfaceData">zFixSurfaceData</a>         - Set lens surface data to 'fixed' mode.
    <a href = "#zFixAllSurfaceData">zFixAllSurfaceData</a>      - Set all lens surface data to 'fixed' mode.
    <a href = "#zGetAddress">zGetAddress</a>             - Get address line in Preferences/Address.
    <a href = "#zGetAspect">zGetAspect</a>              - Get the aspect ratio of ZEMAX graphics or print windows.
    <a href = "#zGetBuffer">zGetBuffer</a>              - Get DDE client specific data from a ZEMAX window being updated.
    <a href = "#zGetCoatings">zGetCoatings</a>            - Get a list of available coatings from the ZEMAX COATINGS.DAT file.
    <a href = "#zGetConfig">zGetConfig</a>              - Get current lens configuration, number of configurations and configuration operands.
    <a href = "#zGetDate">zGetDate</a>                - Get current date from ZEMAX DDE server.
    <a href = "#zGetExtra">zGetExtra</a>               - Get single extra data value from ZEMAX DDE server.
    <a href = "#zGetField">zGetField</a>               - Get data on lens field points.
    <a href = "#zGetFile">zGetFile</a>                - Get the filename of the currently loaded lens.
    <a href = "#zGetFirst">zGetFirst</a>               - Get first order data about the lens.
    <a href = "#zGetGlass">zGetGlass</a>               - Get data on a glass at a particular lens surface.
    <a href = "#zGetGlassCats">zGetGlassCats</a>           - Get a list of available text glass catalogues from the ZEMAX Glasscat directory.
    <a href = "#zGetGlobalMatrix">zGetGlobalMatrix</a>        - Get transformation matrix from local surface coordinates to global lens coordinates.
    <a href = "#zGetIndex">zGetIndex</a>               - Get index of refraction data at a lens surface.
    <a href = "#zGetLabel">zGetLabel</a>               - Retrieve integer label associated with a surface.
    <a href = "#zGetMetaFile">zGetMetaFile</a>            - Create Windows Metafile of a ZEMAX graphic analysis window.
    <a href = "#zuiGetMetaFile">zuiGetMetaFile</a>          - As for <a href = "#zGetMetaFile">zGetMetaFile</a>, but with Save As dialog box.
    <a href = "#zGetMulticon">zGetMulticon</a>            - Get data from the ZEMAX multi-configuration editor.
    <a href = "#zGetMTF">zGetMTF</a>                 - Get <a href = "#MTF">MTF</a> computation from ZEMAX for current lens. Returns as for <a href = "#ReadZemaxOTF">ReadZemaxOTF</a> function.
    <a href = "#zGetName">zGetName</a>                - Get the name of the lens in ZEMAX.
    <a href = "#zGetNSCData">zGetNSCData</a>             - Get number of NSC objects.
    <a href = "#zGetNSCObjectData">zGetNSCObjectData</a>       - Get data describing NSC objects in ZEMAX.
    <a href = "#zGetNSCPosition">zGetNSCPosition</a>         - Get position data for an NSC object in ZEMAX.
    <a href = "#zGetNSCParameter">zGetNSCParameter</a>        - Get numeric parameters associated with an NSC object in ZEMAX.
    <a href = "#zGetNSCSettings">zGetNSCSettings</a>         - Get ZEMAX settings affecting raytracing in non-sequential components.
    <a href = "#zGetOperand">zGetOperand</a>             - Get data from the ZEMAX Merit Function editor.
    <a href = "#zGetOperandMatrix">zGetOperandMatrix</a>       - Get the entire merit function matrix from the Merit Function Editor.
    <a href = "#zGetPath">zGetPath</a>                - Get the path for the ZEMAX installation directory and lens directory.
    <a href = "#zGetPolState">zGetPolState</a>            - Get the default polarization state from ZEMAX.
    <a href = "#zGetPupil">zGetPupil</a>               - Get data on the aperture stop and pupils.
    <a href = "#zGetPolTrace">zGetPolTrace</a>            - Perform a full polarization raytrace through the ZEMAX lens.
    <a href = "#zGetPolTraceDirect">zGetPolTraceDirect</a>      - Direct access full polarization raytrace.
    <a href = "#zGetRefresh">zGetRefresh</a>             - Copies the lens in the Lens Data Editor (LDE) into the ZEMAX DDE server.
    <a href = "#zGetSag">zGetSag</a>                 - Get the sag at particular x and y coordinates on a lens surface.
    <a href = "#zGetSequence">zGetSequence</a>            - Get the sequence numbers of the lenses in the DDE server and LDE.
    <a href = "#zGetSerial">zGetSerial</a>              - Get the ZEMAX hardware lock serial number.
    <a href = "#zGetSolve">zGetSolve</a>               - Get data on solves and pickups on lens surfaces.
    <a href = "#zGetSurfaceData">zGetSurfaceData</a>         - Get a data item describing a lens surface.
    <a href = "#zsGetSurfaceData">zsGetSurfaceData</a>        - Get data for a lens surface in a <A href = "http://www.mathworks.com">Matlab</A> structure.
    <a href = "#zsGetSurfaceDataVector">zsGetSurfaceDataVector</a>  - Get all basic surface data in a vector of <A href = "http://www.mathworks.com">Matlab</A> structures.
    <a href = "#zGetSurfaceDLL">zGetSurfaceDLL</a>          - Get the name of a DLL for user-defined surface types.
    <a href = "#zGetSurfaceParameter">zGetSurfaceParameter</a>    - Get single surface parameter datum.
    <a href = "#zGetSurfaceParamVector">zGetSurfaceParamVector</a>  - Get vector of all parameter values at a surface.
    <a href = "#zGetSystem">zGetSystem</a>              - Get general information on the lens system in the ZEMAX DDE server.
    <a href = "#zsGetSystem">zsGetSystem</a>             - Get general lens information in a <A href = "http://www.mathworks.com">Matlab</A> structure.
    <a href = "#zGetSystemAper">zGetSystemAper</a>          - Get lens system aperture data.
    <a href = "#zGetTextFile">zGetTextFile</a>            - Save text from any ZEMAX analysis window which supports text.
    <a href = "#zGetTimeout">zGetTimeout</a>             - Get the timeout value in seconds for ZEMAX DDE calls.
    <a href = "#zGetTol">zGetTol</a>                 - Get data on a tolerance operand in the ZEMAX tolerance editor.
    <a href = "#zGetTolCount">zGetTolCount</a>            - Get the number of current lens tolerance operands from ZEMAX.
    <a href = "#zGetTolMatrix">zGetTolMatrix</a>           - Get a matrix of all current lens tolerances.
    <a href = "#zGetTrace">zGetTrace</a>               - Trace a ray through the current lens in the ZEMAX DDE server.
    <a href = "#zGetTraceDirect">zGetTraceDirect</a>         - Direct access raytrace through the current lens in the ZEMAX DDE server.
    <a href = "#zGetUpdate">zGetUpdate</a>              - Perform update on the current lens in the ZEMAX DDE server.
    <a href = "#zGetVersion">zGetVersion</a>             - Get the ZEMAX version which is running.
    <a href = "#zGetWave">zGetWave</a>                - Get data on a currently defined wavelength in ZEMAX.
    <a href = "#zGetWaveMatrix">zGetWaveMatrix</a>          - Get all data on wavelengths in a matrix.
    <a href = "#zImportExtraData">zImportExtraData</a>        - Import extra data to a ZEMAX surface which needs it e.g. Grid Sag.
    <a href = "#zuiImportExtraData">zuiImportExtraData</a>      - As for <a href = "#zImportExtraData">zImportExtraData</a>, but with File Open dialog box.
    <a href = "#zInsertSurface">zInsertSurface</a>          - Insert a new surface in the lens.
    <a href = "#zLoadFile">zLoadFile</a>               - Load a ZEMAX lens surface into the DDE server.
    <a href = "#zuiLoadFile">zuiLoadFile</a>             - As for <a href = "#zLoadFile">zLoadFile</a>, except with File Open dialog.
    <a href = "#zLoadMerit">zLoadMerit</a>              - Load a merit function file from a .MF or .ZMX file.
    <a href = "#zuiLoadMerit">zuiLoadMerit</a>            - As for zLOadMerit, except that an Open File dialog is presented.
    <a href = "#zMakeGraphicWindow">zMakeGraphicWindow</a>      - Request ZEMAX to generate a graphic display from data stored in client generated file.
    <a href = "#zMakeTextWindow">zMakeTextWindow</a>         - Request ZEMAX to display text stored in a client generated file.
    <a href = "#zNewLens">zNewLens</a>                - Erase the lens in the ZEMAX DDE server.
    <a href = "#zNumSurfs">zNumSurfs</a>               - Returns the number of surfaces in the lens.
    <a href = "#zOpenWindow">zOpenWindow</a>             - Open a ZEMAX action/analysis window.
    <a href = "#zOptimize">zOptimize</a>               - Run the damped least squares on the lens in the ZEMAX DDE server.
    <a href = "#zPushLens">zPushLens</a>               - Copy the lens in the ZEMAX DDE server into the ZEMAX Lens Data Editor.
    <a href = "#zReleaseWindow">zReleaseWindow</a>          - Release a window locked during ZEMAX-client interaction.
    <a href = "#zSaveFile">zSaveFile</a>               - Save a lens file from the ZEMAX DDE server.
    <a href = "#zuiSaveFile">zuiSaveFile</a>             - As for zSaveLens, only a Save As dialog is used.
    <a href = "#zSetAperture">zSetAperture</a>            - Set aperture details on a lens surface.
    <a href = "#zSetBuffer">zSetBuffer</a>              - Write text to a buffer for ZEMAX-client interactions.
    <a href = "#zSetConfig">zSetConfig</a>              - Change selected lens configuration.
    <a href = "#zSetExtra">zSetExtra</a>               - Set extra data associated with a lens surface in the ZEMAX DDE server.
    <a href = "#zSetField">zSetField</a>               - Set details of a field point in the lens.
    <a href = "#zSetFieldType">zSetFieldType</a>           - Set the type of field points and the total number of points.
    <a href = "#zSetFieldMatrix">zSetFieldMatrix</a>         - Set field type and all field point data from a <A href = "http://www.mathworks.com">Matlab</A> matrix.
    <a href = "#zSetFloat">zSetFloat</a>               - Set all surface without apertures to have floating apertures.
    <a href = "#zSetLabel">zSetLabel</a>               - Attach an integer label to a lens surface for later reference.
    <a href = "#zSetMEMState">zSetMEMState</a>            - Set the micro-mirror state of a MEMS digital mirror device (DMD/DLP)
    <a href = "#zSetMulticon">zSetMulticon</a>            - Set multi-configuration data for lens surfaces in ZEMAX.
    <a href = "#zSetMulticonOp">zSetMulticonOp</a>          - Set up operand types in the ZEMAX multi-configuration editor.
    <a href = "#zSetNSCNull">zSetNSCNull</a>             - Sets range of objects at a non-sequential surface to the 'Null Object'.
    <a href = "#zSetNSCObjectData">zSetNSCObjectData</a>       - Set basic data for an non-sequential object in ZEMAX.
    <a href = "#zsSetNSCObject">zsSetNSCObject</a>          - Set data for an NSC object or objects through use of a <A href = "http://www.mathworks.com">Matlab</A> structure array.
    <a href = "#zSetNSCPosition">zSetNSCPosition</a>         - Set position and tilt of a non-sequential object in ZEMAX.
    <a href = "#zSetNSCParameter">zSetNSCParameter</a>        - Set a parameter associated with an NSC object in ZEMAX.
    <a href = "#zSetNSCSettings">zSetNSCSettings</a>         - Set global settings in ZEMAX related to handling of NSC ray tracing.
    <a href = "#zSetOperand">zSetOperand</a>             - Set lens optimization operand in ZEMAX.
    <a href = "#zSetPolState">zSetPolState</a>            - Set default polarization state for polarization raytracing in ZEMAX.
    <a href = "#zSetSolve">zSetSolve</a>               - Set solves and pickups on lens surfaces.
    <a href = "#zSetSurfaceData">zSetSurfaceData</a>         - Set basic lens surface data in ZEMAX.
    <a href = "#zSetSurfaceParameter">zSetSurfaceParameter</a>    - Set a parameter associated with a lens surface in ZEMAX.
    <a href = "#zSetSurfaceParamVector">zSetSurfaceParamVector</a>  - Set all parameters associated with a lens surface from a vector.
    <a href = "#zSetSurfaceParamMatrix">zSetSurfaceParamMatrix</a>  - Set all parameters associated with all lens surfaces from a matrix.
    <a href = "#zSetSystem">zSetSystem</a>              - Set global operating conditions for a lens system in ZEMAX.
    <a href = "#zSetSystemAper">zSetSystemAper</a>          - Set aperture type and size for a lens in ZEMAX.
    <a href = "#zSetTimeout">zSetTimeout</a>             - Set the timeout for all ZEMAX DDE function calls.
    <a href = "#zSetVig">zSetVig</a>                 - Set vignetting factors automatically in ZEMAX.
    <a href = "#zSetWave">zSetWave</a>                - Set a wavelength and weight for the lens in ZEMAX.
    <a href = "#zSetWaveMatrix">zSetWaveMatrix</a>          - Set all wavelengths and weights from a <A href = "http://www.mathworks.com">Matlab</A> matrix.
    <a href = "#zWindowMaximize">zWindowMaximize</a>         - Maximize a ZEMAX window.
    <a href = "#zWindowMinimize">zWindowMinimize</a>         - Minimize a ZEMAX window.
    <a href = "#zWindowRestore">zWindowRestore</a>          - Restore a ZEMAX window to before a Maximize or Minimize.
    <a href = "#ZemaxButtons">ZemaxButtons</a>            - Get a list of 3-letter codes for ZEMAX analysis and action windows (see <a href = "#zOpenWindow">zOpenWindow</a>).
    <a href = "#ZemaxOperands">ZemaxOperands</a>           - Get a list of ZEMAX optimization operands.
    <a href = "#ZemaxSurfTypes">ZemaxSurfTypes</a>          - Get a list of ZEMAX surface type codes and descriptions.
 
</PRE>
</P>
<P>
<A name = "ACCOSin"><H2>ACCOSin</H2></A>
<PRE>
  <a href = "#ACCOSin">ACCOSin</a> - Read an ACCOS .len file into ZEMAX.
 
  Usage : Status = <a href = "#ACCOSin">ACCOSin</a>
 
  The following return values are possible
 
   0 : Success
  -1 : User Canceled operation or file not found
 
  If there are multiple .len files seperated with 'LIB PUT' commands as for a library dump, then
  each lens is saved as a .zmx file, and given the name in the lens idendification line of the input.
  In this case, <a href = "#ACCOSin">ACCOSin</a> will ask for the directory in which to store the library dump.
</PRE>
</P>
<P>
<A name = "BIMwrite"><H2>BIMwrite</H2></A>
<PRE>
  <a href = "#BIMwrite">BIMwrite</a> - write ZEMAX format BIM file from a double image array.
 
  Usage : BIMWrite(Image, BIMfilename);
 
  Writes ZEMAX style BIM image to the given file. The .bim file extension will be appended.
  See Geometric Image Analysis in the Analysis Menu chapter of the ZEMAX Manual.
  Currently ZEMAX only supports BIM files generated from square image arrays.
</PRE>
</P>
<P>
<A name = "Census"><H2>Census</H2></A>
<PRE>
  <a href = "#Census">Census</a> Script
  This script and report tabulates the status of all the m-files in the MZDDE directory.
  Usage : census
  
  See Also : <a href = "#docgen">docgen</a>
</PRE>
</P>
<P>
<A name = "DoublePass"><H2>DoublePass</H2></A>
<PRE>
  <a href = "#DoublePass">DoublePass</a> - Put a lens into double pass.
 
  Usage : Status = DoublePass(j, k)
 
  Takes a series of surfaces (j thru k) and puts them into double pass,
  mainly with the help of pickups.
  Surface k will typically be a mirror surface. If not, the ray path is
  merely reversed. Note the following ...
  1) Inserts surfaces k+1 to 2k-j. This is a total of k-j surfaces.
  2) Inserts pickups of thickness, radius, conic constant, glass, semi-diameter
     and all lens data parameters. Coatings are copied to the new surfaces.
  3) Radii, conic constant and parameter pickups are inserted without a sign
     change.
  4) Thickness pickups are inserted with sign change.
  5) Coordinate break surfaces are forced to a reverse order with a pickup 
     having a scale factor of -1 and an offset of 1 for the mode flag. This 
     only works properly if you use a mode of 0 or 1 to indicate the order.
  6) Folds or other z reversals may not be handled correctly in all cases,
     but seem to work in simple cases.
  7) Many cases seem to be handled correctly, but check your model
     carefully. A sensitive test is to put the
     system into double pass without a mirror. Any ray should be exactly
     reversed through the system.
  8) User-defined apertures are not dealt with. Other apertures are kind of
     fudged by copying some stuff and picking up other stuff.
  9) Non-sequentials ? You are right out of luck. Why would you want that ?
  10) This function should leave all existing surfaces untouched except surface k.
      Otherwise only newly inserted surfaces are
      meddled with. Suggest you save the lens before doing this.
  11) If there are multi-configuration parameters applicable to the image
      surface, and k is the image surface
      you will probably not get what you want. Other multi-configuration
      systems should come through ok.
  12) The image surface can be a mirror surface, and this is useful when
      going into double pass, if only to
      put the mirror in automatically where the path reverses.
 
  The following surfaces types are explicitly handled or often work
  correctly. Others may also work.
  STANDARD, EVENASPH, ODDASPHE, COORDBRK, PARAXIAL, PARAX_XY, TILTSURF,
  TOROIDAL
  Surfaces requiring extra data will not work.
  
  The returned Status is an integer which has the following meaning
 
  0 - Everything seems to have gone OK.
  1 - Final surface (k) exceeds the number of surfaces - k assumed to be the image surface.
  2 - First surface (j) coincident or beyond last surface (k) - you have been ignored.
  3 - A surface type which is not explicitly supported was encountered - check your results.
 
</PRE>
</P>
<P>
<A name = "IntSphere"><H2>IntSphere</H2></A>
<PRE>
  Compute the spectral radiance of an integrating sphere.
  
  Usage : SpectralRadiance = IntSphere(SpectralFlux, SphereDia, PortAreas, InitialReflectance, PortReflectance, SphereReflectance, Wavelengths, Interp)
 
  SpectralRadiance is the spectral radiance of the sphere in units of watts per steradian per square centimetre per micron of wavelength.
  SpectralFlux is the radiant spectral flux injected into the sphere in units of Watts per micron of wavelength.
  SphereDia is the diameter of the sphere in cm.
  PortAreas is a row vector of the areas of the input and output ports in square cm.
  InitialReflectance is the spectral reflectance of the surface which diffuses the flux into the sphere (possibly the inner sphere surface itself).
  PortReflectance is an array (one column per port) of port reflectances for all input and output ports in the same order as
  in the PortAreas vector.
  SphereReflectance is the spectral reflectance of the general interior of the sphere. If SphereReflectance has a single row,
  then the relectance is assumed to have this value across the entire spectral band.
  Wavelength is a column vector of wavelengths at which to compute SpectralRadiance given in microns.
  Interp is the method to use for interpolation of values. The options are 
  'nearest' - Nearest neighbor interpolation
  'linear' - Linear interpolation (default)
  'spline' - Cubic spline interpolation
  'pchip' - Piecewise cubic Hermite interpolation
  'cubic' - (Same as 'pchip')
  'v5cubic' - Cubic interpolation used in MATLAB 5
  See interp1.
 
  Except for PortAreas, all input parameters must be supplied with associated wavelength data in microns in the first column.
  All wavelength data must be monotonically increasing.
  
  The output data will be computed at the wavelengths given in the Wavelengths vector, which must be a column vector.
  The wavelength data for all input parameters must span the range of the output Wavelengths, otherwise an error is
  generated.
 
  Reference : Integrating Sphere Radiometry and Photometry, Labsphere Corporation, http://www.labsphere.com
</PRE>
</P>
<P>
<A name = "LSF"><H2>LSF</H2></A>
<PRE>
  LSF(Wavelengths, Focal_Ratio, X-Coordinates)
 
  Computes the monochromatic diffraction-limited line spread function at
  the given wavelengths (rows) at the coordinates given by x.
  x must be monotonic upward and equi-spaced.
 
  The <a href = "#LSF">LSF</a> is computed using a fast fourier transform technique on the <a href = "#MTF">MTF</a>
  computed from a closed-form expression. 
</PRE>
</P>
<P>
<A name = "MTF"><H2>MTF</H2></A>
<PRE>
  MTF(Wavelengths, Focal_Ratio, Frequencies)
 
  Returns the diffraction limited monochromatic <a href = "#MTF">MTF</a> for each of the wavelengths given (rows)
  and for each of the frequencies given (columns).
  
  If the frequencies are given in cycles per millimetre, the wavelengths should also be in mm.
 
</PRE>
</P>
<P>
<A name = "NarcWiz"><H2>NarcWiz</H2></A>
<PRE>
  <a href = "#NarcWiz">NarcWiz</a> - Narcissus analysis wizard
 
  Usage : NarcOut = <a href = "#NarcWiz">NarcWiz</a>      % NarcOut is case sensitive
          report narcissus
 
  Takes the user through a narcissus analysis of the lens in the ZEMAX DDE server. NarcOut is a
  structure containing various items required for the report generator, so the function must be
  called exactly as shown above. The report will be generated in rich text format (.rtf) and
  displayed in MS Word.
 
  The general restrictions and assumptions are as follows :
  1) The lens model to be analysed is for a 3rd generation thermal imager using a cooled detector
     which has a cold stop. The cold stop is assumed to be at the surface before the image surface
     and the detector window is assumed to come before the cold stop. Clear apertures of these
     objects must be set correctly.
  2) The inside of the dewar has emissivity of 1 all over and across the spectral band.
  3) The side of the cold stop facing outward has a user-defined emissivity and the same temperature
     as the inside of the dewar right out to the clear aperture of the dewar window.
  4) Emissions and reflections of thermal radiation by non-optical surfaces are lambertian.
  5) Lens must be single configuration. Save and analyse each configuration seperately, taking
     special care to ensure that the apertures are as they would be for the system as-built. It is
     particularly important that the clear aperture of the dewar window is correctly set from
     mechanical drawings of the dewar.
  6) Only rotationally symmetrical lenses are currently handled - mainly a
     retriction of the ZEMAX functions used for the computation. The whole
     approach to the problem would have to change significantly to cater
     for non-symmetrical systems.
 
  The general functions performed are as follows :
  1) Create a directory named after the lens to be analysed in which all results will be saved. The
     directory name will have the .Narcissus extension.
  2) Ensure that the system is correctly set up, has clear apertures and coatings defined. Currently this is
     done by appealing to the users's sense of thoroughness.
  3) Compute system transmission, YNI contributions and uniformity of image illumination.
  4) Reverse the lens and create single bounce ghost reflection models for each optical surface.
  5) Compute the Narcissus-Induced Delta T contributions for each surface.
  6) Plot total NITD, NITD per surface and overall image irradiance uniformity per configuration.
  7) Generate subjective images of image non-uniformity.
  8) Rank surfaces in order of contribution to NITD and tabulate with YNI contributions.
  9) Compute maximum slope of total NITD and overall image non-uniformity. This gives an indication
     of the local visibility of the image non-uniformities.
  10) If the user gives the command 'report narcissus', a report will be generated in MS Word,
      containing all of the outputs.
 
  Possible return values for <a href = "#NarcWiz">NarcWiz</a> are
   0 - Everything seems to be OK
  -1 - ZEMAX not running and could not start ZEMAX.
  -2 - The lens you wanted to analyse cannot be raytraced.
  -3 - Lens has fewer than 6 surfaces. Detector + cold stop + window + 2 additional lens surfaces is
       six at least.
  -4 - Lens does not operate primarily in a thermal band.
  -5 - Lens is multi-config. Currently we only do single config. Save and analyse each config
       seperately.
  -6 - User cancelled wizard.
  -7 - Double bounce ghost lenses were encountered - restart analysis.
  -8 - Lens has wrong field type. Change to "real image height".
</PRE>
</P>
<P>
<A name = "Onion"><H2>Onion</H2></A>
<PRE>
  <a href = "#Onion">Onion</a> - Splits a lens into a number of layers for the purpose of analysing the effect of an axial
  temperature gradient.
 
  Usage : Status = Onion(Surface, Layers, T1, T2)
 
  Where Surface is the surface to split up, Layers is the number of layers to use, T1 is the temperature at
  the given surface and T2 is the temperature at the following surface. Currently, only standard surfaces are
  handled correctly. There must be sufficient MOFF operands in the multi-configuration editor to accommodate
  the new TEMP and GLSS operands i.e. there must be at least (Layers + 1) * 2 operands of type MOFF. These 
  MOFF operands must appear at the start of the list. The reason for this is that there is currently no way 
  to insert multicon operands from the DDE interface.
 
  Note : To correcly evaluate the thermal effect, the "Use Temperature and Pressure" box on the general
  settings dialog must be checked.
 
  Status is the return status.
   0 indicates success.
  -1 indicates that ZEMAX is not running.
  -2 indicates that the lens could not be updated.
  -3 indicates an invalid surface number.
  -4 indicates the surface is too thick (INFINITY).
  -5 indicates the surface has zero thickness.
  -6 indicates that there are insufficient MOFF operands at the start of the multicon editor.
</PRE>
</P>
<P>
<A name = "PMTF"><H2>PMTF</H2></A>
<PRE>
  PMTF(Wavelengths, Wavelength_Weights, Focal_Ratio, Spatial_Frequencies)
 
  Computes the polychromatic diffraction-limited <a href = "#MTF">MTF</a> for the given wavelengths
  summed with the given weights.
</PRE>
</P>
<P>
<A name = "PPSF"><H2>PPSF</H2></A>
<PRE>
  PPSF(Wavelengths, Wavelength_Weights, Focal_Ratio, Radial_Image_Coordinates, Central_Obscuration_Ratio)
 
  Computes the polychromatic Diffraction Point Spread Function for a number of wavelengths, weights and radial image coordinates.
  The radial image coordinate will be in the same length units as that used for the wavelength.
  The focal ratio is the ratio of the focal length to the lens diameter.
  The central obscuration ratio is the ratio of the diameter of the central obscuration to the total clear diameter.
 
  A matrix is returned with the results corresponding to varying radial image coordinate along the columns,
  and the results corresponding to varying wavelength along the rows.
</PRE>
</P>
<P>
<A name = "PSF"><H2>PSF</H2></A>
<PRE>
  PSF(Wavelengths, Focal_Ratio, Radial_Image_Coordinates, Central_Obscuration_Ratio)
 
  Computes the monochromatic Diffraction Point Spread Function for a number of wavelengths and radial image coordinates.
  The radial image coordinate will be in the same length units as that used for the wavelength.
  The focal ratio is the ratio of the focal length to the lens diameter.
  The central obscuration ratio is the ratio of the diameter of the central obscuration to the total clear diameter.
 
  A matrix is returned with the results corresponding to varying radial image coordinate along the columns,
  and the results corresponding to varying wavelength along the rows.
</PRE>
</P>
<P>
<A name = "PSF2D"><H2>PSF2D</H2></A>
<PRE>
  PSF2D(Wavelengths, Wavelength_Weights, Focal_Ratio, Number_of_X_Pixels, Number_of_Y_Pixels, Pixel_Pitch, Central_Obscuration_Ratio)
 
  Computes a normalised 2-dimensional image of the polychromatic diffraction-limited point spread function.
  The number of pixels in x and y can be specified, along with the pixel pitch.
  A central obscuration can be specified with the ratio of the obscuration diameter to the total diameter.
  The x and y pixel counts should be even.
 
</PRE>
</P>
<P>
<A name = "Planck"><H2>Planck</H2></A>
<PRE>
  Planck(Wavelength, Temperature)
 
  Returns spectral radiance of a Black Body
  in watts per square centimetre per micron of spectral bandwidth
  Parameters are wavelength and temperature
  Wavelength is in microns
  Temperature is in Kelvins (Celsius + 273)
  Both wavelength and temperature can be vectors.
  
  Returns a matrix with wavelength varying from row to row and T varying from column to column
  
</PRE>
</P>
<P>
<A name = "PlotZemaxOTF"><H2>PlotZemaxOTF</H2></A>
<PRE>
  PlotZemaxOTF(zmxOTF)
 
  Expects a structure according to the format returned by <a href = "#ReadZemaxOTF">ReadZemaxOTF</a> or <a href = "#zGetMTF">zGetMTF</a>.
  Plots the thru-frequency OTF/MTF data.
</PRE>
</P>
<P>
<A name = "RayDevParPlate"><H2>RayDevParPlate</H2></A>
<PRE>
  <a href = "#RayDevParPlate">RayDevParPlate</a> - Calculates lateral deviation of a ray passing through a plane parallel plate.
 
  Usage : d = RayDevParPlate(MediumRefractiveIndex, PlateRefractiveIndex, AngleOfIncidence, PlateThickness)
  where MediumRefractiveIndex is the refractive index of the medium surrounding the plate,
        PlateRefractiveIndex  is the refractive index of the plate,
        AngleOfIncidence is the angle of incidence of the ray striking the plate (in radians) and
        PlateThickness is the thickness of the plate in any linear units.
  The returned value is in the same units as the plate thickness.
</PRE>
</P>
<P>
<A name = "ReadCIE"><H2>ReadCIE</H2></A>
<PRE>
  Read CIE Data into Workspace variables
  The following data files are read.
  You can load these workspace variables also using load('CIE.mat');
 
  CIEsia.txt
  	CIE 15.2-1986 Table 1.1 
  	Part 1: CIE Standard Illuminant A relative spectral power distribution
  	300 nm - 830 nm at 5 nm intervals (CIEsLambda)
  
  CIEsid65.txt
  	CIE 15.2-1986 Table 1.1
  	Part 2: CIE Standard Illuminant D65 relative spectral power distribution
  	300 nm - 830 nm at 5 nm intervals (CIEsLambda)
  
  CIEs0.txt
  	CIE 15.2-1986 Table 1.2
  	Part 1. Component S0 of daylight used in the calculation of relative
  	spectral power distribution of daylight illuminants of different 
  	correlated colour temperatures, for wavelength 300 to 830 nm at 5 nm
  	intervals (CIEsLambda)
  
  CIEs1.txt
  	CIE 15.2-1986 Table 1.2
  	Part 2. Component S1 of daylight used in the calculation of relative
  	spectral power distribution f daylight illuminants of different
  	correlated colour temperatures, for wavelength 300 to 830 nm at 5 nm
  	intervals (CIEsLambda)
  
  CIEs2.txt
  	CIE 15.2-1986 Table 1.2
  	Part 3. Component S2 of daylight used in the calculation of relative
  	spectral power distribution of daylight illuminants of different
  	correlated colour temperatures, for wavelength 300 to 830 nm at 5 nm
  	intervals (CIEsLambda)
  
  CIEx2.txt
  	CIE 15.2-1986 Table 2.1 data
  	CIE 1931 Standard Colorimetric Observer x2(lambda) data between
  	380 nm and 780 nm at 5 nm intervals (CIExyzLambda)
  
  CIEy2.txt
  	CIE 15.2-1986 Table 2.1 data
  	CIE 1931 Standard Colorimetric Observer y2(lambda) data between
  	380 nm and 780 nm at 5 nm intervals (CIExyzLambda)
  
  CIEz2.txt
  	CIE 15.2-1986 Table 2.1 data
  	CIE 1931 Standard Colorimetric Observer z2(lambda) data between
  	380 nm and 630 nm at 5 nm intervals (CIExyzLambda)
  
  CIEx10.txt
  	CIE 15.2-1986 Table 2.2 data
  	CIE 1964 Supplementary Standard Colorimetric Observer x10(lambda)
  	data between 380 nm and 780 nm at 5 nm intervals (CIExyzLambda)
  
  CIEy10.txt
  	CIE 15.2-1986 Table 2.2 data
  	CIE 1964 Supplementary Standard Colorimetric Observer y10(lambda)
  	data between 380 nm and 780 nm at 5 nm intervals (CIExyzLambda)
  
  CIEz10.txt
  	CIE 15.2-1986 Table 2.2 data
  	CIE 1964 Supplementary Standard Colorimetric Observer z10(lambda)
  	data between 380 nm and 560 nm at 5 nm intervals (CIExyzLambda)
</PRE>
</P>
<P>
<A name = "ReadZemaxGImAnal"><H2>ReadZemaxGImAnal</H2></A>
<PRE>
  <a href = "#ReadZemaxGImAnal">ReadZemaxGImAnal</a> - Read results from a ZEMAX Geometric Image Analysis
 
  Usage : zmxGimAnal = ReadZemaxGImAnal(File);
 
  Reads data written by ZEMAX from a geometric image analysis.
  The associated ZemaxButton is 'Ima'.
  Currently only does pixel data. Not complete.
 
  See also : <a href = "#zGetTextFile">zGetTextFile</a>, <a href = "#ZemaxButtons">ZemaxButtons</a>
</PRE>
</P>
<P>
<A name = "ReadZemaxIllum"><H2>ReadZemaxIllum</H2></A>
<PRE>
  zmxIllum = ReadZemaxIllum(File)
 
  Reads text written from a Zemax Relative Illumination (Rel) analysis.
  The text can be written from the Relative Illumination window, or generated using <a href = "#zGetTextFile">zGetTextFile</a> with the 'Rel' code (see help <a href = "#ZemaxButtons">ZemaxButtons</a>)
  The results are returned in a struct in which the following fields are defined :
       datatype: Type of data in e.g. 'Relative Illumination Data'
           file: Name of the ZEMAX file from which the data was computed e.g. 'C:\Projects\MSMI\Concepts\baf(960)mak.ZMX'
          title: Title of the ZEMAX file from which the data was computed e.g. 'mak U.S.Patent 2701983 Variant a'
           date: Date on which the data was computed e.g. 'THU NOV 6 2003'
            wav: Wavelength of the computation (in microns)
     fieldunits: The units of the field position data (e.g. millimetres or degrees)
          field: The field position data in fieldunits.
         relill: The relative illumination data.
         effeff: The effective F number at this field position.
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>
</PRE>
</P>
<P>
<A name = "ReadZemaxOTF"><H2>ReadZemaxOTF</H2></A>
<PRE>
  zmxOTF = ReadZemaxOTF(Filename)
 
  Reads text written from a Zemax thru-frequency, thru-focus or thru-field OTF/MTF analysis.
  The text can be written from the Mtf analysis window, or generated using the <a href = "#zGetTextFile">zGetTextFile</a> with the 'Mtf' code (see help <a href = "#ZemaxButtons">ZemaxButtons</a>)
  The codes for thru-focus abd thru-field MTF/OTF computations are respectively 'Tfm' and 'Mth'.
  The results are returned in a struct in which the following fields are defined :
       datatype: Type of data in the data field e.g. 'Polychromatic Diffraction MTF'
           file: Name of the ZEMAX file from which the data was computed e.g. 'C:\Projects\MSMI\Concepts\baf(960)mak.ZMX'
          title: Title of the ZEMAX file from which the data was computed e.g. 'mak U.S.Patent 2701983 Variant a'
           date: Date on which the data was computed e.g. 'THU NOV 6 2003'
            wav: Wavelength range for the computation e.g. [0.4500 0.5150]
          sfreq: Spatial frequencies at which data is presented.
     sfrequnits: Units of spatial frequency scale e.g. 'Cycles per mm.'
       fieldpos: Field position data in cell array e.g. {'Diffraction limit'  '0.00 mm'  '20.00 mm'  '40.00 mm'  '40.00 mm'}
        colhead: Column headings in a cell array e.g {'Spatial frequency'  'Tangential'   'Sagittal'}
         abscis: The abscissa - Spatial frequencies, focus or field position e.g. [102x1 double]
           data: The actual data e.g. [102x10 double]
         fieldx: The x values of the field positions e.g. [0 0 0 0 0]
         fieldy: The y values of the field positions e.g. [0 0 20 40 40]
     fieldunits: The units of the field positions e.g. 'mm'
         fcount: The number of field positions (thru-focus and thru-frequency) or spatial frequencies (thru-field). The
                 number of data columns will be twice this value (for Tangential and Sagittal data).
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>
</PRE>
</P>
<P>
<A name = "ReadZemaxRMS"><H2>ReadZemaxRMS</H2></A>
<PRE>
  zmxRMS = ReadZemaxRMS(Filename)
 
  Reads text written from a Zemax RMS Wavefront, Spot size or Strehl Ratio Analysis.
  The text can be written from an RMS analysis window, or generated using the <a href = "#zGetTextFile">zGetTextFile</a> with the 'Rmf', 'Rms', or 'Rmw' 
  codes (see help <a href = "#ZemaxButtons">ZemaxButtons</a>)
  The results are returned in a struct in which the following fields are defined :
       datatype: Type of data in the data field e.g. 'RMS Wave Error vs. Focus'
           file: Name of the ZEMAX file from which the data was computed e.g. 'C:\Projects\MSMI\Concepts\baf(960)mak.ZMX'
          title: Title of the ZEMAX file from which the data was computed e.g. 'mak U.S.Patent 2701983 Variant a'
           date: Date on which the data was computed e.g. 'THU NOV 6 2003'
           ylab: Data plotted on the y-axis
           xlab: Data plotted on the x-axis
            ref: Reference for the data - either Centroid or Chief Ray
         yunits: Units for the y-axis
         xunits: Units for the x-axis
  Additional fields are dependent on what data is present.
  For ylab == 'Field' (ie an RMS vs. Field datatype)
         orient: The orientation of the data vector, +y, -y, +x or -x
          waves: The wavelengths at which the values (yunits) have been computed. One column per
                 wavelength.
           poly: Set to 1 if the polychromatic data appear. If so, found in first data column.
         fields: The field values for the data in units given by xunits.
           data: The RMS or strehl data, one column for polychromatic data (if poly=1) and one per wavelength. 
  For ylab == 'Focus' (ie an RMS vs. Focus datatype)
          focus: The focus positions in xunits for which the data is computed.
           data: The RMS or strehl data, one column for each field position, one row for each focus
                 position.
  For ylab == 'Wavelength' (ie an RMS vs. Wavelength datatype)
          waves: The wavelengths in yunits at which the data have been computed.
           data: The RMS or strehl data, one column per field position, one row per wavlength.
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>
</PRE>
</P>
<P>
<A name = "ReadZemaxVignet"><H2>ReadZemaxVignet</H2></A>
<PRE>
  zmxVignet = ReadZemaxVignet(File)
 
  Reads text written from a Zemax Vignetting (Vig) analysis.
  The text can be written from the Vignetting window, or generated using <a href = "#zGetTextFile">zGetTextFile</a> with the 'Vig' code (see help <a href = "#ZemaxButtons">ZemaxButtons</a>)
  The results are returned in a struct in which the following fields are defined :
       datatype: Type of data in e.g. 'Vignetting Data'
           file: Name of the ZEMAX file from which the data was computed e.g. 'C:\Projects\MSMI\Concepts\baf(960)mak.ZMX'
          title: Title of the ZEMAX file from which the data was computed e.g. 'mak U.S.Patent 2701983 Variant a'
           date: Date on which the data was computed e.g. 'THU NOV 6 2003'
     fieldunits: The units of the field position data (e.g. millimetres or degrees)
          field: The field position data in fieldunits.
            vig: The vignetting data.
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>
</PRE>
</P>
<P>
<A name = "ReadZemaxWaveMap"><H2>ReadZemaxWaveMap</H2></A>
<PRE>
  zmxWaveMap = ReadZemaxWaveMap(File)
 
  Reads text written from a Zemax Wavefront Map (Wfm) analysis.
  The text can be written from the Wavefront Map window, or generated using the <a href = "#zGetTextFile">zGetTextFile</a> with the 'Wfm' code (see help <a href = "#ZemaxButtons">ZemaxButtons</a>)
  The results are returned in a struct in which the following fields are defined :
       datatype: Type of data in the data field e.g. 'Listing of Wavefront Map Data'
           file: Name of the ZEMAX file from which the data was computed e.g. 'C:\Projects\MSMI\Concepts\baf(960)mak.ZMX'
          title: Title of the ZEMAX file from which the data was computed e.g. 'mak U.S.Patent 2701983 Variant a'
           date: Date on which the data was computed e.g. 'THU NOV 6 2003'
            wav: Wavelength of the computation
          field: Field Position of computation
          funit: Field position units e.g. 'mm' or 'deg'.
             pv: Peak to valley error of the wavefront as reported by ZEMAX
           grid: Size of the data grid e.g. [64 64]
         center: Location of the centre point of the data e.g. [33 33]
           data: The wavefront map data. The size of this matrix is given by grid.
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>
</PRE>
</P>
<P>
<A name = "RelIrrad"><H2>RelIrrad</H2></A>
<PRE>
  <a href = "#RelIrrad">RelIrrad</a> - Computes Relative Irradiance (Illuminance perhaps) of the image plane of an axisymmetric lens system.
 
  Usage : RI = RelIrrad(wave, NumberOfFieldPoints, NumberOfRaysPerFieldPoint)
  A number of assumptions are made to get a valid result.
  1) The object space is filled with radiation of uniform radiance in all directions.
     i.e. the object space is isotropic in radiance.
     This condition is similar to putting the system inside an integrating sphere.
  2) The image irradiance is measured at a planar image surface.
  3) The lens system is axisymmetric, free of vignetting and other field-dependent transmission modulatiing effects.
  4) The aberrations of the lens system are negligible except for distortion.
  5) There are no obscurations in the pupil of the lens, either induced by aberration or mechanically. i.e. the result for a
  system with a central obscuration will be wrong.
  5) The method used is to calculate the flux entering the entrance pupil, and then to calculate the flux density arriving at
  the image plane using the distortion function of the lens system. The distortion function is defined as the relationship
  between the angle of the chief ray (central ray at the aperture stop) entering the entrance pupil, and the distance at which
  this ray strikes the image plane from the optical axis.
  6) This computation should give a similar result to the ZEMAX Relative Illumination (RI) computation, except that the ZEMAX
  result includes vignetting and other field-dependent transmission effects. The result of this computation, however, does
  represent an uppper limit on the image relative irradiance.
  7) As with the ZEMAX RI computation, the result is normalized to the axial value.
  8) You must ensure that ZEMAX is accurately finding the edge of the entrance pupil, and ray aiming will most likely have to
  be switched on for systems having internal aperture stops.
  9) Your field size must be specified in degrees in object space, the object surface must be set to infinity, and your
  maximum field angle must be positive. This routine currently does no checking of these aspects.
 
  wave is the wavelength number at which to perform the analysis.
  The NumberOfFieldPoints parameter determines the number of field points at which to calculate the RI, and the
  NumberOfRaysPerFieldPoint determines the number of rays traced around the edge of the entrance pupil to compute the effective
  collecting area of the pupil.
</PRE>
</P>
<P>
<A name = "ReverseSurfaces"><H2>ReverseSurfaces</H2></A>
<PRE>
  <a href = "#ReverseSurfaces">ReverseSurfaces</a> - Reverses a series of surfaces in a lens.
 
  Usage : Reply = ReverseSurfaces(FirstSurface, LastSurface)
  
  The surfaces FirstSurface to LastSurface are reversed. This function is performed by first putting these surfaces into
  double pass using the <a href = "#DoublePass">DoublePass</a> function, and then deleting the old surfaces. This approach has major limitations,
  including (but not limited to) the limitations of the <a href = "#DoublePass">DoublePass</a> routine. In particular, all pickups, variables and
  solves are lost for the reversed surfaces.
 
  See also : <a href = "#DoublePass">DoublePass</a>
 
</PRE>
</P>
<P>
<A name = "SagEvenAsphere"><H2>SagEvenAsphere</H2></A>
<PRE>
  <a href = "#SagEvenAsphere">SagEvenAsphere</a> - Computes the profile of a ZEMAX standard even aspheric surface.
 
  Usage : Sag = SagEvenAsphere(ProfileData, r)
 
  The Profile data consists of a vector having the paraxial radius of curvature,
  the conic constant and a series of coefficients for the even power of the radial
  distance.
 
  The sag of the surface is computed at the distances r from the axis.
 
</PRE>
</P>
<P>
<A name = "SpiralSpot"><H2>SpiralSpot</H2></A>
<PRE>
  <a href = "#SpiralSpot">SpiralSpot</a> - Produces a series of x, y values of rays traced in a spiral over the entrance pupil
 
  Usage : [x, y] = SpiralSpot(ObjectHeighty, ObjectHeightx, Wave, Spirals, Rays)
          plot(x,y)
  Where the x and y data is the ray landing  data at the image surface in lens units.
        ObjectHeighty is the fractional object height in y from which the rays are traced.
        ObjectHeightx is the fractional object height in y from which the rays are traced.
        Wave is the wavelength number to use.
        Spirals is the number of spirals to execute.
        Rays is the number of rays to trace, and therefore the number of x,y pairs as well.
</PRE>
</P>
<P>
<A name = "WriteZemaxWaveFile"><H2>WriteZemaxWaveFile</H2></A>
<PRE>
  <a href = "#WriteZemaxWaveFile">WriteZemaxWaveFile</a> - Writes a list of wavelengths formatted for ZEMAX
 
  Usage : WriteZemaxWaveFile(File, WaveMatrix, Primary)
  File is the file to write.
  WaveMatrix is a matrix of wavelengths and weights (one each per row).
  Primary is the primary wavelength number.
 
</PRE>
</P>
<P>
<A name = "ZEMAXBusy"><H2>ZEMAXBusy</H2></A>
<PRE>
  ZEMAXBUSY M-file for <a href = "#ZEMAXBusy">ZEMAXBusy</a>.fig
       ZEMAXBUSY, by itself, creates a new ZEMAXBUSY or raises the existing
       singleton*.
 
       H = ZEMAXBUSY returns the handle to a new ZEMAXBUSY or the handle to
       the existing singleton*.
 
       ZEMAXBUSY('CALLBACK',hObject,eventData,handles,...) calls the local
       function named CALLBACK in ZEMAXBUSY.M with the given input arguments.
 
       ZEMAXBUSY('Property','Value',...) creates a new ZEMAXBUSY or raises the
       existing singleton*.  Starting from the left, property value pairs are
       applied to the GUI before ZEMAXBusy_OpeningFunction gets called.  An
       unrecognized property name or invalid value makes property application
       stop.  All inputs are passed to ZEMAXBusy_OpeningFcn via varargin.
 
       *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
       instance to run (singleton)".
 
  See also: GUIDE, GUIDATA, GUIHANDLES
</PRE>
</P>
<P>
<A name = "ZemaxButtons"><H2>ZemaxButtons</H2></A>
<PRE>
  ZEMAX 3-Letter Analysis/Action Window Codes (ZEMAX Version September 19, 2002)
  These codes are case-sensitive.
 
   Off: None                          Mfl: Merit Function List
   ABg: ABg Data Catalog              Mfo: Make Focal
   Bfv: Beam File Viewer              Mgm: Geometric <a href = "#MTF">MTF</a> Map
   Caa: Coating, Abs. vs. Angle       Mtf: Modulation TF
   Car: Cardinal Points               Mth: <a href = "#MTF">MTF</a> vs. Field
   Cas: Coat All Surfaces             NCE: Non-Sequential Editor
   Caw: Coating, Abs. vs. Wavelength  New: New File
   Cca: Convert to Circular Apertures Nxc: Next Configuration
   Cda: Coating, Dia. vs. Angle       Off: Huygens Through Focus <a href = "#MTF">MTF</a>
   Cdw: Coating, DIa. vs. Angle       Opd: Opd Fan
   Cfa: Convert to Floating Apertures Ope: Open File
   Cfs: Chromatic Focal Shift         Opt: Optimization
   Cls: Coating List                  Pab: Pupil Aberration Fan
   Cna: Coating, Ret. vs. Angle       Pcs: <a href = "#PSF">PSF</a> Cross Section
   Cng: Convert to NSC Group          Per: Performance Test
   Cnw: Coating, Ret. vs. Wavelength  Pha: Pol. Phase Aberration
   Cpa: Coating, Phase vs. Angle      Pmp: Pol. Pupil Map
   Cpw: Coating, Phase vs. Wavelength Pol: Pol. Ray Trace
   Cra: Coating, Refl vs. Angle       Pop: Physical Optics Propagation
   Crw: Coating, Refl. vs. Wavelength Pre: Prescription Data
   Cta: Coating, Tran. vs. Angle      Prf: Preferences
   Ctw: Coating, Tran. vs. Wavelength Ptf: Pol. Transmission Fan
   Dcl: Detector Control              Qfo: Quick Focus
   Dim: Diffraction Image Analysis    Raa: Remove All Apertures
   Dip: Biocular Dipvergence/Converge Ray: Ray Fan
   Dis: Dispersion Plot               Rcf: Reload Coating File
   Dvi: Detector Viewer               Rdb: Ray Database
   EDE: Extra Data Editor             Red: Redo
   Ect: Edit Coating                  Rel: Relative Illumination
   Ele: ZEMAX Element Drawing         Rev: Reverse Elements
   Enc: Diff Encircled Energy         Rg4: New Report Graphic 4
   Ext: Exit                          Rg6: New Report Graphic 6
   Fcd: Field Curv/Distorion          Rmf: RMS vs. Focus
   Fcl: Fiber Coupling                Rml: Refresh Macro List
   Fie: Field Data                    Rms: RMS vs. Field
   Fld: Add Fold Mirror               Rmw: RMS vs. Wavelength
   Flx: Delete Fold Mirror            Rtr: Ray Trace
   Foa: Foucault Analysis             Rva: Remove Variables
   Foo: Footprint Analysis            Rxl: Refresh Extensions List
   Fov: Biocular Field of View Analys Sag: Sag Table
   Fps: FFT <a href = "#PSF">PSF</a>                       Sas: Save As
   Gbp: Parax Gaussian Beam           Sav: Save File
   Gbs: Skew Gaussian Beam            Sca: Scale Lens
   Gen: General Lens Data             Sei: Seidel Coefficients
   Geo: Geom Encircled Energy         Sff: Full Field Spot
   Gho: Ghost Focus                   Sld: Slider
   Gla: Glass Catalog                 Sma: Spot Matrix
   Glb: Global Optimization           Smc: Spot Matrix Config
   Gmp: Glass Map                     Smf: Surface <a href = "#MTF">MTF</a>
   Gpr: Gradium Profile               Spt: Spot Diagram
   Grd: Grid Distortion               Srp: Surface Phase
   Gst: Glass Substitution Template   Srs: Surface Sag
   Gtf: Geometric <a href = "#MTF">MTF</a>                 Ssg: System Summary Graphic
   Gvf: Geometric <a href = "#MTF">MTF</a> vs. Field       Stf: Though Focus Spot
   Ham: Hammer Optimization           Sur: Surface Data
   Hlp: Help                          Sys: System Data
   Hmf: Huygens <a href = "#MTF">MTF</a>                   TDE: Tolerance Data Editor
   Hps: Huygens <a href = "#PSF">PSF</a>                   Tde: Tilt/Decenter Elements
   Hsm: Huygens SUrface <a href = "#MTF">MTF</a>           Tfg: Through Focus GTF
   ISO: ISO Element Drawing           Tfm: Through Focus <a href = "#MTF">MTF</a>
   Ibm: Geometric Bitmap Image Analys Tls: Tolerance List
   Igs: Export IGES File              Tol: Tolerancing
   Ilf: Illumination Surface          Tpf: Test Plate Fit
   Ils: Illumination Scan             Tpl: Test Plate Lists
   Ima: Geometric Image Analysis      Tra: Pol. Transmission
   Imv: IMA/BIM File Viewer           Trw: Transmission vs. Wavelength
   Ins: Insert Lens                   Tsm: Tolerance Summary
   Int: Interferogram                 Und: Undo
   L3d: 3D Layout                     Uni: Universal Plot
   L3n: NSC 3D Layout                 Upa: Update All
   LDE: Lens Data Editor              Upd: Update
   LSn: NSC Shaded Model Layout       Vig: Vignetting Plot
   Lac: Last Configuration            Wav: Wavelength Data
   Lat: Lateral Color                 Wfm: Wavefront Map
   Lay: 2D Layout                     Xdi: Extended Diffraction Image Analysis
   Len: Lens Search                   Xis: Export IGES/STEP/SAT FIle
   Lin: Line/Edge Response            Xse: Extended Source Encircled
   Lon: Longitudinal Aberration       Yni: YNI Contributions
   Lsh: Shaded Model Layout           Yyb: Y-Ybar
   Lsm: Solid Model Layout            Zat: Zernike Annular Terms
   Lwf: Wireframe Layout              Zex: ZEMAX Extensions
   MCE: Multi-Config Editor           Zfr: Zernike Fringe Terms
   MFE: Merit Function Editor         Zpl: Edit/Run ZPL Macros
   Mdm: FFT <a href = "#MTF">MTF</a> Map                   Zst: Zernike Standard Terms
 
   There are 168 Buttons in this list. The latest version of ZEMAX may have more.
</PRE>
</P>
<P>
<A name = "ZemaxOperands"><H2>ZemaxOperands</H2></A>
<PRE>
  ZEMAXOperands - ZEMAX Operand and Type Key - ZEMAX Version 19 September 2002
 
  Usage : ZEMAXOperandList = ZEMAXOperands
  Returns a column vector of operand names.
  This key may be different for other versions of ZEMAX.
 
    1= ABSO       66= FICL      131= MNCA      196= P1VA      261= REAZ
    2= ACOS       67= FICP      132= MNCG      197= P2GT      262= RELI
    3= AMAG       68= FOUC      133= MNCT      198= P2LT      263= RENA
    4= ANAR       69= GBPD      134= MNCV      199= P2VA      264= RENB
    5= ASIN       70= GBPR      135= MNDT      200= P3GT      265= RENC
    6= ASTI       71= GBPS      136= MNEA      201= P3LT      266= RETX
    7= ATAN       72= GBPW      137= MNEG      202= P3VA      267= RETY
    8= AXCL       73= GBPP      138= MNET      203= P4GT      268= RGLA
    9= BIOC       74= GBSD      139= MNIN      204= P4LT      269= RSCH
   10= BIOD       75= GBSR      140= MNPD      205= P4VA      270= RSCE
   11= BIPF       76= GBSS      141= MNSD      206= P5GT      271= RSRE
   12= BLNK       77= GBSW      142= MSWA      207= P5LT      272= RSRH
   13= BSER       78= GBSP      143= MSWS      208= P5VA      273= RWCH
   14= CENX       79= GCOS      144= MSWT      209= P6GT      274= RWCE
   15= CENY       80= GENC      145= MTFA      210= P6LT      275= RWRE
   16= CMFV       81= GLCA      146= MTFS      211= P6VA      276= RWRH
   17= CMGT       82= GLCB      147= MTFT      212= P7GT      277= SAGX
   18= CMLT       83= GLCC      148= MXAB      213= P7LT      278= SAGY
   19= CMVA       84= GLCX      149= MXCA      214= P7VA      279= SFNO
   20= CODA       85= GLCY      150= MXCG      215= P8GT      280= SINE
   21= COGT       86= GLCZ      151= MXCT      216= P8LT      281= SKIS
   22= COLT       87= GMTA      152= MXCV      217= P8VA      282= SKIN
   23= COMA       88= GMTS      153= MXDT      218= PANA      283= SPCH
   24= CONF       89= GMTT      154= MXEA      219= PANB      284= SPHA
   25= CONS       90= GOTO      155= MXEG      220= PANC      285= SQRT
   26= COSI       91= GPIM      156= MXET      221= PARA      286= SSAG
   27= COVA       92= GRMN      157= MXIN      222= PARB      287= SUMM
   28= CTGT       93= GRMX      158= MXPD      223= PARC      288= SVIG
   29= CTLT       94= GTCE      159= MXSD      224= PARR      289= TANG
   30= CTVA       95= HACG      160= NPGT      225= PARX      290= TFNO
   31= CVGT       96= HHCN      161= NPLT      226= PARY      291= TGTH
   32= CVLT       97= I1GT      162= NPVA      227= PARZ      292= TMAS
   33= CVOL       98= I2GT      163= NPXG      228= PATX      293= TOTR
   34= CVVA       99= I3GT      164= NPXL      229= PATY      294= TRAC
   35= DENC      100= I4GT      165= NPXV      230= PETC      295= TRAD
   36= DENF      101= I5GT      166= NPYG      231= PETZ      296= TRAE
   37= DIFF      102= I6GT      167= NPYL      232= PIMH      297= TRAI
   38= DIMX      103= I1LT      168= NPYV      233= PLEN      298= TRAN
   39= DISC      104= I2LT      169= NPZG      234= PMAG      299= TRAR
   40= DISG      105= I3LT      170= NPZL      235= POWR      300= TRAX
   41= DIST      106= I4LT      171= NPZV      236= PRIM      301= TRAY
   42= DIVI      107= I5LT      172= NSDD      237= PROD      302= TRCX
   43= DLTN      108= I6LT      173= NSTR      238= PMGT      303= TRCY
   44= DMFS      109= I1VA      174= NTXG      239= PMLT      304= TTGT
   45= DMGT      110= I2VA      175= NTXL      240= PMVA      305= TTHI
   46= DMLT      111= I3VA      176= NTXV      241= POPD      306= TTLT
   47= DMVA      112= I4VA      177= NTYG      242= QOAC      307= TTVA
   48= DXDX      113= I5VA      178= NTYL      243= QSUM      308= UDOP
   49= DXDY      114= I6VA      179= NTYV      244= RAGA      309= USYM
   50= DYDX      115= IMAE      180= NTZG      245= RAGB      310= VOLU
   51= DYDY      116= INDX      181= NTZL      246= RAGC      311= WFNO
   52= EFFL      117= ISFN      182= NTZV      247= RAGX      312= XDVA
   53= EFLX      118= ISNA      183= OSCD      248= RAGY      313= XDGT
   54= EFLY      119= LACL      184= OBSN      249= RAGZ      314= XDLT
   55= ENDX      120= LINV      185= OOFF      250= RAED      315= XENC
   56= ENPP      121= LOGE      186= OPDC      251= RAEN      316= XNEA
   57= EPDI      122= LOGT      187= OPDM      252= RAID      317= XNEG
   58= EQUA      123= LONA      188= OPDX      253= RAIN      318= XNET
   59= ETGT      124= LPTD      189= OPGT      254= RANG      319= XXEA
   60= ETLT      125= MAXX      190= OPLT      255= REAA      320= XXEG
   61= ETVA      126= MCOG      191= OPVA      256= REAB      321= XXET
   62= EXPP      127= MCOL      192= OPTH      257= REAC      322= YNIP
   63= FCGS      128= MCOV      193= OSUM      258= REAR      323= ZERN
   64= FCGT      129= MINN      194= P1GT      259= REAX      324= ZPLM
   65= FCUR      130= MNAB      195= P1LT      260= REAY      325= ZTHI
</PRE>
</P>
<P>
<A name = "ZemaxSurfTypes"><H2>ZemaxSurfTypes</H2></A>
<PRE>
  ZEMAX Surface Types : Generates List of Surface Type Codes and Descriptions
 
  Usage : <a href = "#ZemaxSurfTypes">ZemaxSurfTypes</a>
 
  Creates a cell array called stype with the ZEMAX surface type codes and descriptions.
 
  ABCDSURF ABCD                          Uses ABCD matrix to model a black box.
  ALTERNAT Alternate Even                Even Asphere surface with alternate solution selected.
  ALTERNAO Alternate Odd                 Odd Asphere surface with alternate solution selected.
  ATMOSPHR Atmospheric Refraction        Refraction caused by looking through Earth's atmosphere.
  BICONICX Biconic                       A conic asphere in X and Y independently.
  BICONICZ Biconic Zernike               A biconic surface with x  y  and Zernike polynomial terms added.
  BINARY_1 Binary Optic 1                Uses 230 term polynomial to define phase.
  BINARY_2 Binary Optic 2                Uses radial polynomial to define phase.
  BINARY_3 Binary Optic 3                Dual zone aspheric and diffractive surface.
  BIRE__IN Birefringent In               For modeling uniaxial crystals; supports tracing of rays in ordinary or extraordinary mode.
  BIRE_OUT Birefringent Out              For modeling uniaxial crystals; supports tracing of rays in ordinary or extraordinary mode.
  CONJUGAT Conjugate                     Defines surface with perfect imaging at two points.
  COORDBRK Coordinate Break              Permits rotation and decentration.
  CUSPLINE Cubic Spline                  Rotationally symmetric fit to 8 points.
  CFRESNEL Cylindrical Fresnel           Polynomial cylindrical Fresnel on a polynomial cylindrical surface.
  DGRATING Diffraction Grating           Ruled grating on standard surface.
  ELLIGRAT Elliptical Grating 1          Elliptical grating with aspheric terms and polynomial grooves.
  ELLIGRA2 Elliptical Grating 2          Elliptical grating with aspheric terms and grooves formed by tilted planes.
  EVENASPH Even Asphere                  Standard surface plus polynomial asphere terms.
  XASPHERE Extended Asphere              Uses radial polynomial to define sag.
  XCUSPLIN Extended Cubic Spline         Rotationally symmetric fit of up to 250 points.
  XFRESNEL Extended Fresnel Polynomial   Fresnel on a polynomial surface.
  XOSPHERE Extended Odd Asphere          Uses odd terms of radial powers.
  XPOLYNOM Extended Polynomial           Uses 230 term polynomial expansion to define sag.
  TOROGRAX Extended Toroidal Grating     An aspheric toroidal grating with extended polynomial terms.
  FRESNELS Fresnel                       Plane surface with refractive power.
  GEN_FRES Generalized Fresnel           XY polynomial Fresnel on an aspheric substrate.
  GRINSUR1 Gradient 1                    Radial gradient index material surface.
  GRINSUR2 Gradient 2                    Radial gradient index material surface.
  GRINSUR3 Gradient 3                    Radial and axial gradient index material surface.
  GRINSUR4 Gradient 4                    X  Y  and Z gradient index material surface.
  GRINSUR5 Gradient 5                    Radial and axial gradient index material surface with dispersion model.
  GRINSUR6 Gradient 6                    Radial gradient index material surface with Gradient Lens Corp. dispersion model.
  GRINSUR7 Gradient 7                    Spherical gradient profile.
  GRINSUR8 Gradium                       Axial gradient index material surface with dispersion model.
  GRINSUR9 Gradient 9                    Radial gradient index material surface with NSG SELFOC lens dispersion model.
  GRINSU10 Gradient 10                   Y gradient index material surface with dispersion model.
  GRID_PHA Grid Phase                    A phase surface described by a grid of points.
  GRID_SAG Grid Sag                      A surface shape described by a grid of points.
  HOLOGRM1 Hologram 1                    Two-point optically fabricated hologram.
  HOLOGRM2 Hologram 2                    Two-point optically fabricated hologram.
  IRREGULA Irregular                     A standard surface with decenter  tilt and other deformations.
  JONESMAT Jones Matrix                  General Jones Matrix for modifying polarization state.
  NONSEQCO Non-Sequential Components     For tracing rays non-sequentially through a collection of 3D surfaces and objects.
  ODDASPHE Odd Asphere                   Standard surface plus polynomial asphere terms.
  ODDCOSIN Odd Cosine                    Odd Asphere surface plus cosine polynomial terms.
           Optically Fabricated Hologram Optically fabricated hologram with arbitrary construction optic and elliptical substrate.
  PARAXIAL Paraxial                      Thin lens surface  has ideal behavior.
  PARAX_XY Paraxial XY                   Thin lens with separate specification in X Y.
  PERIODIC Periodic                      Cosine shaped surface.
  POLYNOMI Polynomial                    Polynomial expansion in x and y.
  RGRATING Radial Grating                A diffraction grating with radial phase profile.
  RADNURBS Radial NURBS                  Uses NURBS curve to define a rotationally symmetric surface.
  RETROREF Retro Reflect                 Retro reflects rays back along incident path.
  STANDARD Standard                      Includes planes  spheres  and conics.
  SUPERCON Superconic                    Superconic asphere with fast convergence.
  TILTSURF Tilted                        Defines a tilted surface without changing coordinate systems.
  TOROIDAL Toroidal                      Conic and aspheric toroids and cylinders.
  TOROGRAT Toroidal Grating              Ruled grating on a conic toroid.
  TOROHOLO Toroidal Hologram             Toroidal substrate with two point optically fabricated hologram.
  TORNURBS Toroidal NURBS                Uses NURBS curve to define a toroidally symmetric surface.
  USERSURF User Defined                  A general surface which uses an arbitrary user defined function to describe the refractive  reflective  diffractive  transmissive  or gradient properties of the surface.
  VARLSGRT Variable Line Space Grating   Variable line space grating surface.
  FZERNPHA Zernike Fringe Phase          Uses 37 Zernike Fringe polynomials to define phase.
  FZERNSAG Zernike Fringe Sag            Uses 37 Zernike Fringe polynomials to define sag.
  SZERNPHA Zernike Standard Phase        Uses up to 231 Zernike Standard polynomials to define surface phase.
 
  See Also : <a href = "#zSetSurfaceData">zSetSurfaceData</a> and <a href = "#zGetSurfaceData">zGetSurfaceData</a>
</PRE>
</P>
<P>
<A name = "deg2rad"><H2>deg2rad</H2></A>
<PRE>
  Convert degrees to radians
  Usage : Radians = deg2rad(Degrees)
 
  See also : <a href = "#rad2deg">rad2deg</a>
</PRE>
</P>
<P>
<A name = "digitize"><H2>digitize</H2></A>
<PRE>
 function iXY = digitize()
                                                                             
 jdc 17-Feb-00
 PURPOSE   
      > Interactively digitizes data from an image file.  
      > X-Y axis scales can be any combination of linear, log.
      > Automatic compensation for angular misalignment of  
        image with respect to screen axes.
 INPUT
        (All input is interactively prompted)
      > imagename - image filespec (any <A href = "http://www.mathworks.com">Matlab</A>-compatible format)
      > three points defining coordinate axes  
      > arbitrary number of points on graph - digitized with left mouse button  
 OUTPUT
      > numbered sets of iXY triplets written to screen and optionally to disc storage
      > iXY - 3 x i matrix of all points digitized from image 
 
 TYPICAL CALL 
        <a href = "#digitize">digitize</a> <RETURN>
        It is necessary to switch between the MATLAB command window and the graphic display window to
        enter the prompted information.
</PRE>
</P>
<P>
<A name = "docgen"><H2>docgen</H2></A>
<PRE>
  Docgen script
  This script generates documentation from all the help text of the .m files in the toolbox.
  Usage : <a href = "#docgen">docgen</a>
 
  See Also : <a href = "#Census">Census</a>
</PRE>
</P>
<P>
<A name = "fuiget"><H2>fuiget</H2></A>
<PRE>
  <a href = "#fuiget">fuiget</a> - Simplified uiget
  Usage : As for uiget, except that the full path and filename of the selected file is returned.
 
</PRE>
</P>
<P>
<A name = "genRayDataMode0"><H2>genRayDataMode0</H2></A>
<PRE>
  <a href = "#genRayDataMode0">genRayDataMode0</a> - generates a raydata structure suitable for passing to <a href = "#zArrayTrace">zArrayTrace</a> mode 0.
 
  Usage : RayData = genRayDataMode0(hx, hy, px, py, radius, ...
                                    raytracingmode, finalsurface, intensity, wavenumber, opdrequest)
 
  hx and hy are scalars giving fractional field coordinates.
  px and py are vectors of fractional pupil coordinates. radius is the maximum radius for which points should
  be generated in the pupil.
  raytracingmode is set to 0 for real rays and 1 for paraxial rays.
  finalsurface is the surface at which to stop raytracing. Use -1 for the image surface.
  intensity is the initial intensity to assign to each ray.
  wavenumber is the wavelength number for the raytrace.
  opdrequest is set to 0 for no OPD calculation. Set to 1 to request OPD calculation.
 
  The structure RayData which is returned is suitable for passing directly to <a href = "#zArrayTrace">zArrayTrace</a>.
 
  See also <a href = "#zArrayTrace">zArrayTrace</a>, <a href = "#gridXYRayData">gridXYRayData</a>
</PRE>
</P>
<P>
<A name = "gridXYRayData"><H2>gridXYRayData</H2></A>
<PRE>
  <a href = "#gridXYRayData">gridXYRayData</a> - Generate a 2D grid of data in a struct with the given field names.
 
  RayDataOut = gridXYRayData(x, y, xname, yname, radius);
 
  x and y are are numeric vectors, xname and yname are strings, radius is a numeric scalar.
  Creates a vector struct (RayDataOut) with two fields called xname and yname. The elements of the struct have a
  meshgrid of values taken from the x and y vector inputs. Only elements with a hypotenuse (sqrt(x^2+y^2)) of less
  than or equal to the given value are included in the struct. This function is useful for generating data
  compatible for input to <a href = "#zArrayTrace">zArrayTrace</a>. The "radius" input is used to include only points within a circular
  pupil for example to generate data for a mode 0 call to <a href = "#zArrayTrace">zArrayTrace</a> with rays spread evenly over the pupil
  in a rectangular grid ...
 
  x = -1:0.1:1; y = -1:0.1:1;
  RayData = gridXYRayData(x, y, 'z', 'l', 1.0);
 
  The "radius" input is only used if specified greater than 0.
  See also <a href = "#zArrayTrace">zArrayTrace</a>, <a href = "#genRayDataMode0">genRayDataMode0</a>
</PRE>
</P>
<P>
<A name = "n_air"><H2>n_air</H2></A>
<PRE>
  n_air(lambda, T, P) returns the refractive index of air computed using the same formula used by ZEMAX
  See the section on Index of Refraction Computation in the Thermal Analysis chapter of the ZEMAX manual.
  
  lambda is wavelength in microns.
  T is temperature in Celsius.
  P is relative air pressure.
  This function returns a matrix with lambda varying from row to row, temperature varying from column to column
  and pressure varying in the depth dimension.
 
</PRE>
</P>
<P>
<A name = "rad2deg"><H2>rad2deg</H2></A>
<PRE>
  Convert radians to degrees
  Usage : Degrees = rad2deg(Radians)
 
  See also : <a href = "#deg2rad">deg2rad</a>
</PRE>
</P>
<P>
<A name = "textread"><H2>textread</H2></A>
<PRE>
 TEXTREAD Read formatted data from text file.
     A = TEXTREAD('FILENAME')
     A = TEXTREAD('FILENAME','',N)
     A = TEXTREAD('FILENAME','',param,value, ...)
     A = TEXTREAD('FILENAME','',N,param,value, ...) reads numeric data from
     the file FILENAME into a single variable.  If the file contains any
     text data, an error is produced.
 
     [A,B,C, ...] = TEXTREAD('FILENAME','FORMAT')
     [A,B,C, ...] = TEXTREAD('FILENAME','FORMAT',N)
     [A,B,C, ...] = TEXTREAD('FILENAME','FORMAT',param,value, ...)
     [A,B,C, ...] = TEXTREAD('FILENAME','FORMAT',N,param,value, ...) reads
     data from the file FILENAME into the variables A,B,C,etc.  The type of
     each return argument is given by the FORMAT string.  The number of
     return arguments must match the number of conversion specifiers in the
     FORMAT string.  If there are fewer fields in the file than in the
     format string, an error is produced.  See FORMAT STRINGS below for
     more information.
 
     If N is specified, the format string is reused N times.  If N is -1 (or
     not specified) TEXTREAD reads the entire file.
 
     If param,value pairs are supplied, user configurable options customize
     the behavior of TEXTREAD.  See USER CONFIGURABLE OPTIONS below.
 
     TEXTREAD works by matching and converting groups of characters from the
     file. An input field is defined as a string of non-whitespace
     characters extending to the next whitespace or delimiter character
     or until the field width is exhausted.  Repeated delimiter characters
     are significant while repeated whitespace characters are treated as
     one.
 
     FORMAT STRINGS
 
     If the FORMAT string is empty, TEXTREAD will only numeric data.
 
     The FORMAT string can contain whitespace characters (which are
     ignored), ordinary characters (which are expected to match the next
     non-whitespace character in the input), or conversion specifications.
 
     If whitespace is set to '' and format types are %s,%q,%[...] and %[^...]. 
     Else whitespace characters are ignored.
 
     Supported conversion specifications:
         %n - read a number - float or integer (returns double array)
              %5n reads up to 5 digits or until next delimiter
         %d - read a signed integer value (returns double array)
              %5d reads up to 5 digits or until next delimiter
         %u - read an integer value (returns double array)
              %5u reads up to 5 digits or until next delimiter
         %f - read a floating point value (returns double array)
              %5f reads up to 5 digits or until next delimiter
         %s - read a whitespace separated string (returns cellstr)
              %5s reads up to 5 characters or until whitespace
         %q - read a (possibly double quoted) string (returns cellstr)
              %5q reads up to 5 non-quote characters or until whitespace
         %c - read character or whitespace (returns char array)
              %5c reads up to 5 characters including whitespace
         %[...]  - reads characters matching characters between the
                   brackets until first non-matching character or
                   whitespace (returns cellstr)
                   use %[]...] to include ]
              %5[...] reads up to 5 characters
         %[^...] - reads characters not matching characters between the
                   brackets until first matching character or whitespace
                   (returns cellstr)
                   use %[^]...] to exclude ]
              %5[^...] reads up to 5 characters
 
     Note: Format strings are interpreted as with sprintf before parsing.
     For example, textread('mydata.dat','%s\t') will search for a tab not
     the character '\' followed by the character 't'.  See the Language
     Reference Guide or a C manual for complete details.
 
     Using %* instead of % in a conversion causes TEXTREAD to skip the
     matching characters in the input (and no output is created for this
     conversion).  The % can be followed by an optional field width to
     handle fixed width fields. For example %5d reads a 5 digit integer. In
     addition the %f format supports the form %<width>.<prec>f.
 
     USER CONFIGURABLE OPTIONS
 
     Possible param/value options are:
          'bufsize'      - maximum string length in bytes (default is 4095)
          'commentstyle' - one of 
               'matlab'  -- characters after % are ignored
               'shell'   -- characters after # are ignored
               'c'       -- characters between /* and */ are ignored
               'c++'    -- characters after // are ignored
          'delimiter'    - delimiter characters (default is none)
          'emptyvalue'   - empty cell value in delimited files (default is 0)
          'endofline'    - end of line character (default determined from file)
          'expchars'     - exponent characters (default is 'eEdD')
          'headerlines'  - number of lines at beginning of file to skip
          'whitespace'   - whitespace characters (default is ' \b\t')
     
     TEXTREAD is useful for reading text files with a known format.  Both
     fixed and free format files can be handled.
 
     Examples:
      Suppose the text file mydata.dat contains data in the following form:
         Sally    Type1 12.34 45 Yes
         Joe      Type2 23.54 60 No
         Bill     Type1 34.90 12 No
           
      Read each column into a variable
        [names,types,x,y,answer] = textread('mydata.dat','%s%s%f%d%s');
 
      Read first column into a cell array (skipping rest of line)
        [names]=textread('mydata.dat','%s%*[^\n]')
 
      Read first character into char array (skipping rest of line)
        [initials]=textread('mydata.dat','%c%*[^\n]')
 
      Read file as a fixed format file while skipping the doubles
        [names,types,y,answer] = textread('mydata.dat','%9c%5s%*f%2d%3s');
 
      Read file and match Type literal
        [names,typenum,x,y,answer]=textread('mydata.dat','%sType%d%f%d%s');
 
      Read m-file into cell array of strings
        file = textread('fft.m','%s','delimiter','\n','whitespace','');
 
      To read all numeric data from a delimited text file, use a single output
      argument, empty format string, and the appropriate delimiter. For 
      example, suppose data.csv contains:
        1,2,3,4
        5,6,7,8
        9,10,11,12
 
      Read the whole matrix into a single variable:
        [data] = textread('data.csv','','delimiter',',');
 
      Read the first two columns into two variables:
        [col1, col2] = textread('data.csv','%n%n%*[^\n]','delimiter',',');
 
      For files with empty cells, use the emptyvalue parameter.  Suppose
      data.csv contains:
        1,2,3,4,,6
        7,8,9,,11,12
 
      Read the file like this, using NaN in empty cells:
        [data] = textread('data.csv','','delimiter',',','emptyvalue',NaN);
 
      
    See also DLMREAD, LOAD, STRREAD, SSCANF, XLSREAD.
</PRE>
</P>
<P>
<A name = "uigetfolder"><H2>uigetfolder</H2></A>
<PRE>
  UIGETFOLDER   Standard Windows browse for folder dialog box.
 
    folder = uigetfolder(title, initial_path)
 
    Output: folder       = selected folder (empty string if dialog cancelled)
    Inputs: title        = title string (OPTIONAL)
            initial_path = initial path (OPTIONAL, defaults to PWD)
 
    Examples:   folder = <a href = "#uigetfolder">uigetfolder</a>                          - default title and initial path
                folder = uigetfolder('Select results folder') - default initial path
                folder = uigetfolder([], 'C:\Program Files')  - default title
 
    See also UIGETFILE, UIPUTFILE
</PRE>
</P>
<P>
<A name = "xRot"><H2>xRot</H2></A>
<PRE>
  <a href = "#xRot">xRot</a> - Compute a rotation matrix for rotation about the x-axis.
 
  Usage : xRotationMatrix = xRot(Angle)
</PRE>
</P>
<P>
<A name = "yRot"><H2>yRot</H2></A>
<PRE>
  <a href = "#yRot">yRot</a> - Compute a rotation matrix for rotation about the y-axis.
 
  Usage : yRotationMatrix = yRot(Angle)
</PRE>
</P>
<P>
<A name = "zArrayTrace"><H2>zArrayTrace</H2></A>
<PRE>
  <a href = "#zArrayTrace">zArrayTrace</a> - Performs tracing of large numbers of rays in ZEMAX.
 
  RayDataOut = zArrayTrace(RayDataIn);
  or
  RayDataOut = zArrayTrace(RayDataIn, Timeout);
 
  Timeout is the amount of time in milliseconds to give ZEMAX to finish raytracing before the command times out.
  RayDataIn and RayDataOut are structures with the following fields : x, y, z, l, m, n, Exr, Exi,
  Eyr, Eyi, Ezr, Ezi, wave, error, vigcode, want_opd.
 
  Only non-zero fields of RayDataIn need be set. RayDataOut will be returned with all fields.
  If the command times out, an error message is generated.
 
  There are 5 modes of raytracing documented in the "Tracing Large numbers of rays" section of the
  chapter on "ZEMAX Extensions" in the ZEMAX manual. Usage of <a href = "#zArrayTrace">zArrayTrace</a> is exactly as documented
  there with the following exception. <A href = "http://www.mathworks.com">Matlab</A> uses arrays starting at index 1 whereas C starts at
  index 0. Any references to RayData[0] in C will therefore apply to RayDataIn(1) in <A href = "http://www.mathworks.com">Matlab</A>.
 
  The first element of the RayDataIn structure determines which mode of raytracing is selected. The
  modes can be summarised as follows.
 
  Mode 0 : Trace ray from fractional field coordinates hx, hy to fractional pupil coordinates px, py.
  The fields of the first element are set as follows :
    RayDataIn(1).opd = 0;  % Sets mode 0 - actually no need to set any fields that are zero.
    RayDataIn(1).wave = raytracingmode; % Set to 0 for real rays, set to 1 for paraxial rays. 
    RayDataIn(1).error = numberofrays;  % This MUST be set to the number of rays to be traced.
    RayDataIn(1).want_opd = finalsurface; % Last surface to which rays must be traced. Use -1 for image.
  Then for ray number i, fill in the following data :
    RayDataIn(i+1).x = hx; % Fractional field coordinates
    RayDataIn(i+1).y = hy;
    RayDataIn(i+1).z = px; % Fractional pupil coordinates
    RayDataIn(i+1).l = py;
    RayDataIn(i+1).intensity = 1.0;  % Initial intensity of the ray
    RayDataIn(i+1).wave = wavenumer; % The wavelength number to use for raytracing
    RayDataIn(i+1).want_opd = opdrequest; % Set to 0 for no OPD calculations, set to 1 for OPD calculations.
  Consult the ZEMAX manual for further details.
 
  Mode 1 : Trace a ray from a given point in a given direction.
  The fields of the first element are set as follows :
    RayDataIn(1).opd = 1;  % Sets mode 1.
    RayDataIn(1).wave = raytracingmode; % Set to 0 for real rays, set to 1 for paraxial rays. 
    RayDataIn(1).error = numberofrays;  % This MUST be set to the number of rays to be traced.
    RayDataIn(1).vigcode = startsurface % First surface, and surface on which the given coordinates start.
    RayDataIn(1).want_opd = finalsurface; % Last surface to which rays must be traced. Use -1 for image.
  Then for ray number i, fill in the following data :
    RayDataIn(i+1).x = x; % Local coordinates from which the ray is launched at given surface.
    RayDataIn(i+1).y = y;
    RayDataIn(i+1).z = z.
    RayDataIn(i+1).l = l; % Direction cosines of the ray launch.
    RayDataIn(i+1).m = m;
    RayDataIn(i+1).n = n;
    RayDataIn(i+1).intensity = 1.0;  % Initial intensity of the ray
    RayDataIn(i+1).wave = wavenumer; % The wavelength number to use for raytracing
    RayDataIn(i+1).want_opd = opdrequest; % Set to 0 for no OPD calculations, set to 1 for OPD calculations.
  Consult the ZEMAX manual for further details.
  
  Mode 2 : Trace a ray from fractional field coordinates hx, hy to fractional pupil coordinates px, py, and compute
  state of polarisation.
  The fields of the first element are set as follows :
    RayDataIn(1).x = Ex;   % Electric field amplitude in x
    RayDataIn(1).y = Ey;   % Electric field amplitude in y 
    RayDataIn(1).z = Phax; % Phase in degrees for Ex 
    RayDataIn(1).l = Phay; % Phase in degrees for Ey 
    RayDataIn(1).opd = 2;  % sets mode 2 
    RayDataIn(1).wave = raytracingmode; % 0 for real rays, 1 for paraxial rays 
    RayDataIn(1).error = numrays;       % This MUST be set to the number of rays to be traced.
    RayDataIn(1).want_opd = lastsurf;   % -1 for image, or any valid surface number 
  Then for ray number i, fill in the following data :
    RayDataIn(i+1).x = hx; % Fractional Field coordinates
    RayDataIn(i+1).y = hy; 
    RayDataIn(i+1).z = px; % Fractional Pupil coordinates
    RayDataIn(i+1).l = py;
    RayDataIn(i+1).intensity = 1.0; % Initial intensity 
    RayDataIn(i+1).Exr = Exr % Electric field X real 
    RayDataIn(i+1).Exi = Exi % Electric field X imaginary 
    RayDataIn(i+1).Eyr = Eyr % Electric field Y real 
    RayDataIn(i+1).Eyi = Eyi % Electric field Y imaginary 
    RayDataIn(i+1).Ezr = Ezr % Electric field Z real 
    RayDataIn(i+1).Ezi = Ezi % Electric field Z imaginary 
    RayDataIn(i+1).wave = wavenumber;
  See the ZEMAX Manual for further details.
 
  Mode 3 : Trace a ray from a given point in a given direction and compute state of polarisation.
  The fields of the first element are set as follows :
    RayDataIn(1).x = Ex; % Electric field amplitude in x  
    RayDataIn(1).y = Ey; % Electric field amplitude in y  
    RayDataIn(1).z = Phax; % Phase in degrees for Ex  
    RayDataIn(1).l = Phay; % Phase in degrees for Ey  
    RayDataIn(1).opd = 3; % sets mode 3  
    RayDataIn(1).wave = mode; % 0 for real rays, 1 for paraxial rays  
    RayDataIn(1).error = numrays; % This MUST be set to the number of rays to be traced.
    RayDataIn(1).vigcode = startsurf; % the surface on which the coordinates start  
    RayDataIn(1).want_opd = lastsurf; % -1 for image, or any valid surface number
  Then for ray number i, fill in the following data :
    RayDataIn(i+1).x = x; % Ray starting point coordinates
    RayDataIn(i+1).y = y;
    RayDataIn(i+1).z = z;
    RayDataIn(i+1).l = l; % Ray starting direction
    RayDataIn(i+1).m = m;
    RayDataIn(i+1).n = n;
    RayDataIn(i+1).intensity = 1.0; % initial intensity  
    RayDataIn(i+1).Exr = Exr % Electric field X real  
    RayDataIn(i+1).Exi = Exi % Electric field X imaginary  
    RayDataIn(i+1).Eyr = Eyr % Electric field Y real  
    RayDataIn(i+1).Eyi = Eyi % Electric field Y imaginary  
    RayDataIn(i+1).Ezr = Ezr % Electric field Z real  
    RayDataIn(i+1).Ezi = Ezi % Electric field Z imaginary  
    RayDataIn(i+1).wave = wavenumber;
  See the ZEMAX Manual for further details.
 
  Currently there is no mode 4.
 
  Mode 5 : Tracing of a single ray in a non-sequential group of objects.
  The fields of the first element are set as follows :
    RayDataIn(1).x = x; % Starting x coordinate  
    RayDataIn(1).y = y; % Starting y coordinate  
    RayDataIn(1).z = z; % Starting z coordinate  
    RayDataIn(1).l = l; % Starting x direction cosine  
    RayDataIn(1).m = m; % Starting y direction cosine  
    RayDataIn(1).n = n; % Starting z direction cosine  
    RayDataIn(1).opd = 5+nMaxSegments; % sets mode 5, see ZEMAX Manual for further details.
    RayDataIn(1).intensity = 1.0; % initial intensity  
    RayDataIn(1).Exr = Exr; % initial E field if doing pol ray tracing, otherwise 0.0
    RayDataIn(1).Exi = Exi;
    RayDataIn(1).Eyr = Eyr;
    RayDataIn(1).Eyi = Eyi;
    RayDataIn(1).Ezr = Ezr;
    RayDataIn(1).Ezi = Ezi;
    RayDataIn(1).wave = wavenumber; % wavelength number, use 0 for randomly selected by weight  
    RayDataIn(1).error = NSCGroup; % NSC group surface, 1 if the program mode is NSC  
    RayDataIn(1).vigcode = PolSplitScatter; % controls polarization, split, and scatter  
    RayDataIn(1).want_opd = Object; % The inside of flag, use 0 if ray is not inside anything  
  The integer vigcode value determines if polarization ray tracing, splitting, and scattering are to be used. To
  determine the vigcode value, use 0 for no polarization, 1 for polarization, plus 2 if splitting is used, plus 4 if
  scattering is used. The resulting integer will be between 0 and 7 inclusive. Note if ray splitting is to be used,
  polarization must be used as well.
 
  Note : For all modes, be sure to fill in the "error" field correctly (number of rays) for the first element. 
  Although <a href = "#zArrayTrace">zArrayTrace</a> provides some protection, failure to do so can cause <A href = "http://www.mathworks.com">Matlab</A> to report a 
  Segmentation Violation or to crash.
 
  See also <a href = "#zGetTrace">zGetTrace</a>, <a href = "#zGetTraceDirect">zGetTraceDirect</a>, <a href = "#zGetPolTrace">zGetPolTrace</a>, <a href = "#zGetPolTraceDirect">zGetPolTraceDirect</a>.
</PRE>
</P>
<P>
<A name = "zDDEBusy"><H2>zDDEBusy</H2></A>
<PRE>
  <a href = "#zDDEBusy">zDDEBusy</a> - Checks to see if the ZEMAX DDE server is still busy with a function.
 
  Usage example : while (zDDEBusy) end;
 
  Will return immediately with the value 0 if the ZEMAX DDE server is available
  Returns 1 after the DDE timeout period if the server is busy.;
 
  See also : <a href = "#zSetTimeout">zSetTimeout</a>, <a href = "#zGetTimeout">zGetTimeout</a>
 
</PRE>
</P>
<P>
<A name = "zDDEClose"><H2>zDDEClose</H2></A>
<PRE>
  <a href = "#zDDEClose">zDDEClose</a> - Close the DDEchannel to ZEMAX.
 
  Usage : Reply = <a href = "#zDDEClose">zDDEClose</a>
  Returns zero on success.
 
</PRE>
</P>
<P>
<A name = "zDDEInit"><H2>zDDEInit</H2></A>
<PRE>
  <a href = "#zDDEInit">zDDEInit</a> - Establish DDE link with the Zemax server.
 
  Usage : Status = <a href = "#zDDEInit">zDDEInit</a>
 
  Returns 0 if a DDE channel to ZEMAX was opened successfully. If not, -1
  is returned. If ZEMAX is not running, -1 will be returned.
  This function also sets the timeout value for all ZEMAX DDE calls to 3 seconds.
 
  See also <a href = "#zDDEClose">zDDEClose</a>, <a href = "#zDDEStart">zDDEStart</a>, <a href = "#zSetTimeout">zSetTimeout</a>
 
</PRE>
</P>
<P>
<A name = "zDDEStart"><H2>zDDEStart</H2></A>
<PRE>
  <a href = "#zDDEStart">zDDEStart</a> - Establish DDE link with the Zemax server. If no ZEMAX running,
  find and start ZEMAX.
 
  Usage : Status = <a href = "#zDDEStart">zDDEStart</a>
 
  Returns 0 if a DDE channel to ZEMAX was opened successfully. If not, -1
  is returned. If ZEMAX is not running, an attempt will be made to find and
  start ZEMAX. Failure will return -1.
 
  Using this function may open a redundant DOS command window.
 
  This function also sets the timeout for all ZEMAX DDE calls to 3 seconds.
 
  See also <a href = "#zDDEClose">zDDEClose</a>, <a href = "#zDDEInit">zDDEInit</a>
 
</PRE>
</P>
<P>
<A name = "zDeleteSurface"><H2>zDeleteSurface</H2></A>
<PRE>
  <a href = "#zDeleteSurface">zDeleteSurface</a> - Delete a lens surface in the ZEMAX DDE server.
 
  Usage : Status = zDeleteSurface(SurfaceNumber)
  
  Deletes the given surface number. Returns 0 for success or -998 if the command
  times out. Attempts to delete non-existant surfaces will also return 0.
  See also <a href = "#zInsertSurface">zInsertSurface</a>
 
</PRE>
</P>
<P>
<A name = "zExportCAD"><H2>zExportCAD</H2></A>
<PRE>
  <a href = "#zExportCAD">zExportCAD</a> - Request Zemax DDE Server to export lens data in CAD (IGES, STEP or SAT) format.
 
  zExportCAD(filename,filetype,numspline,first,last,rayslayer,lenslayer,exportdummy,
  usesolids,raypattern,numrays,wave,field,deletevignetted,dummythick,split,scatter,usepol)
 
  filename    : Name of file to write.
  filetype    : The file type. Use 0 for IGES, 1 for STEP, 2 for SAT, and 3 for BDF.
  numspline   : The number of spline points to use (if required on certain entity types).
  first       : The First surface to export.
  last        : The last surface to export.
  rayslayer   : The layer to place ray data on.
  lenslayer   : The layer to place lens data on.
  exportdummy : Use 1 to export dummy surfaces, otherwise use 0.
  usesolids   : Use 1 to export surfaces as solids, otherwise use 0.
  raypattern  : The ray pattern. Use 0 for XY, 1 for X, 2 for Y, 3 for ring, 4 for list, 5 for none.
  numrays     : The number of rays.
  wave        : The wave number. Use 0 for all.
  field       : The field number. Use 0 for all.
  deletevignetted : Use 1 to delete vignetted rays, otherwise use 0.
  dummythick  : The dummy surface thickness in lens units.
  split       : Use 1 to split rays from NSC sources, otherwise use 0.
  scatter     : Use 1 to scatter rays from NSC sources, otherwise use 0.
  usepol      : Use 1 to use polarization when tracing NSC rays, otherwise use 0. Polarization is automatically 
                selected if splitting is specified.
 
  There is a complexity in using this feature via DDE. The export of lens data may take a long time relative to
  the timeout interval of the DDE communication. Therefore, calling this data item will cause ZEMAX to launch an
  independent thread to process the request. Once the thread is launched, the return value is the string "Exporting
  filename". However, the actual file may take many seconds or minutes to be ready to use. To verify that the export
  is complete and the file is ready, use the <a href = "#zExportCheck">zExportCheck</a> data item. <a href = "#zExportCheck">zExportCheck</a> will return 1 if the export is still
  running, or 0 if it has completed. Generally, the <a href = "#zExportCheck">zExportCheck</a> function call will need to be placed in a loop which
  executes until <a href = "#zExportCheck">zExportCheck</a> returns 0. A typical loop test in MATLAB might look like this:
 
  while zexportcheck, end;
 
  If zExportCad returns "BUSY!" then the export thread is already running from a previous request, and the export
  will not be performed.
 
</PRE>
</P>
<P>
<A name = "zExportCheck"><H2>zExportCheck</H2></A>
<PRE>
  <a href = "#zExportCheck">zExportCheck</a> - Checks whether Zemax DDE server is still busy exporting CAD data.
  
  The return value is 1 if still running, otherwise 0. A return value of -998 indicates that the command has timed out.
  Example :
  while <a href = "#zExportCheck">zExportCheck</a>, end;
 
  This will cause MATLAB to loop indefinitely until the CAD export is completed.
 
  See <a href = "#zExportCAD">zExportCAD</a>.
 
</PRE>
</P>
<P>
<A name = "zFindLabel"><H2>zFindLabel</H2></A>
<PRE>
  <a href = "#zFindLabel">zFindLabel</a> - Finds a previously labeled surface in the Zemax DDE client lens.
 
  Example : 
  LabeledSurface = zFindLabel(10)
 
  Finds the surface number which was labeled number 10 using the <a href = "#zSetLabel">zSetLabel</a> function.
 
  The returned value is the surface number of the first surface with the identical integer label, or -1 
  if no surface has the specified label. A return value of NaN (Not-a-Number) indicates that the command has timed out.
 
  See also <a href = "#zSetLabel">zSetLabel</a> and <a href = "#zGetLabel">zGetLabel</a>.
 
</PRE>
</P>
<P>
<A name = "zFixAllSurfaceData"><H2>zFixAllSurfaceData</H2></A>
<PRE>
  <a href = "#zFixAllSurfaceData">zFixAllSurfaceData</a> - Fixes lens data for listed surfaces.
 
  Usage : Reply = zFixAllSurfaceData(Surfaces)
  
  Sets curvature, thickness, glass, semi-diameter and all parameters to 'fixed' mode for the surface numbers given in
  the vector Surfaces.
 
  To fix all lens data (excluding extra data) use zFixAllSurfaceData(0:zNumSurfs)
  See also : <a href = "#zFixSurfaceData">zFixSurfaceData</a>, <a href = "#zSetSolve">zSetSolve</a>
 
</PRE>
</P>
<P>
<A name = "zFixSurfaceData"><H2>zFixSurfaceData</H2></A>
<PRE>
  <a href = "#zFixSurfaceData">zFixSurfaceData</a> - Make lens surface data fixed.
 
  Usage : Reply = zFixSurfaceData(Surfaces, Codes)
 
  Surfaces is a vector of numbers of surfaces which should be fixed. Code is the surface parameter which should be made
  fixed. The codes are the same as for the <a href = "#zSetSolve">zSetSolve</a> function as follows :
 
   ------------------------|------------------------------------------------|
   <a href = "#zSetSolve">zSetSolve</a> Code         -|- Returned data format                          |
   ------------------------|------------------------------------------------|
   0, curvature           -|- solvetype, parameter1, parameter2             |
   1, thickness           -|- solvetype, parameter1, parameter2, parameter3 |
   2, glass               -|- solvetype, pickupsurf                         |
   3, semi-diameter       -|- solvetype, pickupsurf                         |
   4, conic               -|- solvetype, pickupsurf                         |
   5-12, parameters 1-8   -|- solvetype, pickupsurf, offset, scalefactor    |
   1001+, extra data values|- solvetype, pickupsurf, scalefactor            |
  -------------------------|------------------------------------------------|
  
  e.g. zFixSurfaceData(1:4, 0:2) will set curvatures, thicknesses and glasses for surfaces 1 to 4 to fixed mode.
  
  See also : <a href = "#zSetSolve">zSetSolve</a>, <a href = "#zFixAllSurfaceData">zFixAllSurfaceData</a>
 
</PRE>
</P>
<P>
<A name = "zGetAddress"><H2>zGetAddress</H2></A>
<PRE>
  <a href = "#zGetAddress">zGetAddress</a> - Requests the address information from the Zemax DDE Server. The address is set in Zemax
                in the Preferences/Address dialog. Specify the line you want (1 to 5).
 
  Usage : AddressLine = zGetAddress(AddressLineNumer)
 
</PRE>
</P>
<P>
<A name = "zGetAperture"><H2>zGetAperture</H2></A>
<PRE>
  <a href = "#zGetAperture">zGetAperture</a> - Requests information on a surface aperture from the Zemax DDE server.
 
  zGetAperture(SurfaceNumber)
 
  Returns a row vector containing aperture type, min, max, xdecenter, ydecenter.
  This function returns the type as an integer code; 0 for no aperture, 1 for circular aperture, 2 for circular
  obscuration, 3 for spider, 4 for rectangular aperture, 5 for rectangular obscuration, 6 for elliptical aperture, 7 for
  elliptical obscuration, 8 for user defined aperture, 9 for user defined obscuration, and 10 for floating aperture. The
  min and max values have different meanings for the elliptical, rectangular, and spider apertures than for circular
  apertures; see the Editors Menu chapter in the Zemax Manual for details. 
 
  See also <a href = "#zSetAperture">zSetAperture</a>.
 
</PRE>
</P>
<P>
<A name = "zGetAspect"><H2>zGetAspect</H2></A>
<PRE>
  <a href = "#zGetAspect">zGetAspect</a> - Returns the aspect ratio of a Zemax graphics or print window.
 
  zGetAspect(FileName)
 
  where filename is the name of the temporary file associated with the window being created or updated. If the
  temporary file name is the empty string ''; then the default aspect ratio and width (or height) is returned.
 
  This function extracts the graphic display aspect ratio and the width or height of the printed page in current lens
  units. For example, If the current aspect ratio is 3 x 4, the aspect ratio returned will be 0.75. Knowing the correct
  aspect ratio is required when drawing isometric plots. The format of the returned row vector is aspect, width. If the aspect
  ratio is greater than 1, then the plot is taller than it is wide, and the format of returned row vector is aspect, height.
  
  See Also : <a href = "#zMakeGraphicWindow">zMakeGraphicWindow</a>, <a href = "#zMakeTextWindow">zMakeTextWindow</a>
 
</PRE>
</P>
<P>
<A name = "zGetBuffer"><H2>zGetBuffer</H2></A>
<PRE>
  <a href = "#zGetBuffer">zGetBuffer</a>  - Retrieve Zemax DDE client specific data from a window being updated
 
  zGetBuffer(n,TempFile)
  where n is the buffer number, which must be between 0 and 15 inclusive; and TempFile is the name of the
  temporary file for the window being updated. The tempfile name is passed to the client when ZEMAX calls the
  client; see the discussion "How ZEMAX calls the client" in the ZEMAX manual. Note each window may have its 
  own buffer data, and ZEMAX uses the filename to identify the window for which the buffer contents are required. 
 
  The buffer data is returned in an unscanned string.
 
  See also <a href = "#zSetBuffer">zSetBuffer</a>.
 
</PRE>
</P>
<P>
<A name = "zGetCoatings"><H2>zGetCoatings</H2></A>
<PRE>
  <a href = "#zGetCoatings">zGetCoatings</a> - Get a list of available coatings from the ZEMAX coatings.dat file
 
  Usage : CoatingList = <a href = "#zGetCoatings">zGetCoatings</a>
 
  Returns a cell array of all available coatings in the coatings.dat file.
 
</PRE>
</P>
<P>
<A name = "zGetComment"><H2>zGetComment</H2></A>
<PRE>
  <a href = "#zGetComment">zGetComment</a> - Requests comment for a Zemax surface number.
 
  zGetComment(SurfaceNumber)
 
  Returns a string.
 
</PRE>
</P>
<P>
<A name = "zGetConfig"><H2>zGetConfig</H2></A>
<PRE>
  <a href = "#zGetConfig">zGetConfig</a> - Requests basic lens configuration data from the Zemax DDE server.
 
  Usage : ConfigData = <a href = "#zGetConfig">zGetConfig</a>
  This function extracts the current configuration number and the number of configurations
  The returned row vector is formatted as follows: CurrentConfig, NumberConfig
 
</PRE>
</P>
<P>
<A name = "zGetDate"><H2>zGetDate</H2></A>
<PRE>
  <a href = "#zGetDate">zGetDate</a> - Requests current date from the Zemax DDE server.
  
  Usage : Date = <a href = "#zGetDate">zGetDate</a>
  <a href = "#zGetDate">zGetDate</a> returns a string.
 
</PRE>
</P>
<P>
<A name = "zGetExtra"><H2>zGetExtra</H2></A>
<PRE>
  <a href = "#zGetExtra">zGetExtra</a> - Requests extra data on a surface from the Zemax DDE server.
 
  zGetExtra(SurfaceNumber, ColumnNumer)
  Returns numeric data value for surface SurfaceNumber under column ColumnNumber.
 
  See also <a href = "#zSetExtra">zSetExtra</a>.
 
</PRE>
</P>
<P>
<A name = "zGetField"><H2>zGetField</H2></A>
<PRE>
  <a href = "#zGetField">zGetField</a> - Requests data on lens field points from the Zemax DDE server.
 
  Usage : FieldData = zGetField(FieldNumber)
  Returns a row vector for field point number FieldNumber. The vector contains xfield, yfield, weight, vdx, vdy, vcx, vcy, van.
  If the FieldNumber is given as 0, the data returned is a 2-element row vector containing type, number.
  The parameter type is an integer; either 0, 1, or 2, for angles in degrees, object height, or paraxial image height,
  respectively and 3 for real image height. The parameter number is the number of fields currently defined.
 
  See also <a href = "#zSetField">zSetField</a>, GetField.
 
</PRE>
</P>
<P>
<A name = "zGetFile"><H2>zGetFile</H2></A>
<PRE>
  <a href = "#zGetFile">zGetFile</a> - Requests the filename of the lens currently loaded into ZEMAX.
 
  Usage : LensFilePath = <a href = "#zGetFile">zGetFile</a>
  Returns the full drive, path and name.
 
  Extreme caution should be used if the file is to be tampered with,
  since at any time ZEMAX may read or write from/to this file.
 
</PRE>
</P>
<P>
<A name = "zGetFirst"><H2>zGetFirst</H2></A>
<PRE>
  <a href = "#zGetFirst">zGetFirst</a> - Requests first order operating data on current lens in ZEMAX.
 
  Usage : FirstOrderData = <a href = "#zGetFirst">zGetFirst</a>
  <a href = "#zGetFirst">zGetFirst</a> returns a numeric row vector having the following columns focal, pwfn, rwfn, pima, pmag.
  Values in the vector are the EFL, paraxial working F/#, real working F/#, paraxial image height, and paraxial
  magnification.
 
</PRE>
</P>
<P>
<A name = "zGetGlass"><H2>zGetGlass</H2></A>
<PRE>
  <a href = "#zGetGlass">zGetGlass</a> - Requests data on the glass at a lens surface from the Zemax DDE server.
 
  Usage : [GlassName,nd,vd,dpgf] = zGetGlass(SurfaceNumber)
  
  name is the glass name as a string, nd is the refractive index at the d line, vd is the Abbe dispersion and 
  dpgf is the relative partial dispersion. The last three are numeric.
 
  If the specified surface is not valid, is not made of glass, or is gradient index, the returned vector is empty.
  Data may be meaningless for glasses defined only outside of the FdC band.
 
</PRE>
</P>
<P>
<A name = "zGetGlassCats"><H2>zGetGlassCats</H2></A>
<PRE>
  <a href = "#zGetGlassCats">zGetGlassCats</a> - Get a list of available glass catalogs from the ZEMAX Glasscat directory.
 
  Usage : GlassCatList = <a href = "#zGetGlassCats">zGetGlassCats</a>
 
  Returns a cell array of all available glass catalogs in the glass catalog directory
 
</PRE>
</P>
<P>
<A name = "zGetGlobalMatrix"><H2>zGetGlobalMatrix</H2></A>
<PRE>
  <a href = "#zGetGlobalMatrix">zGetGlobalMatrix</a> - Requests global matrix transform for a lens surface.
 
  Usage : [RotationMatrix,ColVector] = zGetGlobalMatrix(SurfaceNumber)
 
  Returns the matrix required to convert any local coordinates (such as from a ray trace) into global
  coordinates. For details on the global coordinate matrix, see the section Global Coordinate Reference Surface
  in the System Menu chapter of the ZEMAX manual. Also returns the column vector which must be added
  to the rotated vector to yield the global coordinates.
 
  That is GlobalColVector = ColVector + RotationMatrix * LocalColVector
 
</PRE>
</P>
<P>
<A name = "zGetIndex"><H2>zGetIndex</H2></A>
<PRE>
  <a href = "#zGetIndex">zGetIndex</a> - Requests refractive index data on a lens surface in ZEMAX.
 
  Usage : IndexData = zGetIndex(SurfaceNumber)
  zGetIndex(SurfaceNumber) returns a numeric column vector having the following n1, n2, n3 ...
  where the index values correspond to the refractive index at each defined wavelength, in order.
 
  If the specified surface is not valid, or is gradient index, the returned vector is empty.
 
</PRE>
</P>
<P>
<A name = "zGetLabel"><H2>zGetLabel</H2></A>
<PRE>
  <a href = "#zGetLabel">zGetLabel</a> -  Retrieve the integer label attached to a surface in the ZEMAX lens.
 
  Usage : Label = zGetLabel(SurfaceNumber)
  The returned value is the label. A return value of NaN (Not-a-Number) indicates that the command has timed out.
  
  See also : <a href = "#zSetLabel">zSetLabel</a>, <a href = "#zFindLabel">zFindLabel</a>
 
</PRE>
</P>
<P>
<A name = "zGetMTF"><H2>zGetMTF</H2></A>
<PRE>
  zmxOTF = zGetMTF(DataFile, SettingsFile)
 
  Requests ZEMAX to compute the thru-frequency <a href = "#MTF">MTF</a> analysis for the current lens and configuration.
  The text data is written to Datafile, and the settings for the analysis are read from SettingsFile.
 
  The analysis is performed on the lens in the LDE.
 
  The data is returned as for <a href = "#ReadZemaxOTF">ReadZemaxOTF</a>.
</PRE>
</P>
<P>
<A name = "zGetMetaFile"><H2>zGetMetaFile</H2></A>
<PRE>
  <a href = "#zGetMetaFile">zGetMetaFile</a> -  Request ZEMAX to save a Windows Metafile of any ZEMAX graphical analysis plot.
 
  Usage : Reply = zGetMetaFile(MetaFileName, AnalysisType, SettingsFileName, Flag)
 
  The MetaFileName is the name of the file to be created including the full path, name, and extension for the metafile.
  The AnalysisType argument is a 3 character case-sensitive label that indicates the type of analysis to be performed.
  The 3 letter labels are identical to those used for the button bar in ZEMAX. A list of codes may be obtained by typing
  "help zemaxbuttons" at the <A href = "http://www.mathworks.com">Matlab</A> prompt. The labels are case sensitive. If no label is provided or
  recognized, a 3D Layout plot will be generated.
  If a valid file name is used for the "settingsfilename" argument, ZEMAX will use or save the settings used to
  compute the metafile graphic, depending upon the value of the flag parameter.
  If the flag value is 0, then the default settings will be used for the graphic.
  If the flag value is 1, then the settings provided in the settings file, if valid, will be used to generate the graphic.
  If the data in the settings file is in anyway invalid, then the default settings will be used to generate the graphic.
  If the flag value is 2, then the settings provided in the settings file, if valid, will be used and the settings box for
  the requested feature will be displayed. After the user makes any changes to the settings the graphic will then be
  generated using the new settings.
  No matter what the flag value is, if a valid file name is provided for the settingsfilename, the settings used will
  be written to the settings file, overwriting any data in the file.
  Only graphic, and not text files, are supported by <a href = "#zGetMetaFile">zGetMetaFile</a>.
 
  Returns the string 'OK' if the function completes within the timeout period, otherwise returns 0.
 
  NB : The analysis is performed on the lens in the LDE, not the lens in the DDE server.
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>, <a href = "#zOpenWindow">zOpenWindow</a>.
 
</PRE>
</P>
<P>
<A name = "zGetMulticon"><H2>zGetMulticon</H2></A>
<PRE>
  <a href = "#zGetMulticon">zGetMulticon</a> - Extract data from the ZEMAX multi-configuration editor.
 
  Usage : [OperandType, OperandValue, OperandData] = zGetMulticon(ConfigNumber, RowNumber)
 
  If ConfigNumber is greater than 1 and less than or equal to the number of configurations, the returned
  parameters are as follows :
  OperandType is the four letter operand type name as detailed in the 'Optimization/Optimization
  operands' section of the ZEMAX manual.
  OperandValue could be numeric or a string depending on OperandType. If OperandType is 'GLSS',
  'MOFF', 'MCOM', or 'COTN', then OperandValue is a string. Otherwise it is numeric.
  OperandData will be a row vector comprising NumberConfig and NumberRow which are the total number of 
  configs and rows in the multi-configuration editor.
  If the ConfigNumber is zero, the multicon operand type data is returned as follows:
  OperandType is the type as before
  OperandValue is zero and OperandData is a row vector comprising Number1, Number2, Number3
  These numbers are described in 'Summary of multi-configuration operands' in the ZEMAX manual.
 
  See also <a href = "#zSetMulticon">zSetMulticon</a>.
 
</PRE>
</P>
<P>
<A name = "zGetNSCData"><H2>zGetNSCData</H2></A>
<PRE>
  <a href = "#zGetNSCData">zGetNSCData</a> - Requests data for NSC groups present in ZEMAX.
 
  Usage : zGetNSCData(SurfaceNumber, Code)
  SurfaceNumber refers to the surface number of the NSC group, use 1 if the program mode is Non-Sequential. Currently
  only Code = 0 is supported, in which case the returned data is the number of objects in the NSC group.
</PRE>
</P>
<P>
<A name = "zGetNSCObjectData"><H2>zGetNSCObjectData</H2></A>
<PRE>
  <a href = "#zGetNSCObjectData">zGetNSCObjectData</a> - Requests various data for NSC objects from the ZEMAX DDE server.
 
  Usage : Datum = zGetNSCObjectData(Surface, Object, Code);
 
  Surface and Object refer to the surface number and object number. The Code is one of the integer values in the
  list below; the returned value is the data item indicated. 
 
  Code  -   Data returned
   0    -   Object type name. (string)
   1    -   Comment, which also defines the file name if the object is defined by a file. (string)
   2    -   Color. (integer)
   3    -   1 if object uses a user defined aperture file, 0 otherwise. (integer)
   4    -   User defined aperture file name, if any. (string)
   5    -   Reference object number. (integer)
   6    -   Inside of object number. (integer)
   7 and up Reserved for future expansion of this feature.
 
  See also <a href = "#zSetNSCObjectData">zSetNSCObjectData</a>, <a href = "#zSetNSCPosition">zSetNSCPosition</a>
 
</PRE>
</P>
<P>
<A name = "zGetNSCParameter"><H2>zGetNSCParameter</H2></A>
<PRE>
  <a href = "#zGetNSCParameter">zGetNSCParameter</a> - Requests parameter data for NSC objects present in ZEMAX.
 
  Usage : Parameter = zGetNSCParameter(SurfaceNumber, ObjectNumber, ParameterNumber)
  SurfaceNumber and ObjectNumber refer to the surface number and object number, and ParameterNumber is the 
  integer parameter number. The numerical parameter value is returned. If the command times out the value NaN is
  returned (Not-a-Number).
 
  See also <a href = "#zSetNSCParameter">zSetNSCParameter</a>
 
</PRE>
</P>
<P>
<A name = "zGetNSCPosition"><H2>zGetNSCPosition</H2></A>
<PRE>
  <a href = "#zGetNSCPosition">zGetNSCPosition</a> - Requests data on NSC object position from the ZEMAX DDE server.
 
  Usage : [PositionData, Material] = zGetNSCPosition(SurfaceNumber, ObjectNumber)
  
  SurfaceNumber and ObjectNumber refer to the surface number and object number. The returned data contains the following
  PositionData is a row vector with x, y, z, tilt-x, tilt-y, tilt-z
  Material is a string containing the name of the material.
 
  See also <a href = "#zSetNSCPosition">zSetNSCPosition</a>.
 
</PRE>
</P>
<P>
<A name = "zGetNSCSettings"><H2>zGetNSCSettings</H2></A>
<PRE>
  <a href = "#zGetNSCData">zGetNSCData</a> - Requests NSC settings from ZEMAX.
 
  Usage : NSCSettings = <a href = "#zGetNSCSettings">zGetNSCSettings</a>
  Returns a row vector of numerics in the following order
  MaxIntersections, MaxSegments, MaxNesting, MinAbsoluteIntensity, MinRelativeIntensity, GlueDistance, MissRayLength
  These items are the maximum number of ray intersections, segments, nesting level, minimum absolute intensity,
  minimum relative intensity, and glue distance used for NSC ray tracing.
 
  See also <a href = "#zSetNSCSettings">zSetNSCSettings</a>
 
</PRE>
</P>
<P>
<A name = "zGetName"><H2>zGetName</H2></A>
<PRE>
  <a href = "#zGetName">zGetName</a> - Get the name of the lens in ZEMAX.
 
  Usage : Name = <a href = "#zGetName">zGetName</a>
 
</PRE>
</P>
<P>
<A name = "zGetOperand"><H2>zGetOperand</H2></A>
<PRE>
  <a href = "#zGetOperand">zGetOperand</a> - Requests data from the Merit Function Editor in ZEMAX.
 
  Usage : OperandDatum = zGetOperand(Row, Column)
  Row is the operand row number in the Merit Function Editor. Column is 1 for type, 2 for int1, 3 for int2, 4-7 for
  hx-py, 8 for target, 9 for weight, 10 for value, and 11 for percent contribution. The returned datum is the numeric
  value of the requested parameter. All return types are numeric, including the operand type. If the command times out,
  NaN (Not-a-Number) is returned.
 
  For a list of type codes, type "help zemaxoperands" at the <A href = "http://www.mathworks.com">Matlab</A> prompt.
 
  See also <a href = "#zSetOperand">zSetOperand</a>.
 
</PRE>
</P>
<P>
<A name = "zGetOperandMatrix"><H2>zGetOperandMatrix</H2></A>
<PRE>
  <a href = "#zGetOperandMatrix">zGetOperandMatrix</a> - Uses a sequence of calls to <a href = "#zGetOperand">zGetOperand</a> until the entire Merit Function has been retrieved.
 
  Usage : OperandMatrix = <a href = "#zGetOperandMatrix">zGetOperandMatrix</a>
  Returns a matrix of 11 columns and as many rows as there are operands in the merit function. 
 
  See also <a href = "#zGetOperand">zGetOperand</a>
 
</PRE>
</P>
<P>
<A name = "zGetPath"><H2>zGetPath</H2></A>
<PRE>
  <a href = "#zGetPath">zGetPath</a> - Get the full path name to the directory where ZMEAX is installed.
 
  Usage : [ZEMAXPath, LensPath] = <a href = "#zGetPath">zGetPath</a>
 
  This item extracts the full path name to the directory where ZEMAX is installed, and the path name to the
  default directory for lenses.
  
</PRE>
</P>
<P>
<A name = "zGetPolState"><H2>zGetPolState</H2></A>
<PRE>
  <a href = "#zGetPolState">zGetPolState</a> - Gets the default polarization state set by the user.
 
  Usage : DefaultPolState = <a href = "#zGetPolState">zGetPolState</a>
  The row vector returned is formatted as follows:
  nIsPolarized, Ex, Ey, Phax, Phay
  If nIsPolarized is anything other than zero, then the default polarization state is unpolarized. Otherwise, the
  Ex, Ey, Phax, and Phay values are used to define the polarization state. Ex and Ey should each be normalized
  to a magnitude of unity, although this is not required. Phax and Phay are in degrees. 
 
  See also <a href = "#zSetPolState">zSetPolState</a>.
 
</PRE>
</P>
<P>
<A name = "zGetPolTrace"><H2>zGetPolTrace</H2></A>
<PRE>
  <a href = "#zGetPolTrace">zGetPolTrace</a> - This function is very similar to <a href = "#zGetTrace">zGetTrace</a>, with the added capability to trace polarized rays through the system.
 
  Usage : PolTraceData = zGetPolTrace(wave, mode, surf, hx, hy, px, py, Ex, Ey, Phax, Phay)
  The arguments are identical to <a href = "#zGetTrace">zGetTrace</a>, except for the additional Ex, Ey, Phax, and Phay arguments. Ex and
  Ey are the normalized electric field magnitudes in the x and y directions. The quantity Ex*Ex + Ey*Ey should have
  a value of 1.0 (with an important exception described below) although any values are accepted. Phax and Phay
  are the relative phase, in degrees.
  If Ex, Ey, Phax, and Phay are all zero, and only in this case, then ZEMAX assumes an "unpolarized" ray trace
  is required. An unpolarized ray trace actually requires ZEMAX to trace two orthogonal rays and the resulting
  transmitted intensity be averaged. If any of the four values are not zero, then a single polarized ray will be traced.
  For example, to trace the real unpolarized marginal ray to the image surface at wavelength 2, the call
  would be
  zGetPolTrace(2,0,-1,0.0,0.0,0.0,1.0,0,0,0,0)
  For polarized rays, the data comes back in the following row vector :
  error, intensity, Exr, Eyr, Ezr, Exi, Eyi, Ezi
  The integer error will be zero if the ray traced successfully, otherwise it will be a positive or negative number.
  If positive, then the ray missed the surface number indicated by error. If negative, then the ray total internal
  reflected (TIR) at the surface given by the absolute value of the error number. Always check to verify the ray data
  is valid before using the rest of the vector.
 
  The intensity will be the transmitted intensity. It is always normalized to an input electric field intensity of unity.
  The transmitted intensity accounts for surface, thin film, and bulk absorption effects, but does not consider
  whether or not the ray was vignetted. The Ex, Ey, and Ez values are the electric field components, with the r and
  i characters denoting the real and imaginary portions.
  For unpolarized rays, the returned row vector is simply:
  error, intensity
 
  See also <a href = "#zGetTrace">zGetTrace</a>, <a href = "#zGetTraceDirect">zGetTraceDirect</a>, <a href = "#zGetPolTraceDirect">zGetPolTraceDirect</a>
 
  Bugs : The intensity for an unpolarized raytrace seems to be in error sometimes. Average two
  polarized raytraces.
</PRE>
</P>
<P>
<A name = "zGetPolTraceDirect"><H2>zGetPolTraceDirect</H2></A>
<PRE>
  <a href = "#zGetPolTraceDirect">zGetPolTraceDirect</a> - Provides the same direct access to the ZEMAX ray tracing engine that GetTraceDirect
  does, and allows for polarized ray tracing as well.
 
  Usage : PolTraceData = zGetPolTraceDirect(wave, mode, startsurf, stopsurf, x, y, z, l, m, n, Ex, Ey, Phax, Phay)
  The data message comes back in the same format as described in GetPolTrace.
  x, y, z, l, m, n define the starting point and direction of the ray.
  The arguments are identical to <a href = "#zGetTraceDirect">zGetTraceDirect</a>, except for the additional Ex, Ey, Phax, and Phay arguments. Ex and
  Ey are the normalized electric field magnitudes in the x and y directions. The quantity Ex*Ex + Ey*Ey should have
  a value of 1.0 (with an important exception described below) although any values are accepted. Phax and Phay
  are the relative phase, in degrees.
  If Ex, Ey, Phax, and Phay are all zero, and only in this case, then ZEMAX assumes an "unpolarized" ray trace
  is required. An unpolarized ray trace actually requires ZEMAX to trace two orthogonal rays and the resulting
  transmitted intensity be averaged. If any of the four values are not zero, then a single polarized ray will be traced.
  For example, to trace the real unpolarized marginal ray to the image surface at wavelength 2, the call
  would be
  zGetPolTrace(2,0,-1,0.0,0.0,0.0,1.0,0,0,0,0)
  For polarized rays, the data comes back in the following row vector :
  error, intensity, Exr, Eyr, Ezr, Exi, Eyi, Ezi
  The integer error will be zero if the ray traced successfully, otherwise it will be a positive or negative number.
  If positive, then the ray missed the surface number indicated by error. If negative, then the ray total internal
  reflected (TIR) at the surface given by the absolute value of the error number. Always check to verify the ray data
  is valid before using the rest of the vector.
 
  The intensity will be the transmitted intensity. It is always normalized to an input electric field intensity of unity.
  The transmitted intensity accounts for surface, thin film, and bulk absorption effects, but does not consider
  whether or not the ray was vignetted. The Ex, Ey, and Ez values are the electric field components, with the r and
  i characters denoting the real and imaginary portions.
  For unpolarized rays, the returned row vector is simply:
  error, intensity
 
  See also <a href = "#zGetTrace">zGetTrace</a>, <a href = "#zGetTraceDirect">zGetTraceDirect</a>, <a href = "#zGetPolTrace">zGetPolTrace</a>
 
</PRE>
</P>
<P>
<A name = "zGetPupil"><H2>zGetPupil</H2></A>
<PRE>
  <a href = "#zGetPupil">zGetPupil</a> - Gets the aperture stop and pupil data from ZEMAX.
 
  Usage : PupilData = <a href = "#zGetPupil">zGetPupil</a>
  The returned row vector is formatted as follows:
  type, value, ENPD, ENPP, EXPD, EXPP, apodization_type, apodization_factor"
  The parameter type is an integer indicating the system aperture type, a number between 0 and 5, for entrance
  pupil diameter, image space F/#, object space NA, float by stop size, paraxial working F/#, or object cone angle,
  respectively. The value is the system aperture value, unless float by stop size is being used, in which case the
  value is the stop surface semi-diameter. The next 4 values are the entrance pupil diameter, entrance pupil
  position, exit pupil diameter, and exit pupil position, all in lens units. The apodization_type is an integer which is
  set to 0 for none, 1 for Gaussian, 2 for Tangential. The apodization_factor is the number shown on the general
  data dialog box.
 
</PRE>
</P>
<P>
<A name = "zGetRefresh"><H2>zGetRefresh</H2></A>
<PRE>
  <a href = "#zGetRefresh">zGetRefresh</a> - Copy lens data from lenseditor to the ZEMAX DDE server lens buffer.
 
  Usage : Status = <a href = "#zGetRefresh">zGetRefresh</a>
 
  This function causes ZEMAX to copy the lens data from the LDE into the stored copy of the server. The lens
  is then updated, which means ZEMAX recomputes all pupil positions, solves, and index data. If the lens can be
  updated, ZEMAX returns the value 0, otherwise, it returns -1. If the <a href = "#zGetUpdate">zGetUpdate</a> returns -1, no ray tracing can
  be performed. Returns -2 if the command times out.
  All subsequent commands will now affect or be executed upon the newly copied lens data. The old lens data,
  if any, cannot be recovered. 
 
  See also <a href = "#zGetUpdate">zGetUpdate</a> and <a href = "#zPushLens">zPushLens</a>.
 
</PRE>
</P>
<P>
<A name = "zGetSag"><H2>zGetSag</H2></A>
<PRE>
  <a href = "#zGetSag">zGetSag</a> - Returns the sag of any lens surface.
 
  Usage : SagData = zGetSag(SurfaceNumber, x, y)
  where SurfaceNumber is the surface number, and x and y are the coordinates on the surface for which 
  the sag is to be computed. The returned row vector is formatted as sag, alternatesag. 
  The values for x, y, and the sag are all in lens units.
 
</PRE>
</P>
<P>
<A name = "zGetSequence"><H2>zGetSequence</H2></A>
<PRE>
  <a href = "#zGetSequence">zGetSequence</a> - returns the sequence number of the lens in the Servers memory, then the sequence number of the
  lens in the LDE, as a row vector.
 
  Usage : SequenceNumbers = <a href = "#zGetSequence">zGetSequence</a>
  Each time a lens is changed, the sequence number is incremented. If a new lens is loaded, the sequence number is
  reset to zero.
 
  See also : <a href = "#zGetRefresh">zGetRefresh</a>, <a href = "#zPushLens">zPushLens</a>
 
</PRE>
</P>
<P>
<A name = "zGetSerial"><H2>zGetSerial</H2></A>
<PRE>
  <a href = "#zGetSerial">zGetSerial</a> - Returns the serial number of the ZEMAX harware lock.
 
  Usage : SerialNumber = <a href = "#zGetSerial">zGetSerial</a>
 
  Returns the serial number unless the command times out, in which case NaN (Not-a-Number) is returned.
</PRE>
</P>
<P>
<A name = "zGetSolve"><H2>zGetSolve</H2></A>
<PRE>
  <a href = "#zGetSolve">zGetSolve</a> - Requests data for solves and/or pickups on lens surfaces.
 
  Usage : SolveData = zGetSolve(Surface, Code)
 
  where Code is
  an integer code indicating which surface parameter the solve data is for. The solve data is returned in the following
  formats, depending upon the code value according to the following table.
  ------------------------|------------------------------------------------|
  <a href = "#zGetSolve">zGetSolve</a> Code         -|- Returned data format                          |
  ------------------------|------------------------------------------------|
  0, curvature           -|- solvetype, parameter1, parameter2             |
  1, thickness           -|- solvetype, parameter1, parameter2, parameter3 |
  2, glass               -|- solvetype, pickupsurf                         |
  3, semi-diameter       -|- solvetype, pickupsurf                         |
  4, conic               -|- solvetype, pickupsurf                         |
  5-12, parameters 1-8   -|- solvetype, pickupsurf, offset, scalefactor    |
  1001+, extra data values|- solvetype, pickupsurf, scalefactor            |
 -------------------------|------------------------------------------------|
  The solvetype is an integer code, and the parameters have meanings that depend upon the solve type; see
  the chapter "Solves" for details. The Introduction gives a summary for the various solve types.
 
  See also <a href = "#zSetSolve">zSetSolve</a>.
 
</PRE>
</P>
<P>
<A name = "zGetSurfaceDLL"><H2>zGetSurfaceDLL</H2></A>
<PRE>
  <a href = "#zGetSurfaceDLL">zGetSurfaceDLL</a> - extracts the name of the DLL if the surface is a user defined type.
 
  Usage : [DLLFilename, SurfaceName] = zGetSurfaceDLL(SurfaceNumber)
 
  The DLLFilename is the name of the defining DLL, the SurfaceName is the string displayed by the DLL in the surface
  type column of the Lens Data Editor.
   
</PRE>
</P>
<P>
<A name = "zGetSurfaceData"><H2>zGetSurfaceData</H2></A>
<PRE>
  <a href = "#zGetSurfaceData">zGetSurfaceData</a> - Gets various data on a sequential lens surface.
 
  Usage : SurfaceDatum = zGetSurfaceData(SurfaceNumber,Code)
  Returns a single numeric or string depending on the code according to the following table.
  Code      - Datum returned by <a href = "#zGetSurfaceData">zGetSurfaceData</a>
  0         - Surface type name. ( 8 character string)
  1         - Comment. (string)
  2         - Curvature (numeric).
  3         - Thickness. (numeric)
  4         - Glass. (string)
  5         - Semi-Diameter. (numeric)
  6         - Conic. (numeric)
  7         - Coating. (string)
  8 and up  - Reserved for future expansion of this feature.
 
  See also : zSetSurfData and <a href = "#ZemaxSurfTypes">ZemaxSurfTypes</a>
</PRE>
</P>
<P>
<A name = "zGetSurfaceParamMatrix"><H2>zGetSurfaceParamMatrix</H2></A>
<PRE>
  <a href = "#zGetSurfaceParamMatrix">zGetSurfaceParamMatrix</a> - Gets all parameter data for all surfaces.
 
  Usage : ParameterMatrix = <a href = "#zGetSurfaceParamMatrix">zGetSurfaceParamMatrix</a>
 
  Returns a matrix of all parameter values at all surfaces.
  Returns NaN (not-a-number) if a ZEMAX DDE timeout occurs.
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a>, <a href = "#zSetSurfaceParameter">zSetSurfaceParameter</a>, <a href = "#zGetSurfaceParamVector">zGetSurfaceParamVector</a>
 
</PRE>
</P>
<P>
<A name = "zGetSurfaceParamVector"><H2>zGetSurfaceParamVector</H2></A>
<PRE>
  <a href = "#zGetSurfaceParamVector">zGetSurfaceParamVector</a> - Gets all parameter data for a single surface.
 
  Usage : ParameterVector = zGetSurfaceParamVector(SurfaceNumber)
 
  Returns a row vector of all parameter values at surface number
  SurfaceNumber.
  Returns NaN (not-a-number) if a timeout occurs.
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a> and <a href = "#zSetSurfaceParameter">zSetSurfaceParameter</a>
 
</PRE>
</P>
<P>
<A name = "zGetSurfaceParameter"><H2>zGetSurfaceParameter</H2></A>
<PRE>
  <a href = "#zGetSurfaceParameter">zGetSurfaceParameter</a> - extracts surface parameter data.
 
  Usage : ParameterData = zGetSurfaceParameter(SurfaceNumber,ParameterNumber)
 
  For example, to get the parameter 5 data for surface 8, the call should be
  GetSurfaceParameter(8,5)
 
  Returns NaN (Not-a-Number) if the command times out.
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a> and <a href = "#zSetSurfaceParameter">zSetSurfaceParameter</a>
 
</PRE>
</P>
<P>
<A name = "zGetSystem"><H2>zGetSystem</H2></A>
<PRE>
  <a href = "#zGetSystem">zGetSystem</a> - Gets a number of lens system operating data.
 
  Usage : SystemData = <a href = "#zGetSystem">zGetSystem</a>
  The returned row vector  is formatted as follows:
  numsurfs, unitcode, stopsurf, nonaxialflag, rayaimingtype, useenvdata, temp, pressure, globalrefsurf
  This item returns the number of surfaces, the unit code (0, 1, 2, or 3 for mm, cm, in , or M), the stop surf number,
  a flag to indicate if the system is non-axial symmetric (0 for false, that is it is axial, or 1 if the system is not axial),
  the ray aiming type (0, 1, 2 for none, paraxial, real), the use environment data flag (0 for no, 1 for yes), the current
  temperature and pressure, and the global coordinate reference surface number.
 
  See also <a href = "#zSetSystem">zSetSystem</a> and <a href = "#zGetSystemAper">zGetSystemAper</a>
 
</PRE>
</P>
<P>
<A name = "zGetSystemAper"><H2>zGetSystemAper</H2></A>
<PRE>
  <a href = "#zGetSystemAper">zGetSystemAper</a> - Gets lens system aperture data.
 
  Usage : SystemApertureData = <a href = "#zGetSystemAper">zGetSystemAper</a>
  The returned row vector is formatted as follows:
  type, stopsurf, aperture_value
  This item returns the system aperture type (0, 1, 2, 3, 4, or 5 for Entrance Pupil Diameter, Image Space F/#,
  Object Space NA, Float by Stop Size, Paraxial Working F/#, or Object Cone Angle, respectively), the stop surface
  number, and the system aperture value. If the aperture type is Float by Stop Size, the aperture value is the stop
  surface semi-diameter.
  
  See also <a href = "#zGetSystem">zGetSystem</a> and <a href = "#zSetSystemAper">zSetSystemAper</a>
 
</PRE>
</P>
<P>
<A name = "zGetTextFile"><H2>zGetTextFile</H2></A>
<PRE>
  <a href = "#zGetTextFile">zGetTextFile</a> -  Request ZEMAX to save a text file for any analysis that supports text output.
 
  Usage : zGetTextFile(TextFileName, AnalysisType, SettingsFileName, Flag)
 
  The TextFileName is the name of the file to be created including the full path, name, and extension for the text file.
  The AnalysisType argument is a 3 character case-sensitive label that indicates the type of analysis to be performed.
  The 3 letter labels are identical to those used for the button bar in ZEMAX. A list of codes may be obtained by typing
  "help zemaxbuttons" at the <A href = "http://www.mathworks.com">Matlab</A> prompt. The labels are case sensitive. If no label is provided or
  recognized, a standard raytrace will be generated.
  If a valid file name is used for the "settingsfilename" argument, ZEMAX will use or save the settings used to
  compute the text file, depending upon the value of the flag parameter.
  If the flag value is 0, then the default settings will be used for the text.
  If the flag value is 1, then the settings provided in the settings file, if valid, will be used to generate the text.
  If the data in the settings file is in anyway invalid, then the default settings will be used to generate the text.
  If the flag value is 2, then the settings provided in the settings file, if valid, will be used and the settings box for
  the requested feature will be displayed. After the user makes any changes to the settings the text will then be
  generated using the new settings.
  No matter what the flag value is, if a valid file name is provided for the settingsfilename, the settings used will
  be written to the settings file, overwriting any data in the file.
  Only text, and not graphic files, are supported by <a href = "#zGetTextFile">zGetTextFile</a>.
 
  If the command has been completed within the timeout, the Reply is the string OK, otherwise the
  value 0 is returned.
 
  NB : The analysis is performed on the lens in the LDE, not the lens in the DDE server.
 
  See also <a href = "#zGetMetaFile">zGetMetaFile</a>, <a href = "#zOpenWindow">zOpenWindow</a>, <a href = "#ZemaxButtons">ZemaxButtons</a>
 
</PRE>
</P>
<P>
<A name = "zGetTimeout"><H2>zGetTimeout</H2></A>
<PRE>
  <a href = "#zGetTimeout">zGetTimeout</a> - Get the timeout in seconds for all ZEMAX DDE calls.
 
  Usage : Timeout = <a href = "#zGetTimeout">zGetTimeout</a>
  
  See also : <a href = "#zDDEInit">zDDEInit</a>, <a href = "#zDDEStart">zDDEStart</a>, <a href = "#zSetTimeout">zSetTimeout</a>
 
</PRE>
</P>
<P>
<A name = "zGetTol"><H2>zGetTol</H2></A>
<PRE>
  <a href = "#zGetTol">zGetTol</a> - Extracts lens tolerance data from the ZEMAX tolerance editor.
 
  Usage: [TolType, TolData] = zGetTol(TolNumber)
</PRE>
</P>
<P>
<A name = "zGetTolCount"><H2>zGetTolCount</H2></A>
<PRE>
  <a href = "#zGetTolCount">zGetTolCount</a> - Get the total number of tolerance operands in the current ZEMAX lens.
 
  Usage: TolCount = <a href = "#zGetTolCount">zGetTolCount</a>
 
  See also <a href = "#zGetTol">zGetTol</a>
 
</PRE>
</P>
<P>
<A name = "zGetTolMatrix"><H2>zGetTolMatrix</H2></A>
<PRE>
  <a href = "#zGetTolMatrix">zGetTolMatrix</a> - Extracts a matrix containing all tolerance data from the ZEMAX tolerance editor.
 
  Usage: [TolTypes, TolMatrix] = <a href = "#zGetTolMatrix">zGetTolMatrix</a>
 
  Retrieves all tolerance types in a column vector (TolTypes) of 4-letter mnemonics.
  TolMatrix is a matrix of tolerance parameters as defined for <a href = "#zGetTol">zGetTol</a>.
 
  See also <a href = "#zGetTolCount">zGetTolCount</a>, <a href = "#zGetTol">zGetTol</a>
 
</PRE>
</P>
<P>
<A name = "zGetTrace"><H2>zGetTrace</H2></A>
<PRE>
  <a href = "#zGetTrace">zGetTrace</a> - Trace a ray through the current lens in the ZEMAX DDE server. 
 
  Usage : RayTraceData = zGetTrace(wave, mode, surf, hx, hy, px, py)
 
  In order to trace a ray, ZEMAX needs to know the
  relative field and pupil coordinates, the wavelength, the mode (either real, mode = 0 or paraxial, mode = 1) as
  well as the surface to trace the ray to. 
  For example, to trace the real chief ray to surface 5 at wavelength 3, the call would be
  RayTraceData = zGetTrace(3,0,5,0.0,1.0,0.0,0.0);
  Usually, the ray data is only needed at the image surface; setting the surface
  number to -1 will yield data at the image surface. Note 0 is reserved for the object surface.
  The raytrace data message comes back in the following row vector:
  error, vigcode, x, y, z, l, m, n, l2, m2, n2, intensity
  The integer error will be zero if the ray traced successfully, otherwise it will be a positive or negative number.
  If positive, then the ray missed the surface number indicated by error. If negative, then the ray total internal
  reflected (TIR) at the surface given by the absolute value of the error number. Always check to verify the ray data
  is valid before using the rest of the vector.
  The parameter vigcode is the first surface where the ray was vignetted. Unless an error occurs at that surface
  or subsequent to that surface, the ray will continue to trace to the requested surface.
  The x, y, and z values are the coordinates on the requested surface.
  The l, m, and n values are the direction cosines after refraction into the media following the requested surface.
  The l2, m2, and n2 values are the surface intercept direction normals at the requested surface.
  The intensity is the relative transmitted intensity of the ray, including any pupil or surface apodization defined.
 
  See also <a href = "#zGetTraceDirect">zGetTraceDirect</a>, <a href = "#zGetPolTrace">zGetPolTrace</a>, <a href = "#zGetPolTraceDirect">zGetPolTraceDirect</a>
 
</PRE>
</P>
<P>
<A name = "zGetTraceDirect"><H2>zGetTraceDirect</H2></A>
<PRE>
  <a href = "#zGetTraceDirect">zGetTraceDirect</a> - Direct access raytrace through the current lens in the ZEMAX DDE server. 
 
  Usage : RayTraceData = zGetTraceDirect(wave, mode, startsurf, stopsurf, x, y, z, l, m, n)
 
  <a href = "#zGetTraceDirect">zGetTraceDirect</a> provides a more direct access to the ZEMAX ray tracing engine. Normally, rays are defined
  by the normalized field and pupil coordinates hx, hy, px, and py. ZEMAX takes these normalized coordinates and
  computes the object coordinates (x, y, and z) and the direction cosines to the entrance pupil aim point (l, m, and
  n; for the x-, y-, and z-direction cosines, respectively).
  However, there are times when it is more appropriate to trace rays by direct specification of x, y, z, l, m, and
  n. The direct specification has the added flexibility of defining the starting surface for the ray anywhere in the
  optical system. This flexibility comes at the price of requiring the client program to carefully ensure that the starting
  ray coordinates are meaningful.
  Like <a href = "#zGetTrace">zGetTrace</a>, this item requires that the client provide additional data. In order to trace a ray, ZEMAX needs
  to know x, y, z, l, m, n, the wavelength, the mode (either real, mode = 0 or paraxial, mode = 1) as well as the
  starting and stopping surfaces to trace the ray from and to. 
  The data vector comes back in the following format:
  error, vigcode, x, y, z, l, m, n, l2, m2, n2, intensity
  where the parameters are exactly the same as for <a href = "#zGetTrace">zGetTrace</a>, except for intensity. The intensity is the relative
  transmitted intensity of the ray, excluding any pupil apodization defined. Note <a href = "#zGetTrace">zGetTrace</a> includes pupil apodization,
  <a href = "#zGetTraceDirect">zGetTraceDirect</a> does not. Both include surface apodizations.
 
  See also <a href = "#zGetTrace">zGetTrace</a>, <a href = "#zGetPolTrace">zGetPolTrace</a>, <a href = "#zGetPolTraceDirect">zGetPolTraceDirect</a>
 
</PRE>
</P>
<P>
<A name = "zGetUpdate"><H2>zGetUpdate</H2></A>
<PRE>
  <a href = "#zGetUpdate">zGetUpdate</a> - Perform update on the current lens in the ZEMAX DDE buffer.
 
  Usage : Status = <a href = "#zGetUpdate">zGetUpdate</a>
 
  This function causes ZEMAX to update the lens, which means ZEMAX recomputes all pupil positions, solves,
  and index data. If the lens can be updated, ZEMAX returns the Status 0, otherwise, it returns -1. If the
  <a href = "#zGetUpdate">zGetUpdate</a> returns -1, no ray tracing can be performed. Returns -998 if the command times out.
 
  See also <a href = "#zGetRefresh">zGetRefresh</a> and <a href = "#zPushLens">zPushLens</a>.
 
</PRE>
</P>
<P>
<A name = "zGetVersion"><H2>zGetVersion</H2></A>
<PRE>
  <a href = "#zGetVersion">zGetVersion</a> - Get the current version of ZEMAX which is running.
 
  Usage : Version = <a href = "#zGetVersion">zGetVersion</a>
  Returns a numerical version number.
  Returns -998 if the command times out.
</PRE>
</P>
<P>
<A name = "zGetWave"><H2>zGetWave</H2></A>
<PRE>
  <a href = "#zGetWave">zGetWave</a> - Requests data on defined wavelengths from the Zemax DDE server.
 
  zGetWave(WaveNumber)
  Returns a row vector for wavelength number WaveNumber. The vector contains wavelength, weight
  If the WaveNumber is given as 0, the data returned is a 2-element row vector containing PrimaryWave, NumberWave
  where PrimaryWave is the primary wavelength number and NumberWave is the number of defined wavelengths.
 
  See also <a href = "#zSetWave">zSetWave</a>.
 
</PRE>
</P>
<P>
<A name = "zGetWaveMatrix"><H2>zGetWaveMatrix</H2></A>
<PRE>
  <a href = "#zGetWaveMatrix">zGetWaveMatrix</a> - Gets data on all defined wavelengths from the Zemax DDE server.
 
  Usage : WaveDataMatrix = <a href = "#zGetWaveMatrix">zGetWaveMatrix</a>
 
  Returns a matrix having colummns wavelength and weight for all defined wavelengths.
 
  See also <a href = "#zGetWave">zGetWave</a>, <a href = "#zSetWave">zSetWave</a>
 
</PRE>
</P>
<P>
<A name = "zImportExtraData"><H2>zImportExtraData</H2></A>
<PRE>
  <a href = "#zImportExtraData">zImportExtraData</a> - imports extra data and grid surface data values into an existing surface.
 
  Usage : Status = zImportExtraData(SurfaceNumber, FileName)
 
  This import function is used to load extra data values for extra data surfaces from an ASCII file rather than
  by typing the numbers in directly. SurfaceNumber specifies which surface number should
  receive the data. Numerical data must be in the ASCII file exactly as it appears in the extra data spreadsheet.
  The format of the ASCII file is a single column of free-format numbers, and the file should end in the DAT
  extension. 
  
  For details of the ASCII format for grid sag surfaces, see the Chapter on 'Surface Types' in the ZEMAX manual.
 
</PRE>
</P>
<P>
<A name = "zInsertSurface"><H2>zInsertSurface</H2></A>
<PRE>
  <a href = "#zInsertSurface">zInsertSurface</a> - Insert a lens surface in the ZEMAX DDE server.
 
  Usage : Status = zInsertSurface(SurfaceNumber)
  The new surface will be placed at the location indicated by the parameter surf. See also <a href = "#zSetSurfaceData">zSetSurfaceData</a> to define
  data for the new surface.
 
  See also <a href = "#zDeleteSurface">zDeleteSurface</a>
 
</PRE>
</P>
<P>
<A name = "zLoadFile"><H2>zLoadFile</H2></A>
<PRE>
  <a href = "#zLoadFile">zLoadFile</a> - Load a lens file into the ZEMAX DDE server.
 
  Usage : Status = zLoadFile(FileName)
 
  Note that loading a file does not change the data displayed in the LDE;
  the server process has a separate copy of the lens data. The file name to be loaded is appended to the LoadFile
  item name, and must include the full path. For example: zLoadFile('C:\ZEMAX\SAMPLES\COOKE.ZMX'). The
  returned value is the same as for the <a href = "#zGetUpdate">zGetUpdate</a> item; after updating the newly loaded lens file. If a value other
  than 0 is returned, the Update failed, if -999 is returned, the file could not be loaded. 
  If -998 is returned, the command timed out.
 
  See also <a href = "#zGetPath">zGetPath</a>, <a href = "#zSaveFile">zSaveFile</a>, <a href = "#zPushLens">zPushLens</a>, <a href = "#zuiLoadFile">zuiLoadFile</a>
 
</PRE>
</P>
<P>
<A name = "zLoadMerit"><H2>zLoadMerit</H2></A>
<PRE>
  <a href = "#zLoadMerit">zLoadMerit</a> - Load a merit function file into the ZEMAX DDE server.
 
  Usage : MeritData = zLoadMerit(FileName)
 
  Loads a ZEMAX .MF or .ZMX file and extracts the merit function and places it in the lens loaded in the server.
  Note that loading a merit function file does not change the data displayed in the LDE; the server process has a
  separate copy of the lens data. The file name must
  include the full path. For example: zLoadMerit('C:\ZEMAX\SAMPLES\MyMerit.MF'). The returned numeric vector is formatted
  as follows:
  number, merit
  where number is the number of operands in the merit function and merit is the value of the merit function. If
  the merit function value is 9.00e+009, the merit function cannot be evaluated.
 
  See also <a href = "#zOptimize">zOptimize</a>
 
</PRE>
</P>
<P>
<A name = "zMakeGraphicWindow"><H2>zMakeGraphicWindow</H2></A>
<PRE>
  <a href = "#zMakeGraphicWindow">zMakeGraphicWindow</a> -  notifies ZEMAX that graphic data has been written to a file and may now be displayed as a ZEMAX
  child window.
 
  Usage : Reply = zMakeGraphicWindow(FileName, ModuleName, WinTitle, TextFlag, SettingsData)
 
  The primary purpose of this item is to implement user defined features in a client application, that
  look and act like native ZEMAX features. 
  FileName is the full path and file name to the temporary file that holds the graphic data. This must be the
  same name as passed to the client executable in the command line arguments, if any. The ModuleName is the
  full path and executable name of the client program that created the graphic data. The WinTitle is the string which
  defines the title ZEMAX should place in the top bar of the window.
  The TextFlag should be 1 if the client can also generate a text version of the data. Since the current data is a
  graphic display (it must be if the call is to <a href = "#zMakeGraphicWindow">zMakeGraphicWindow</a>) ZEMAX wants to know if the "Text" menu option
  should be available to the user, or if it should be grayed out. If the text flag is 0, ZEMAX will gray out the "Text"
  menu option and will not attempt to ask the client to generate a text version of the data.
  The settings data is a string of values delimited by spaces (not commas) which are used by the client to define
  how the data was generated. These values are only used by the client, not by ZEMAX. The settings data string
  holds the options and data that would normally appear in a ZEMAX "settings" style dialog box. The settings data
  should be used to recreate the data if required. See "How ZEMAX calls the client" for details on the settings data.
  A sample call might look like this:
  zMakeGraphicWindow('C:\TEMP\ZGF001.TMP','C:\ZEMAX\FEATURES\CLIENT.EXE','ClientWindow',1, '0 1 2 12.55');
  This item indicates that ZEMAX should open a graphic window, display the data stored in the file
  C:\TEMP\ZGF001.TMP, and that any updates or setting changes can be made by calling the client module
  C:\ZEMAX\FEATURES\CLIENT.EXE. This client can generate a text version of the graphic, and the settings data
  string (used only by the client) is '0 1 2 12.55'.
 
</PRE>
</P>
<P>
<A name = "zMakeTextWindow"><H2>zMakeTextWindow</H2></A>
<PRE>
  <a href = "#zMakeTextWindow">zMakeTextWindow</a> -  notifies ZEMAX that text data has been written to a file and may now be displayed as a ZEMAX
  child window.
 
  Usage : Reply = zMakeTextWindow(FileName, ModuleName, WinTitle, SettingsData)
 
  The primary purpose of this item is to implement user defined features in a client application, that look
  and act like native ZEMAX features.
  The filename is the full path and file name to the temporary file that holds the text data. This must be the same
  name as passed to the client executable in the command line arguments, if any. The modulename is the full path
  and executable name of the client program that created the text data. The wintitle is the string which defines the
  title ZEMAX should place in the top bar of the window.
  The settingsdata is a string of values delimited by spaces (not commas) which are used by the client to define
  how the data was generated. These values are only used by the client, not by ZEMAX. The settingsdata string
  holds the options and data that would normally appear in a ZEMAX 'settings' style dialog box. The settingsdata
  should be used to recreate the data if required. See 'How ZEMAX calls the client' for details on the settingsdata.
  A sample function call might look like this:
  zMakeTextWindow('C:\TEMP\ZGF002.TMP','C:\ZEMAX\FEATURES\CLIENT.EXE','ClientWindow','6 5 4 12.55');
  This call indicates that ZEMAX should open a text window, display the data stored in the file
  C:\TEMP\ZGF002.TMP, and that any updates or setting changes can be made by calling the client module
  C:\ZEMAX\FEATURES\CLIENT.EXE. The settingsdata string (used only by the client) is '6 5 4 12.55'.
 
</PRE>
</P>
<P>
<A name = "zNewLens"><H2>zNewLens</H2></A>
<PRE>
  <a href = "#zNewLens">zNewLens</a> - Erases the current lens in the ZEMAX DDE server.
 
  Usage : Status = <a href = "#zNewLens">zNewLens</a>
 
  This function erases the current lens. The 'minimum' lens that remains is identical to the lens in the Lens Data
  Editor when 'File, New' is selected. No prompt to save the existing lens is given.
 
</PRE>
</P>
<P>
<A name = "zNumSurfs"><H2>zNumSurfs</H2></A>
<PRE>
  <a href = "#zNumSurfs">zNumSurfs</a> - Returns the number of surfaces in the current lens.
 
  Usage : NumSurfs = <a href = "#zNumSurfs">zNumSurfs</a>
 
  See also : <a href = "#zGetSystem">zGetSystem</a>, <a href = "#zsGetSystem">zsGetSystem</a>
 
</PRE>
</P>
<P>
<A name = "zOpenWindow"><H2>zOpenWindow</H2></A>
<PRE>
  <a href = "#zOpenWindow">zOpenWindow</a> - Request ZEMAX DDE server to open a new analysis window on the main ZEMAX screen. 
 
  Usage : Status = zOpenWindow(ButtonCode)
 
  The ButtonCode argument is a 3 character case-sensitive label that indicates the type of analysis to be performed.
  The 3 letter labels are identical to those used for the button bar in ZEMAX. A list of codes can be obtained
  by typing "help zemaxbuttons" in <A href = "http://www.mathworks.com">Matlab</A>. The labels are case sensitive. 
 
  NB : The analysis data appearing in the window is for the lens in the LDE, not the lens in the DDE
  server.
 
  See also <a href = "#zGetMetaFile">zGetMetaFile</a>.
 
</PRE>
</P>
<P>
<A name = "zOptimize"><H2>zOptimize</H2></A>
<PRE>
  <a href = "#zOptimize">zOptimize</a> - Optimize the lens in the ZEMAX DDE server.
 
  Usage : Merit = zOptimize(Cycles)
  <a href = "#zOptimize">zOptimize</a> calls the ZEMAX Damped Least Squares optimizer
  where Cycles is the number of cycles to run. The return value is the final merit function. If the merit function value
  returned is 9.0E+009, the optimization failed, usually because the lens or merit function could not be evaluated.
  If n is zero, the optimization runs in automatic mode. If n is less than zero, Optimize returns the current merit
  function, and no optimization is performed.
 
  Returns -1 if the optimisation did not complete within the timeout period.
 
</PRE>
</P>
<P>
<A name = "zPushLens"><H2>zPushLens</H2></A>
<PRE>
  <a href = "#zPushLens">zPushLens</a> - Copy lens in the ZEMAX DDE server into the Lens Data Editor (LDE).
 
  Usage : Status = zPushLens(Timeout)
  <a href = "#zPushLens">zPushLens</a> will take the lens currently loaded in the server's memory and push it into the Lens Data Editor.
  In older version of ZEMAX, a dialog box will appear from the ZEMAX main window asking the user for permission 
  to accept the lens data being pushed by the client. 
  More recent versions of ZEMAX will reject all <a href = "#zPushLens">zPushLens</a> attempts (return value -999) unless permission is
  granted via a checkbox on the Editors tab of the general ZEMAX preferences dialog.
  The client will wait Timeout seconds before returning a timeout error.
  If the lens data in the LDE has not been saved, an additional dialog box may appear asking
  if the old data should be saved first. The returned string is the same as for the <a href = "#zGetUpdate">zGetUpdate</a> function; after updating the
  newly pushed lens file. If a value other than 0 is returned, the Update failed, if -999 is returned, the lens could not
  be pushed into the LDE. If -998 is returned, the function timed out.
 
  See also <a href = "#zGetPath">zGetPath</a>, <a href = "#zGetRefresh">zGetRefresh</a>, <a href = "#zLoadFile">zLoadFile</a>, <a href = "#zGetUpdate">zGetUpdate</a> and <a href = "#zSaveFile">zSaveFile</a>.
 
</PRE>
</P>
<P>
<A name = "zReleaseWindow"><H2>zReleaseWindow</H2></A>
<PRE>
  <a href = "#zReleaseWindow">zReleaseWindow</a> - Release locked window.
 
  Usage : Status = zReleaseWindow(FileName)
  When ZEMAX calls the client to update or change the settings used by the client function, the menu bar is
  grayed out on the window to prevent multiple updates or setting changes from being requested simultaneously.
  Normally, when the client code sends the MakeTextWindow or MakeGraphicWindow, the menu bar is once again
  activated. However, if during an update or setting change, the new data cannot be computed, then the window
  must be released. The ReleaseWindow serves just this one simple purpose. If the user selects "Cancel" when
  changing the settings, the client code should send a ReleaseWindow item to release the lock out of the menu
  bar. If this command is not sent, the window cannot be closed, which will prevent ZEMAX from terminating
  normally. The ReleaseWindow item takes just one argument: the name of the temporary file.
  The return value is zero if no window is using the filename, or a positive integer number if the file is being used.
  A value of -998 is returned if the command times out.
</PRE>
</P>
<P>
<A name = "zRot"><H2>zRot</H2></A>
<PRE>
  <a href = "#zRot">zRot</a> - Compute a rotation matrix for rotation about the z-axis.
 
  Usage : zRotationMatrix = zRot(Angle)
</PRE>
</P>
<P>
<A name = "zSaveFile"><H2>zSaveFile</H2></A>
<PRE>
  <a href = "#zSaveFile">zSaveFile</a> - Save the lens in the ZEMAX DDE server to a file.
 
  Usage : Status = zSaveFile(FileName)
  Saves the lens currently loaded in the server to a ZEMAX file. The file name to be used for the save
  must include the full path. For example: zSaveFile('C:\ZEMAX\SAMPLES\COOKE.ZMX'). The returned string 
  is the same as for the <a href = "#zGetUpdate">zGetUpdate</a> item; after updating the newly saved
  lens file. If a value other than 0 is returned, the Update failed, if -999 is returned, the file could not be saved. 
  The value -998 is returned if the command times out.
 
  See also <a href = "#zGetPath">zGetPath</a>, <a href = "#zGetRefresh">zGetRefresh</a>, <a href = "#zLoadFile">zLoadFile</a>, and <a href = "#zPushLens">zPushLens</a>.
 
</PRE>
</P>
<P>
<A name = "zSetAperture"><H2>zSetAperture</H2></A>
<PRE>
  <a href = "#zSetAperture">zSetAperture</a> - Set aperture details at a ZEMAX lens surface.
 
  Usage : ApertureInfo = zSetAperture(SurfaceNumber, Type, Min, Max, xDecenter, yDecenter, ApertureFile)
 
  The returned row vector is formatted as follows:
  Type, Min, Max, xDecenter, yDecenter
 
  This function uses an integer code for the surface aperture type; 0 for no aperture, 1 for circular aperture, 2 for
  circular obscuration, 3 for spider, 4 for rectangular aperture, 5 for rectangular obscuration, 6 for elliptical aperture,
  7 for elliptical obscuration, 8 for user defined aperture, 9 for user defined obscuration, and 10 for floating aperture.
  The min and max values have different meanings for the elliptical, rectangular, and spider apertures than for
  circular apertures; see 'Aperture type and other aperture controls' in the ZEMAX manual for details.
  If <a href = "#zSetAperture">zSetAperture</a> is used to set user defined apertures or obscurations, the ApertureFile must be the name of a
  file which lists the x, y, coordinates of the user defined aperture file in a two column format. For more information
  on user defined apertures, see 'User defined apertures and obscurations' in the ZEMAX manual.
 
  See also <a href = "#zGetAperture">zGetAperture</a>.
 
</PRE>
</P>
<P>
<A name = "zSetBuffer"><H2>zSetBuffer</H2></A>
<PRE>
  <a href = "#zSetBuffer">zSetBuffer</a>  - store client specific data with the window being created or updated.
 
  Usage : BufferData = zSetBuffer(BufferNumber, Text)
 
  The buffer data can be used to store user selected options, instead of using the settings data on the command line of the
  <a href = "#zMakeTextWindow">zMakeTextWindow</a> or <a href = "#zMakeGraphicWindow">zMakeGraphicWindow</a> items. The data must be in a string format. The syntax is:
  zSetBuffer(1,'any text you want......');
  There are 16 buffers provided, numbered 0 through 15, and each can be set using zSetBuffer(0,'.....'); zSetBuffer(1,'.....')etc. % 
  The string given is the only text that is stored; and it may be a maximum of 240 characters.
  Note the buffer data is not associated with any particular window until either the <a href = "#zMakeTextWindow">zMakeTextWindow</a> or
  <a href = "#zMakeGraphicWindow">zMakeGraphicWindow</a> items are issued. Once ZEMAX receives the MakeTextWindow or MakeGraphicWindow
  item, the buffer data is then copied to the appropriate window memory, and then may later be retrieved from that
  window's buffer using <a href = "#zGetBuffer">zGetBuffer</a>. 
 
  See also GetBuffer.
 
</PRE>
</P>
<P>
<A name = "zSetConfig"><H2>zSetConfig</H2></A>
<PRE>
  <a href = "#zSetConfig">zSetConfig</a> - Sets the configuration and updates the lens.
 
  Usage : ConfigData = zSetConfig(ConfigNumber)
 
  This function switches the current configuration number and updates the system. 
  For example, to switch to configuration 3, the call is zSetConfig(3)
  The returned row vector is formatted as follows:
  currentconfig, numberconfig, error
  The currentconfig is the new configuration number, which will be between 1 and the value of numberconfig.
  Normally, this will be the desired configuration requested in the item name, as long as it was a valid configuration
  number. The error code is the same as returned by the <a href = "#zGetUpdate">zGetUpdate</a> item, and will be zero if the new current
  configuration is traceable. 
 
  See also <a href = "#zGetConfig">zGetConfig</a>
 
</PRE>
</P>
<P>
<A name = "zSetExtra"><H2>zSetExtra</H2></A>
<PRE>
  <a href = "#zSetExtra">zSetExtra</a> - Sets extra data at a lens surface.
 
  Usage : Value = zSetExtra(SurfaceNumber, ColumnNumber, Value)
 
  The returned data is the Value 
 
  See also <a href = "#zGetExtra">zGetExtra</a>
</PRE>
</P>
<P>
<A name = "zSetField"><H2>zSetField</H2></A>
<PRE>
  <a href = "#zSetField">zSetField</a> - Sets field data for a particular field point.
 
  Usage : FieldData = zSetField(n, xf, yf, wgt, vdx, vdy, vcx, vcy, van)
 
  If n is a valid field number (between 1 and the number of fields, inclusive) then the field x and y values, field weight,
  and vignetting factors are all set.  The returned row vector is the same as for <a href = "#zGetField">zGetField</a>.
 
  See also <a href = "#zGetField">zGetField</a>
 
</PRE>
</P>
<P>
<A name = "zSetFieldMatrix"><H2>zSetFieldMatrix</H2></A>
<PRE>
  <a href = "#zSetFieldMatrix">zSetFieldMatrix</a> - sets all field points from a matrix
 
  Usage : FieldPoints = zSetFieldMatrix(FieldType, FieldDataMatrix)
 
  Create and pass a matrix having columns 8 columns of field data xf, yf, wgt, vdx, vdy, vcx, vcy, van
  If the matrix has fewer columns, it will be assumed that columns on the right are zero.
  The matrix can have from 1 to 12 rows.
  The function returns the number of field points set.
  The parameter FieldType is an integer; either 0, 1, or 2, for angles in degrees, object height, or paraxial image height,
  respectively, 3 for real image height.
 
  See also <a href = "#zGetField">zGetField</a>, <a href = "#zSetField">zSetField</a>
 
</PRE>
</P>
<P>
<A name = "zSetFieldType"><H2>zSetFieldType</H2></A>
<PRE>
  <a href = "#zSetFieldType">zSetFieldType</a> - Sets field type and number of field points.
 
  Usage : FieldData = zSetField(FieldType, FieldNumber)
  The parameter FieldType is an integer; either 0, 1, or 2, for angles in degrees, object height, or paraxial image height,
  respectively, 3 for real image height. The parameter FieldNumber is the number of fields to be defined using <a href = "#zSetField">zSetField</a>.
  The function returns FieldType and FieldNumber in a row vector.
 
  See also <a href = "#zSetField">zSetField</a>, <a href = "#zGetField">zGetField</a>.
 
</PRE>
</P>
<P>
<A name = "zSetFloat"><H2>zSetFloat</H2></A>
<PRE>
  <a href = "#zSetFloat">zSetFloat</a> - sets all surfaces without surface apertures to have floating apertures.
 
  Usage : Reply = <a href = "#zSetFloat">zSetFloat</a>
  This function sets all surfaces without surface apertures to have floating apertures. Floating apertures will vignette
  rays which trace beyond the semi-diameter. 
  The returned value is the string 'OK'.
 
</PRE>
</P>
<P>
<A name = "zSetLabel"><H2>zSetLabel</H2></A>
<PRE>
  <a href = "#zSetLabel">zSetLabel</a> - Attach an integer label to a surface in the ZEMAX lens.
 
  zSetLabel(SurfaceNumber, LabelNumber)
  The returned value is the label number.
  A return value of -998 indicates that the command has timed out.
 
  See also : <a href = "#zGetLabel">zGetLabel</a>, <a href = "#zFindLabel">zFindLabel</a>
 
</PRE>
</P>
<P>
<A name = "zSetMEMState"><H2>zSetMEMState</H2></A>
<PRE>
  Set the mirror states of a ZEMAX MEMS non-sequential digital mirror device (DMD or DLP).
 
  Usage : Success = zSetMEMState(Surface, Object, AddressingMode, MirrorStateMatrix)
 
  where the Surface is the Non-sequential group, and Object is the MEMS object within the group,
  the AddressingMode has the value 0, 1 or 2 for row addressing, column addressing or pixel addressing respectively.
  In the row or column mode, entire rows respectively columns of mirrors have the same state.
  MirrorStateMatrix is an array of integers having value 0, 1 or 2 only. In row or column addressing mode, MirrorStateMatrix
  must be a vector having the same number of rows respectively columns as the MEMS.
  In the pixel addressing mode, MirrorStateMatrix must have the same number of rows and columns as the MEMS.
  Returns 0 or 1 for failure and success respectively.
  This command will change the lens in the LDE.
</PRE>
</P>
<P>
<A name = "zSetMulticon"><H2>zSetMulticon</H2></A>
<PRE>
  <a href = "#zSetMulticon">zSetMulticon</a> - Set data in the ZEMAX multi-configuration editor.
 
  Usage : [OperandType, OperandValue, OperandData] = zSetMulticon(ConfigNumber, RowNumber, Value)
 
  If ConfigNumber is greater than 1 and less than or equal to the number of configurations, the returned
  parameters are as follows :
  OperandType is the four letter operand type name as detailed in the 'Multi-Configurations/Summary' 
  section of the ZEMAX manual.
  OperandValue could be numeric or a string depending on OperandType. If OperandType is 'GLSS',
  'MOFF', 'MCOM', or 'COTN', then OperandValue is a string. Otherwise it is numeric.
  OperandData will be a row vector comprising NumberConfig and NumberRow which are the total number of 
  configs and rows in the multi-configuration editor.
 
  If the ConfigNumber is zero, the multicon operand type data is returned as follows:
  OperandType is the type of multicon operand as before
  OperandValue is zero and OperandData is a row vector comprising Number1, Number2, Number3
  These numbers are described in 'Summary of multi-configuration operands' in the ZEMAX manual.
 
  See also <a href = "#zSetMulticonOp">zSetMulticonOp</a>, <a href = "#zGetMulticon">zGetMulticon</a>.
 
</PRE>
</P>
<P>
<A name = "zSetMulticonOp"><H2>zSetMulticonOp</H2></A>
<PRE>
  <a href = "#zSetMulticonOp">zSetMulticonOp</a> - Set an operand type and associated numerical parameters in the ZEMAX
  multi-configuration editor.
 
  Usage : [rOpType, Numbers] = zSetMulticonOp(RowNumber, OpType, Number1, Number2, Number3)
  where RowNumber is the row number in the multiconfiguration editor, OpType is the four letter
  multi-configuration operand name, and the 3 numbers complete the definition of the operand
  according to the 'Summary of Multi-Configuration Operands' section in the ZEMAX manual.
  The function echos the OpType and Numbers. Numbers is a 3-column row vector.
 
  See also <a href = "#zSetMulticon">zSetMulticon</a>, <a href = "#zGetMulticon">zGetMulticon</a>
 
</PRE>
</P>
<P>
<A name = "zSetNSCNull"><H2>zSetNSCNull</H2></A>
<PRE>
  <a href = "#zSetNSCNull">zSetNSCNull</a> - Sets NSC objects to the Null Object at specified surface
 
  Usage : Status = zSetNSCNull(SurfaceNumber, FirstObject, LastObject)
 
  Sets the NSC objects FirstObject through to LastObject at the surface SurfaceNumber to
  be the 'Null Object'
 
  
  Returns a status of 0 if successfull or -1 if not all objects could be set.
</PRE>
</P>
<P>
<A name = "zSetNSCObjectData"><H2>zSetNSCObjectData</H2></A>
<PRE>
  <a href = "#zSetNSCObjectData">zSetNSCObjectData</a> - Sets one of the NSC data items in the NSC data editor.
 
  Usage : NSCObjectDatum = zSetNSCObjectData(SurfaceNumber, ObjectNumber, ItemCode, Datum)
  SurfaceNumber is the sequential surface number containing NSC objects (0 if in full non-sequential
  mode). ObjectNumber is the number of the NSC object to set a data item on, ItemCode is one of the
  following codes and Datum is the value to which the item should be set. Ensure that the Datum has
  the correct type as per the table.
 
  Code  -   Datum to be set
   0    -   Object type name. (string)
   1    -   Comment, which also defines the file name if the object is defined by a file. (string)
   2    -   Color. (integer)
   3    -   1 if object uses a user defined aperture file, 0 otherwise. (integer)
   4    -   User defined aperture file name, if any. (string)
   5    -   Reference object number. (integer)
   6    -   Inside of object number. (integer)
   7 and up Reserved for future expansion of this feature.
 
  To set the position, rotation and material of the NSC object, use <a href = "#zSetNSCPosition">zSetNSCPosition</a>.
 
  The returned value is just the Datum.
 
  See also : <a href = "#zGetNSCObjectData">zGetNSCObjectData</a>, <a href = "#zSetNSCPosition">zSetNSCPosition</a>
 
</PRE>
</P>
<P>
<A name = "zSetNSCParameter"><H2>zSetNSCParameter</H2></A>
<PRE>
  <a href = "#zGetNSCParameter">zGetNSCParameter</a> - Sets numerical parameter data for NSC objects present in ZEMAX.
 
  Usage : NSCParameter = zSetNSCParameter(SurfaceNumber, ObjectNumber, ParameterNumber, ParameterValue)
  SurfaceNumber and ObjectNumber refer to the surface number and object number, and ParameterNumber is the 
  integer parameter number. ParameterValue is the new value to which the parameter must be set.
 
  The newly set numerical parameter value is returned.
  If the command times out, NaN (not-a-number) is returned.
 
  See also <a href = "#zGetNSCParameter">zGetNSCParameter</a>
 
</PRE>
</P>
<P>
<A name = "zSetNSCPosition"><H2>zSetNSCPosition</H2></A>
<PRE>
  <a href = "#zSetNSCPosition">zSetNSCPosition</a> - Sets one of the NSC position data items in the NSC data editor.
 
  Usage : [NSCPositionData, NSCMaterial] = zSetNSCPosition(SurfaceNumber, ObjectNumber, ItemCode, Datum)
  SurfaceNumber is the sequential surface number containing NSC objects (0 if in full non-sequential
  mode). ObjectNumber is the number of the NSC object to set a data item on, ItemCode is one of the
  following codes and Datum is the value to which the item should be set. Ensure that the Datum has
  the correct type as per the table.
 
  Code  -   Datum to be set
   1    -   x position (lens units)
   2    -   y position
   3    -   z position
   4    -   tilt about x (degrees)
   5    -   tilt about y
   6    -   tilt about z
   7    -   material (string value)
 
  The NSCPositionData returned is a 6 component row vector with the new position and tilt of the
  component. NSCMaterial is a string containing the material of the component.
 
  To set other data for an NSC object, use <a href = "#zSetNSCObjectData">zSetNSCObjectData</a>.
 
  See also : <a href = "#zGetNSCObjectData">zGetNSCObjectData</a>, <a href = "#zSetNSCObjectData">zSetNSCObjectData</a>
 
</PRE>
</P>
<P>
<A name = "zSetNSCSettings"><H2>zSetNSCSettings</H2></A>
<PRE>
  <a href = "#zSetNSCSettings">zSetNSCSettings</a> - Sets NSC settings in ZEMAX.
 
  Usage : NSCSettings = zSetNSCSettings(MaxInt, MaxSeg, MaxNest, MinAbsI, MinRelI, GlueDist, MissRayDist)
  Returns a row vector of the new settings in the following order
  MaxInt, MaxSeg, MaxNes, MinAbsI, MinRelI, GlueDist, MissRayDist
  These items are the maximum number of ray intersections, segments, nesting level, minimum absolute intensity,
  minimum relative intensity, and glue distance used for NSC ray tracing.
 
  See also <a href = "#zGetNSCSettings">zGetNSCSettings</a>
 
</PRE>
</P>
<P>
<A name = "zSetName"><H2>zSetName</H2></A>
<PRE>
  <a href = "#zSetName">zSetName</a> - Set the title of the lens in ZEMAX.
 
  Usage : Name = zSetName(NewName)
 
</PRE>
</P>
<P>
<A name = "zSetOperand"><H2>zSetOperand</H2></A>
<PRE>
  <a href = "#zSetOperand">zSetOperand</a> - Inserts data into the Merit Function Editor in ZEMAX.
 
  Usage : OperandDatum = zSetOperand(Row, Column, Value)
  Row is the operand row number in the Merit Function Editor. Column is 1 for type, 2 for int1, 3 for int2, 4-7 for
  hx-py, 8 for target, and 9 for weight. The returned value is the same as for <a href = "#zGetOperand">zGetOperand</a>. 
 
  For a list of type codes, type "help zemaxoperands" at the <A href = "http://www.mathworks.com">Matlab</A> prompt.
  Returns the Value or NaN (not-a-number) if the command times out.
 
  See also zSetOperandMatrix, <a href = "#zGetOperand">zGetOperand</a>, <a href = "#zGetOperandMatrix">zGetOperandMatrix</a>
 
</PRE>
</P>
<P>
<A name = "zSetPolState"><H2>zSetPolState</H2></A>
<PRE>
  <a href = "#zGetPolState">zGetPolState</a> - Sets the default polarization state used for ZEMAX polarization ray tracing.
 
  Usage : DefaultPolState = zSetPolState(nIsPolarized, Ex, Ey, Phax, Phay)
  If nIsPolarized is anything other than zero, then the default polarization state is unpolarized. Otherwise, the
  Ex, Ey, Phax, and Phay values are used to define the polarization state. Ex and Ey should each be normalized
  to a magnitude of unity, although this is not required. Phax and Phay are in degrees. 
 
  The row vector returned is formatted as follows:
  nIsPolarized, Ex, Ey, Phax, Phay
 
  See also <a href = "#zGetPolState">zGetPolState</a>.
 
</PRE>
</P>
<P>
<A name = "zSetPrimaryWave"><H2>zSetPrimaryWave</H2></A>
<PRE>
  <a href = "#zSetPrimaryWave">zSetPrimaryWave</a> - Set the primary wavelength number in ZEMAX.
 
  Usage : WaveData = zSetPrimaryWave(PrimaryWaveNumber)
 
  Sets the primary wavelength number to PrimaryWaveNumber.
  The returned data is the same as for zGetWave(WaveNumber), namely a row vector containing the
  primary wavelength number and the number of defined wavelengths.
 
  See also <a href = "#zGetWave">zGetWave</a>, <a href = "#zSetWave">zSetWave</a>, <a href = "#zSetWaveMatrix">zSetWaveMatrix</a>, <a href = "#zGetWaveMatrix">zGetWaveMatrix</a>
 
</PRE>
</P>
<P>
<A name = "zSetSolve"><H2>zSetSolve</H2></A>
<PRE>
  <a href = "#zSetSolve">zSetSolve</a> - Sets data for solves and/or pickups on lens surfaces.
 
  Usage : SolveData = zSetSolve(Surface, Code, SolveType, Parameter1, ...)
 
  where Surface is the surface number at which the solve is to be set and Code is
  an integer code indicating which parameter the solve data is for. The solve data is specified in the following
  formats, depending upon the code value according to the following table. The solve takes up to
  three parameters, also depending on the type of solve.
  ------------------------|------------------------------------------------|
  <a href = "#zSetSolve">zSetSolve</a> Code         -|- Returned data format                          |
  ------------------------|------------------------------------------------|
  0, curvature           -|- solvetype, parameter1, parameter2             |
  1, thickness           -|- solvetype, parameter1, parameter2, parameter3 |
  2, glass               -|- solvetype, pickupsurf                         |
  3, semi-diameter       -|- solvetype, pickupsurf                         |
  4, conic               -|- solvetype, pickupsurf                         |
  5-12, parameters 1-8   -|- solvetype, pickupsurf, offset, scalefactor    |
  1001+, extra data values|- solvetype, pickupsurf, scalefactor            |
 -------------------------|------------------------------------------------|
  The solvetype is an integer code, and the parameters have meanings that depend upon the solve type; see
  the chapter "Solves" for details. The Introduction gives a summary for the various solve types.
  Note that code 5 corresponds to parameter 1, not 0. It is not possible to set a solve on parameter
  number 0.
 
  See also <a href = "#zGetSolve">zGetSolve</a>.
 
</PRE>
</P>
<P>
<A name = "zSetSurfaceData"><H2>zSetSurfaceData</H2></A>
<PRE>
  <a href = "#zSetSurfaceData">zSetSurfaceData</a> - Sets various data on a sequential lens surface.
 
  Usage : SurfaceDatum = zSetSurfaceData(SurfaceNumber, Code, Value)
  Sets surface datum at SurfaceNumber depending on the code according to the following table.
  The Value is the required value to which the datum should be set. Supply a string or a numeric
  Value according to the following table.
  Code      - Datum to be set by by <a href = "#zSetSurfaceData">zSetSurfaceData</a>
  0         - Surface type name. (string)
  1         - Comment. (string)
  2         - Curvature (numeric).
  3         - Thickness. (numeric)
  4         - Glass. (string)
  5         - Semi-Diameter. (numeric)
  6         - Conic. (numeric)
  7         - Coating. (string)
  8 and up  - Reserved for future expansion of this feature.
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a> and <a href = "#ZemaxSurfTypes">ZemaxSurfTypes</a>
 
</PRE>
</P>
<P>
<A name = "zSetSurfaceParamMatrix"><H2>zSetSurfaceParamMatrix</H2></A>
<PRE>
  <a href = "#zSetSurfaceParamMatrix">zSetSurfaceParamMatrix</a> - Sets all lens surface parameter data from a 13 column matrix.
 
  Usage : ParameterMatrix = zSetSurfaceParamMatrix(ParamMatrix)
 
  If the matrix passed has fewer than 13 columns, missing columns on the right will be set to zero.
  Returns NaN (not-a-number) if data requests to ZEMAX time out.
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a> and <a href = "#zGetSurfaceParameter">zGetSurfaceParameter</a>
 
</PRE>
</P>
<P>
<A name = "zSetSurfaceParamVector"><H2>zSetSurfaceParamVector</H2></A>
<PRE>
  <a href = "#zSetSurfaceParamVector">zSetSurfaceParamVector</a> - Sets all lens surface parameter data from a 13 column row vector.
 
  Usage : ParameterVector = zSetSurfaceParamVector(SurfaceNumber, ParamVector)
 
  If the vector passed has fewer than 13 columns, missing columns on the right will be set to zero.
  If DDE requests to ZEMAX time out, the function will return NaN
  (not-a-number).
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a> and <a href = "#zGetSurfaceParameter">zGetSurfaceParameter</a>
 
</PRE>
</P>
<P>
<A name = "zSetSurfaceParameter"><H2>zSetSurfaceParameter</H2></A>
<PRE>
  <a href = "#zSetSurfaceParameter">zSetSurfaceParameter</a> - Sets lens surface parameter data.
 
  Usage : ParameterData = zSetSurfaceParameter(SurfaceNumber, ParameterNumber, NewValue)
 
  For example, to set the parameter 5 data for surface 8 to 22.5, the call should be
  zSetSurfaceParameter(8,5,22.5). The value 22.5 would be returned by the function.
 
  Returns NaN (not-a-number) if the function times out.
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a> and <a href = "#zGetSurfaceParameter">zGetSurfaceParameter</a>
 
</PRE>
</P>
<P>
<A name = "zSetSystem"><H2>zSetSystem</H2></A>
<PRE>
  <a href = "#zSetSystem">zSetSystem</a> - Sets a number of lens system operating data.
 
  Usage : SystemData = zSetSystem(unitcode, stopsurf, rayaimingtype, useenvdata, temp, pressure, globalrefsurf)
 
  This function sets the lens units code (0, 1, 2, or 3 for mm, cm, in , or M), the stop surf number,
  the ray aiming type (0, 1, 2 for none, paraxial, real), the use environment data flag (0 for no, 1 for yes), the current
  temperature and pressure, and the global coordinate reference surface number.
 
  The returned row vector  is formatted as follows:
  numsurfs, unitcode, stopsurf, nonaxialflag, rayaimingtype, useenvdata, temp, pressure, globalrefsurf
  where in addition to the above input parameters, numsurfs is the number of surfaces in the lens and  nonaxialflag is 
  a flag to indicate if the system is non-axial symmetric (0 for false, i.e. it is axial, or 1 if
  the system is not axial).
 
  See also <a href = "#zGetSystem">zGetSystem</a> and <a href = "#zGetSystemAper">zGetSystemAper</a>
 
</PRE>
</P>
<P>
<A name = "zSetSystemAper"><H2>zSetSystemAper</H2></A>
<PRE>
  <a href = "#zSetSystemAper">zSetSystemAper</a> - Sets lens system aperture data.
 
  Usage : SystemApertureData = zSetSystemAper(Type, StopSurf, ApertureValue)
  The returned row vector is also formatted as follows:
  Type, StopSurf, ApertureValue
  This function sets the system aperture type (0, 1, 2, 3, 4, or 5 for Entrance Pupil Diameter, Image Space F/#,
  Object Space NA, Float by Stop Size, Paraxial Working F/#, or Object Cone Angle, respectively), the stop surface
  number, and the system aperture value. If the aperture type is Float by Stop Size, the aperture value is the stop
  surface semi-diameter.
  
  See also <a href = "#zGetSystem">zGetSystem</a> and <a href = "#zGetSystemAper">zGetSystemAper</a>
 
</PRE>
</P>
<P>
<A name = "zSetTimeout"><H2>zSetTimeout</H2></A>
<PRE>
  <a href = "#zSetTimeout">zSetTimeout</a> - Set the timeout in seconds for all ZEMAX DDE calls.
 
  Usage : zSetTimeout(Time)
  where Time is given in seconds.
  
  See also : <a href = "#zDDEInit">zDDEInit</a>, <a href = "#zDDEStart">zDDEStart</a>
 
</PRE>
</P>
<P>
<A name = "zSetVig"><H2>zSetVig</H2></A>
<PRE>
  <a href = "#zSetVig">zSetVig</a> - Performs automatic setting of vignetting factors.
 
  Usage : Reply = <a href = "#zSetVig">zSetVig</a>
  Requests ZEMAX to set the vignetting factors automatically. There are no parameters. The reply is
  the string 'OK'.
 
</PRE>
</P>
<P>
<A name = "zSetWave"><H2>zSetWave</H2></A>
<PRE>
  <a href = "#zSetWave">zSetWave</a> - Define wavelengths and weights in ZEMAX.
 
  Usage : WaveData = zSetWave(WaveNumber, Wavelength, Weight)
  or    : WaveData = zSetWave(0, PrimaryWavelength, NumberOfWavelengths)
  If the value for WaveNumber is zero, then the primary wavelength number and the total number of wavelengths is set to
  the new integer values. If WaveNumber is a valid wavelength number (between 1 and the number of wavelengths, inclusive)
  then the wavelength in microns and the wavelength weight are both set. The returned data
  is the same as for zGetWave(WaveNumber)
 
  See also <a href = "#zGetWave">zGetWave</a>
 
</PRE>
</P>
<P>
<A name = "zSetWaveMatrix"><H2>zSetWaveMatrix</H2></A>
<PRE>
  <a href = "#zSetWaveMatrix">zSetWaveMatrix</a> - Sets wavelength and weight data from a matrix.
 
  Usage : oWaveDataMatrix = zSetWaveMatrix(iWaveDataMatrix)
 
  The wavelengths are set from column 1 of the matrix iWaveDataMatrix, and the weights are set from
  column 2. The primary wavelength is assumed to be wavelength 1. To change the primary wavelength,
  use zSetWavePrimary.
 
  Returns a matrix having colummns wavelength and weight for all defined wavelengths.
 
  See also <a href = "#zGetWave">zGetWave</a>, <a href = "#zSetWave">zSetWave</a>, zSetWavePrimary
 
</PRE>
</P>
<P>
<A name = "zSurfDataCodes"><H2>zSurfDataCodes</H2></A>
<PRE>
  <a href = "#zSurfDataCodes">zSurfDataCodes</a> - Returns structure with surface data codes for use with <a href = "#zGetSurfaceData">zGetSurfaceData</a>
 
  Usage : SurfDataCodes = <a href = "#zSurfDataCodes">zSurfDataCodes</a>
 
  Returns a struct with the following fields and values, coresponding to the codes required by the
  <a href = "#zGetSurfaceData">zGetSurfaceData</a> call.
 
  type = 0       - Surface type name. ( 8 character string)
  comment = 1    - Surface Comment. (string)
  curvature = 2  - Surface Curvature (numeric).
  thickness = 3  - Thickness. (numeric)
  glass = 4      - Glass. (string)
  semidia = 5    - Semi-Diameter. (numeric)
  conic = 6      - Conic. (numeric)
  coating = 7    - Coating. (string)
 
  See also <a href = "#zGetSurfaceData">zGetSurfaceData</a>, <a href = "#zSetSurfaceData">zSetSurfaceData</a>
 
</PRE>
</P>
<P>
<A name = "zWindowMaximize"><H2>zWindowMaximize</H2></A>
<PRE>
  <a href = "#zWindowMaximize">zWindowMaximize</a> - Maximize a ZEMAX window.
 
  Usage : Reply = zWindowMaximize(WindowNumber)
 
  Use WindowNumber of 0 to Maximize the main ZEMAX window.
  Replies with the string 'OK' when done.
 
  See also <a href = "#zWindowMinimize">zWindowMinimize</a>
 
</PRE>
</P>
<P>
<A name = "zWindowMinimize"><H2>zWindowMinimize</H2></A>
<PRE>
  <a href = "#zWindowMinimize">zWindowMinimize</a> - Minimize a ZEMAX window.
 
  Usage : Reply = zWindowMinimize(WindowNumber)
 
  Use WindowNumber of 0 to minimize the main ZEMAX window.
  Replies with the string 'OK' when done.
 
  See also <a href = "#zWindowMaximize">zWindowMaximize</a>
 
</PRE>
</P>
<P>
<A name = "zWindowRestore"><H2>zWindowRestore</H2></A>
<PRE>
  <a href = "#zWindowRestore">zWindowRestore</a> - Restore a ZEMAX window.
 
  Usage : Reply = zWindowRestore(WindowNumber)
 
  Use WindowNumber of 0 to Restore the main ZEMAX window.
  Replies with the string 'OK' when done.
 
  See also <a href = "#zWindowMinimize">zWindowMinimize</a>, <a href = "#zWindowMaximize">zWindowMaximize</a>
 
</PRE>
</P>
<P>
<A name = "zsGetAperture"><H2>zsGetAperture</H2></A>
<PRE>
  <a href = "#zsGetAperture">zsGetAperture</a> - Get a structure containing aperture information at a surface.
 
  Usage : zsApertureData = zsGetAperture(SurfaceNumber)
  Returns a structure having the following fields.
  type, min, max, xdec, ydec
  This function returns the type as an integer code; 0 for no aperture, 1 for circular aperture, 2 for circular
  obscuration, 3 for spider, 4 for rectangular aperture, 5 for rectangular obscuration, 6 for elliptical aperture, 7 for
  elliptical obscuration, 8 for user defined aperture, 9 for user defined obscuration, and 10 for floating aperture. The
  min and max values have different meanings for the elliptical, rectangular, and spider apertures than for circular
  apertures; see the Editors Menu chapter in the Zemax Manual for details. 
 
  See also <a href = "#zSetAperture">zSetAperture</a>, <a href = "#zsSetAperture">zsSetAperture</a>, <a href = "#zGetAperture">zGetAperture</a>
</PRE>
</P>
<P>
<A name = "zsGetSurfaceData"><H2>zsGetSurfaceData</H2></A>
<PRE>
  <a href = "#zsGetSurfaceData">zsGetSurfaceData</a> - Get a structure containing the basic lens surface data.
 
  Usage : zsSurfaceData = zsGetSurfaceData(SurfaceNumber)
  Returns a structure having the following fields.
  type (string), comment (string), curvature (numeric), thickness (numeric), glass (string),
  semidia (numeric), conic (numeric), coating (string)
 
  See also <a href = "#zsSetSurfaceData">zsSetSurfaceData</a>, <a href = "#zSetSurfaceData">zSetSurfaceData</a>, <a href = "#zGetSurfaceData">zGetSurfaceData</a>
</PRE>
</P>
<P>
<A name = "zsGetSurfaceDataVector"><H2>zsGetSurfaceDataVector</H2></A>
<PRE>
  <a href = "#zsGetSurfaceData">zsGetSurfaceData</a> - Get a vector of structures containing all the basic lens surface data.
 
  Usage : zsSurfaceDataVector = <a href = "#zsGetSurfaceDataVector">zsGetSurfaceDataVector</a>
  Returns a vector of structures having the following fields.
  type (string), comment (string), curvature (numeric), thickness (numeric), glass (string),
  semidia (numeric), conic (numeric), coating (string)
 
  Beware, ZEMAX numbers surface from 0 (object surface). The returned structure has data for the
  object surface at position 1, so that each surface is displaced upwards by 1.
 
  See also <a href = "#zsSetSurfaceData">zsSetSurfaceData</a>, <a href = "#zSetSurfaceData">zSetSurfaceData</a>, <a href = "#zGetSurfaceData">zGetSurfaceData</a>
</PRE>
</P>
<P>
<A name = "zsGetSystem"><H2>zsGetSystem</H2></A>
<PRE>
  <a href = "#zsGetSystem">zsGetSystem</a> - Get lens system global operating parameters in a struct.
 
  Usage : zsSystemParms = <a href = "#zsGetSystem">zsGetSystem</a>
  Returns a structure with the following fields.
  numsurfs, unitcode, stopsurf, nonaxialflag, rayaimingtype, useenvdata, temp, pressure, globalrefsurf
  This structure contains the number of surfaces, the unit code (0, 1, 2, or 3 for mm, cm, in , or M), the stop surf number,
  a flag to indicate if the system is non-axial symmetric (0 for false, that is it is axial, or 1 if the system is not axial),
  the ray aiming type (0, 1, 2 for none, paraxial, real), the use environment data flag (0 for no, 1 for yes), the current
  temperature and pressure, and the global coordinate reference surface number.
 
  See also <a href = "#zSetSystem">zSetSystem</a>, <a href = "#zsSetSystem">zsSetSystem</a>, <a href = "#zGetSystem">zGetSystem</a>
</PRE>
</P>
<P>
<A name = "zsSetAperture"><H2>zsSetAperture</H2></A>
<PRE>
  <a href = "#zsSetAperture">zsSetAperture</a> - Sets aperture information at a surface from a <A href = "http://www.mathworks.com">Matlab</A> structure.
 
  Usage : zsApertureData = zsSetAperture(SurfaceNumber, ApertureData)
  The ApertureData parameter must be a structure with the following fields.
  type, min, max, xdec, ydec
  The type is an integer code; 0 for no aperture, 1 for circular aperture, 2 for circular
  obscuration, 3 for spider, 4 for rectangular aperture, 5 for rectangular obscuration, 6 for elliptical aperture, 7 for
  elliptical obscuration, 8 for user defined aperture, 9 for user defined obscuration, and 10 for floating aperture. The
  min and max values have different meanings for the elliptical, rectangular, and spider apertures than for circular
  apertures; see the Editors Menu chapter in the Zemax Manual for details. 
 
  See also <a href = "#zSetAperture">zSetAperture</a>, <a href = "#zsSetAperture">zsSetAperture</a>, <a href = "#zGetAperture">zGetAperture</a>
</PRE>
</P>
<P>
<A name = "zsSetNSCObject"><H2>zsSetNSCObject</H2></A>
<PRE>
  <a href = "#zsSetNSCObject">zsSetNSCObject</a> - Sets NSC Object data from a structure.
 
  Usage : Success = zsSetNSCObject(SurfaceNumber, ObjectNumber, ObjectData)
 
  SurfaceNumber is the sequential surface number containing NSC objects (0 if in full non-sequential
  mode). ObjectNumber is the number of the NSC object to set data on. The ObjectData must be a struct
  with any number of the following fields. ObjectData can also be an array of objects, in which case
  ObjectNumber is the starting object number.
 
  Field Name  -   Datum
   type       -   Object type name. (string)
   comment    -   Comment, which also defines the file name if the object is defined by a file. (string)
   color      -   Color. (integer)
   userap     -   1 if object uses a user defined aperture file, 0 otherwise. (integer)
   apfile     -   User defined aperture file name, if any. (string)
   refobj     -   Reference object number. (integer)
   inobj      -   Inside of object number. (integer)
   pos        -   Vector containing the x, y and z coordinates of the object
   tilts      -   Vector containing tilts of the object about the x, y and z axes in degrees.
   material   -   Name of the material of which the object consists.
   params     -   Vector of object parameters to set.
 
  Always assign the type field first when creating the structure.
 
  To set the position, rotation and material of the NSC object one can also use <a href = "#zSetNSCPosition">zSetNSCPosition</a>.
 
  It is very easy to generate an object that is out or partly out of the non-sequential space or overlaps with another object.
  These cases will generate errors.
 
  The returned value is 0 if the object was altered successfully or -1 if a problem was encountered. 
 
  See also : <a href = "#zGetNSCObjectData">zGetNSCObjectData</a>, <a href = "#zSetNSCPosition">zSetNSCPosition</a>
 
</PRE>
</P>
<P>
<A name = "zsSetNSCObjectData"><H2>zsSetNSCObjectData</H2></A>
<PRE>
  <a href = "#zsSetNSCObject">zsSetNSCObject</a> - Sets NSC Object data from a structure.
 
  Usage : NSCObjectData = zsSetNSCObject(SurfaceNumber, ObjectNumber, ObjectData)
 
  SurfaceNumber is the sequential surface number containing NSC objects (0 if in full non-sequential
  mode). ObjectNumber is the number of the NSC object to set data on. The ObjectData must be a struct
  with any number of the following fields.
 
  Field Name  -   Datum
   type       -   Object type name. (string)
   comment    -   Comment, which also defines the file name if the object is defined by a file. (string)
   color      -   Color. (integer)
   userap     -   1 if object uses a user defined aperture file, 0 otherwise. (integer)
   apfile     -   User defined aperture file name, if any. (string)
   refobj     -   Reference object number. (integer)
   inobj      -   Inside of object number. (integer)
   pos        -   Vector containing the x, y and z coordinates of the object
   tilts      -   Vector containing tilts of the object about the x, y and z axes in degrees.
   material   -   Name of the material of which the object consists.
   params     -   Vector of object parameters to set.
 
  To set the position, rotation and material of the NSC object, use <a href = "#zSetNSCPosition">zSetNSCPosition</a>.
 
  The returned value is just the Datum.
 
  See also : <a href = "#zGetNSCObjectData">zGetNSCObjectData</a>, <a href = "#zSetNSCPosition">zSetNSCPosition</a>
 
</PRE>
</P>
<P>
<A name = "zsSetSurfaceData"><H2>zsSetSurfaceData</H2></A>
<PRE>
  <a href = "#zsSetSurfaceData">zsSetSurfaceData</a> - Sets basic lens surface data from a <A href = "http://www.mathworks.com">Matlab</A> structure.
 
  Usage : zsSurfaceData = zsSetSurfaceData(SurfaceNumber, SurfaceData)
 
  Must be passed a structure with the following fields.
  type (string), comment (string), curvature (numeric), thickness (numeric), glass (string),
  semidia (numeric), conic (numeric), coating (string)
  The surface SurfaceNumber will be set with these fields.
 
  See also <a href = "#zSetSurfaceData">zSetSurfaceData</a>, <a href = "#zGetSurfaceData">zGetSurfaceData</a>, <a href = "#zsGetSurfaceData">zsGetSurfaceData</a>
</PRE>
</P>
<P>
<A name = "zsSetSystem"><H2>zsSetSystem</H2></A>
<PRE>
  <a href = "#zsSetSystem">zsSetSystem</a> - Sets a number of lens system operating data.
 
  Usage : oSystemData = zsSetSystem(iSystemData)
 
  This function sets the lens units code (0, 1, 2, or 3 for mm, cm, in , or M), the stop surf number,
  the ray aiming type (0, 1, 2 for none, paraxial, real), the use environment data flag (0 for no, 1 for yes), the current
  temperature and pressure, and the global coordinate reference surface number from an input
  structure iSystemData.
 
  The input and returned structures must have the following fields
  numsurfs, unitcode, stopsurf, nonaxialflag, rayaimingtype, useenvdata, temp, pressure, globalrefsurf
  where in addition to the above input parameters, numsurfs is the number of surfaces in the lens and  nonaxialflag is 
  a flag to indicate if the system is non-axial symmetric (0 for false, i.e. it is axial, or 1 if
  the system is not axial).
 
  See also <a href = "#zGetSystem">zGetSystem</a> and <a href = "#zGetSystemAper">zGetSystemAper</a>
 
</PRE>
</P>
<P>
<A name = "zuiGetMetaFile"><H2>zuiGetMetaFile</H2></A>
<PRE>
  <a href = "#zGetMetaFile">zGetMetaFile</a> -  Request ZEMAX to save a Windows Metafile of any ZEMAX graphical analysis plot.
 
  Usage : zuiGetMetaFile(AnalysisType, SettingsFileName, Flag)
 
  Identical to <a href = "#zGetMetaFile">zGetMetaFile</a>, except that a dialog File Save As box is opened to get the file name.
 
  See also <a href = "#zGetTextFile">zGetTextFile</a>, <a href = "#zOpenWindow">zOpenWindow</a>.
 
</PRE>
</P>
<P>
<A name = "zuiImportExtraData"><H2>zuiImportExtraData</H2></A>
<PRE>
  <a href = "#zImportExtraData">zImportExtraData</a> - imports extra data and grid surface data values into an existing surface.
 
  Usage : Status = zuiImportExtraData(SurfaceNumber)
 
  Identical to <a href = "#zImportExtraData">zImportExtraData</a>, except that a file dialog box is opened to navigate to the target file.
 
</PRE>
</P>
<P>
<A name = "zuiLoadFile"><H2>zuiLoadFile</H2></A>
<PRE>
  <a href = "#zuiLoadFile">zuiLoadFile</a> - Load a lens file into the ZEMAX DDE server, using Open File dialog.
 
  Usage : Status = <a href = "#zuiLoadFile">zuiLoadFile</a>
 
  Identical to <a href = "#zLoadFile">zLoadFile</a>, except that the filename is obtained from the user through a dialog box.
  Note that loading a file does not change the data displayed in the LDE;
  the server process has a separate copy of the lens data. The file name to be loaded is appended to the LoadFile
  item name, and must include the full path. For example: zLoadFile('C:\ZEMAX\SAMPLES\COOKE.ZMX'). The
  returned value is the same as for the <a href = "#zGetUpdate">zGetUpdate</a> item; after updating the newly loaded lens file. If a value other
  than 0 is returned, the Update failed, if -999 is returned, the file could not be loaded. 
  Status of -998 is returned if the command times out.
 
  See also <a href = "#zGetPath">zGetPath</a>, <a href = "#zSaveFile">zSaveFile</a>, <a href = "#zPushLens">zPushLens</a>, <a href = "#zLoadFile">zLoadFile</a>
 
</PRE>
</P>
<P>
<A name = "zuiLoadMerit"><H2>zuiLoadMerit</H2></A>
<PRE>
  <a href = "#zuiLoadMerit">zuiLoadMerit</a> - Load a merit function file into the ZEMAX DDE server using File Open dialog box.
 
  Usage : MeritData = <a href = "#zuiLoadMerit">zuiLoadMerit</a>
 
  Identical to <a href = "#zLoadMerit">zLoadMerit</a>, except that the file name is obtained from the user via a File Open dialog box.
  Loads a ZEMAX .MF or .ZMX file and extracts the merit function and places it in the lens loaded in the server.
  Note that loading a merit function file does not change the data displayed in the LDE; the server process has a
  separate copy of the lens data. The file name must
  include the full path. For example: zLoadMerit('C:\ZEMAX\SAMPLES\MyMerit.MF'). The returned numeric vector is formatted
  as follows:
  number, merit
  where number is the number of operands in the merit function and merit is the value of the merit function. If
  the merit function value is 9.00e+009, the merit function cannot be evaluated.
 
  <a href = "#zuiLoadMerit">zuiLoadMerit</a> returns -1 if the user presses cancel or selects a bad file.
 
  See also <a href = "#zOptimize">zOptimize</a>
 
</PRE>
</P>
<P>
<A name = "zuiSaveFile"><H2>zuiSaveFile</H2></A>
<PRE>
  <a href = "#zuiSaveFile">zuiSaveFile</a> - Save a lens file from the ZEMAX DDE server, using File Save As dialog.
 
  Usage : Status = <a href = "#zuiSaveFile">zuiSaveFile</a>
 
  Identical to <a href = "#zSaveFile">zSaveFile</a>, except that the filename is obtained from the user through a dialog box.
 
  The status is returned as -999 if the user presses cancel, or the file could not be saved.
  A status of -998 is returned if the command times out.
 
</PRE>
</P>
</body>
</html>
